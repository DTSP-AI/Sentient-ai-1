"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/langchain";
exports.ids = ["vendor-chunks/langchain"];
exports.modules = {

/***/ "(rsc)/./node_modules/langchain/dist/chains/api/api_chain.js":
/*!*************************************************************!*\
  !*** ./node_modules/langchain/dist/chains/api/api_chain.js ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   APIChain: () => (/* binding */ APIChain)\n/* harmony export */ });\n/* harmony import */ var _base_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../base.js */ \"(rsc)/./node_modules/langchain/dist/chains/base.js\");\n/* harmony import */ var _llm_chain_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../llm_chain.js */ \"(rsc)/./node_modules/langchain/dist/chains/llm_chain.js\");\n/* harmony import */ var _prompts_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./prompts.js */ \"(rsc)/./node_modules/langchain/dist/chains/api/prompts.js\");\n\n\n\n/**\n * Class that extends BaseChain and represents a chain specifically\n * designed for making API requests and processing API responses.\n */\nclass APIChain extends _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain {\n    get inputKeys() {\n        return [this.inputKey];\n    }\n    get outputKeys() {\n        return [this.outputKey];\n    }\n    constructor(fields) {\n        super(fields);\n        Object.defineProperty(this, \"apiAnswerChain\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"apiRequestChain\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"apiDocs\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"headers\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n        Object.defineProperty(this, \"inputKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"question\"\n        });\n        Object.defineProperty(this, \"outputKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"output\"\n        });\n        this.apiRequestChain = fields.apiRequestChain;\n        this.apiAnswerChain = fields.apiAnswerChain;\n        this.apiDocs = fields.apiDocs;\n        this.inputKey = fields.inputKey ?? this.inputKey;\n        this.outputKey = fields.outputKey ?? this.outputKey;\n        this.headers = fields.headers ?? this.headers;\n    }\n    /** @ignore */\n    async _call(values, runManager) {\n        const question = values[this.inputKey];\n        const api_url = await this.apiRequestChain.predict({ question, api_docs: this.apiDocs }, runManager?.getChild(\"request\"));\n        const res = await fetch(api_url, { headers: this.headers });\n        const api_response = await res.text();\n        const answer = await this.apiAnswerChain.predict({ question, api_docs: this.apiDocs, api_url, api_response }, runManager?.getChild(\"response\"));\n        return { [this.outputKey]: answer };\n    }\n    _chainType() {\n        return \"api_chain\";\n    }\n    static async deserialize(data) {\n        const { api_request_chain, api_answer_chain, api_docs } = data;\n        if (!api_request_chain) {\n            throw new Error(\"LLMChain must have api_request_chain\");\n        }\n        if (!api_answer_chain) {\n            throw new Error(\"LLMChain must have api_answer_chain\");\n        }\n        if (!api_docs) {\n            throw new Error(\"LLMChain must have api_docs\");\n        }\n        return new APIChain({\n            apiAnswerChain: await _llm_chain_js__WEBPACK_IMPORTED_MODULE_1__.LLMChain.deserialize(api_answer_chain),\n            apiRequestChain: await _llm_chain_js__WEBPACK_IMPORTED_MODULE_1__.LLMChain.deserialize(api_request_chain),\n            apiDocs: api_docs,\n        });\n    }\n    serialize() {\n        return {\n            _type: this._chainType(),\n            api_answer_chain: this.apiAnswerChain.serialize(),\n            api_request_chain: this.apiRequestChain.serialize(),\n            api_docs: this.apiDocs,\n        };\n    }\n    /**\n     * Static method to create a new APIChain from a BaseLanguageModel and API\n     * documentation.\n     * @param llm BaseLanguageModel instance.\n     * @param apiDocs API documentation.\n     * @param options Optional configuration options for the APIChain.\n     * @returns New APIChain instance.\n     */\n    static fromLLMAndAPIDocs(llm, apiDocs, options = {}) {\n        const { apiUrlPrompt = _prompts_js__WEBPACK_IMPORTED_MODULE_2__.API_URL_PROMPT_TEMPLATE, apiResponsePrompt = _prompts_js__WEBPACK_IMPORTED_MODULE_2__.API_RESPONSE_PROMPT_TEMPLATE, } = options;\n        const apiRequestChain = new _llm_chain_js__WEBPACK_IMPORTED_MODULE_1__.LLMChain({ prompt: apiUrlPrompt, llm });\n        const apiAnswerChain = new _llm_chain_js__WEBPACK_IMPORTED_MODULE_1__.LLMChain({ prompt: apiResponsePrompt, llm });\n        return new this({\n            apiAnswerChain,\n            apiRequestChain,\n            apiDocs,\n            ...options,\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL2FwaS9hcGlfY2hhaW4uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUF1QztBQUNJO0FBQzJDO0FBQ3RGO0FBQ0E7QUFDQTtBQUNBO0FBQ08sdUJBQXVCLCtDQUFTO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCxrQ0FBa0M7QUFDL0YsMkNBQTJDLHVCQUF1QjtBQUNsRTtBQUNBLDJEQUEyRCx5REFBeUQ7QUFDcEgsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsZ0RBQWdEO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLG1EQUFRO0FBQzFDLG1DQUFtQyxtREFBUTtBQUMzQztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVEO0FBQ3ZELGdCQUFnQixlQUFlLGdFQUF1QixzQkFBc0IscUVBQTRCLElBQUk7QUFDNUcsb0NBQW9DLG1EQUFRLEdBQUcsMkJBQTJCO0FBQzFFLG1DQUFtQyxtREFBUSxHQUFHLGdDQUFnQztBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1jb21wYW5pb24vLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL2FwaS9hcGlfY2hhaW4uanM/MjMzZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCYXNlQ2hhaW4gfSBmcm9tIFwiLi4vYmFzZS5qc1wiO1xuaW1wb3J0IHsgTExNQ2hhaW4gfSBmcm9tIFwiLi4vbGxtX2NoYWluLmpzXCI7XG5pbXBvcnQgeyBBUElfVVJMX1BST01QVF9URU1QTEFURSwgQVBJX1JFU1BPTlNFX1BST01QVF9URU1QTEFURSwgfSBmcm9tIFwiLi9wcm9tcHRzLmpzXCI7XG4vKipcbiAqIENsYXNzIHRoYXQgZXh0ZW5kcyBCYXNlQ2hhaW4gYW5kIHJlcHJlc2VudHMgYSBjaGFpbiBzcGVjaWZpY2FsbHlcbiAqIGRlc2lnbmVkIGZvciBtYWtpbmcgQVBJIHJlcXVlc3RzIGFuZCBwcm9jZXNzaW5nIEFQSSByZXNwb25zZXMuXG4gKi9cbmV4cG9ydCBjbGFzcyBBUElDaGFpbiBleHRlbmRzIEJhc2VDaGFpbiB7XG4gICAgZ2V0IGlucHV0S2V5cygpIHtcbiAgICAgICAgcmV0dXJuIFt0aGlzLmlucHV0S2V5XTtcbiAgICB9XG4gICAgZ2V0IG91dHB1dEtleXMoKSB7XG4gICAgICAgIHJldHVybiBbdGhpcy5vdXRwdXRLZXldO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihmaWVsZHMpIHtcbiAgICAgICAgc3VwZXIoZmllbGRzKTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiYXBpQW5zd2VyQ2hhaW5cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiYXBpUmVxdWVzdENoYWluXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImFwaURvY3NcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiaGVhZGVyc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZToge31cbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImlucHV0S2V5XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBcInF1ZXN0aW9uXCJcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm91dHB1dEtleVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogXCJvdXRwdXRcIlxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5hcGlSZXF1ZXN0Q2hhaW4gPSBmaWVsZHMuYXBpUmVxdWVzdENoYWluO1xuICAgICAgICB0aGlzLmFwaUFuc3dlckNoYWluID0gZmllbGRzLmFwaUFuc3dlckNoYWluO1xuICAgICAgICB0aGlzLmFwaURvY3MgPSBmaWVsZHMuYXBpRG9jcztcbiAgICAgICAgdGhpcy5pbnB1dEtleSA9IGZpZWxkcy5pbnB1dEtleSA/PyB0aGlzLmlucHV0S2V5O1xuICAgICAgICB0aGlzLm91dHB1dEtleSA9IGZpZWxkcy5vdXRwdXRLZXkgPz8gdGhpcy5vdXRwdXRLZXk7XG4gICAgICAgIHRoaXMuaGVhZGVycyA9IGZpZWxkcy5oZWFkZXJzID8/IHRoaXMuaGVhZGVycztcbiAgICB9XG4gICAgLyoqIEBpZ25vcmUgKi9cbiAgICBhc3luYyBfY2FsbCh2YWx1ZXMsIHJ1bk1hbmFnZXIpIHtcbiAgICAgICAgY29uc3QgcXVlc3Rpb24gPSB2YWx1ZXNbdGhpcy5pbnB1dEtleV07XG4gICAgICAgIGNvbnN0IGFwaV91cmwgPSBhd2FpdCB0aGlzLmFwaVJlcXVlc3RDaGFpbi5wcmVkaWN0KHsgcXVlc3Rpb24sIGFwaV9kb2NzOiB0aGlzLmFwaURvY3MgfSwgcnVuTWFuYWdlcj8uZ2V0Q2hpbGQoXCJyZXF1ZXN0XCIpKTtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYXBpX3VybCwgeyBoZWFkZXJzOiB0aGlzLmhlYWRlcnMgfSk7XG4gICAgICAgIGNvbnN0IGFwaV9yZXNwb25zZSA9IGF3YWl0IHJlcy50ZXh0KCk7XG4gICAgICAgIGNvbnN0IGFuc3dlciA9IGF3YWl0IHRoaXMuYXBpQW5zd2VyQ2hhaW4ucHJlZGljdCh7IHF1ZXN0aW9uLCBhcGlfZG9jczogdGhpcy5hcGlEb2NzLCBhcGlfdXJsLCBhcGlfcmVzcG9uc2UgfSwgcnVuTWFuYWdlcj8uZ2V0Q2hpbGQoXCJyZXNwb25zZVwiKSk7XG4gICAgICAgIHJldHVybiB7IFt0aGlzLm91dHB1dEtleV06IGFuc3dlciB9O1xuICAgIH1cbiAgICBfY2hhaW5UeXBlKCkge1xuICAgICAgICByZXR1cm4gXCJhcGlfY2hhaW5cIjtcbiAgICB9XG4gICAgc3RhdGljIGFzeW5jIGRlc2VyaWFsaXplKGRhdGEpIHtcbiAgICAgICAgY29uc3QgeyBhcGlfcmVxdWVzdF9jaGFpbiwgYXBpX2Fuc3dlcl9jaGFpbiwgYXBpX2RvY3MgfSA9IGRhdGE7XG4gICAgICAgIGlmICghYXBpX3JlcXVlc3RfY2hhaW4pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkxMTUNoYWluIG11c3QgaGF2ZSBhcGlfcmVxdWVzdF9jaGFpblwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWFwaV9hbnN3ZXJfY2hhaW4pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkxMTUNoYWluIG11c3QgaGF2ZSBhcGlfYW5zd2VyX2NoYWluXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghYXBpX2RvY3MpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkxMTUNoYWluIG11c3QgaGF2ZSBhcGlfZG9jc1wiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IEFQSUNoYWluKHtcbiAgICAgICAgICAgIGFwaUFuc3dlckNoYWluOiBhd2FpdCBMTE1DaGFpbi5kZXNlcmlhbGl6ZShhcGlfYW5zd2VyX2NoYWluKSxcbiAgICAgICAgICAgIGFwaVJlcXVlc3RDaGFpbjogYXdhaXQgTExNQ2hhaW4uZGVzZXJpYWxpemUoYXBpX3JlcXVlc3RfY2hhaW4pLFxuICAgICAgICAgICAgYXBpRG9jczogYXBpX2RvY3MsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXJpYWxpemUoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBfdHlwZTogdGhpcy5fY2hhaW5UeXBlKCksXG4gICAgICAgICAgICBhcGlfYW5zd2VyX2NoYWluOiB0aGlzLmFwaUFuc3dlckNoYWluLnNlcmlhbGl6ZSgpLFxuICAgICAgICAgICAgYXBpX3JlcXVlc3RfY2hhaW46IHRoaXMuYXBpUmVxdWVzdENoYWluLnNlcmlhbGl6ZSgpLFxuICAgICAgICAgICAgYXBpX2RvY3M6IHRoaXMuYXBpRG9jcyxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhdGljIG1ldGhvZCB0byBjcmVhdGUgYSBuZXcgQVBJQ2hhaW4gZnJvbSBhIEJhc2VMYW5ndWFnZU1vZGVsIGFuZCBBUElcbiAgICAgKiBkb2N1bWVudGF0aW9uLlxuICAgICAqIEBwYXJhbSBsbG0gQmFzZUxhbmd1YWdlTW9kZWwgaW5zdGFuY2UuXG4gICAgICogQHBhcmFtIGFwaURvY3MgQVBJIGRvY3VtZW50YXRpb24uXG4gICAgICogQHBhcmFtIG9wdGlvbnMgT3B0aW9uYWwgY29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB0aGUgQVBJQ2hhaW4uXG4gICAgICogQHJldHVybnMgTmV3IEFQSUNoYWluIGluc3RhbmNlLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tTExNQW5kQVBJRG9jcyhsbG0sIGFwaURvY3MsIG9wdGlvbnMgPSB7fSkge1xuICAgICAgICBjb25zdCB7IGFwaVVybFByb21wdCA9IEFQSV9VUkxfUFJPTVBUX1RFTVBMQVRFLCBhcGlSZXNwb25zZVByb21wdCA9IEFQSV9SRVNQT05TRV9QUk9NUFRfVEVNUExBVEUsIH0gPSBvcHRpb25zO1xuICAgICAgICBjb25zdCBhcGlSZXF1ZXN0Q2hhaW4gPSBuZXcgTExNQ2hhaW4oeyBwcm9tcHQ6IGFwaVVybFByb21wdCwgbGxtIH0pO1xuICAgICAgICBjb25zdCBhcGlBbnN3ZXJDaGFpbiA9IG5ldyBMTE1DaGFpbih7IHByb21wdDogYXBpUmVzcG9uc2VQcm9tcHQsIGxsbSB9KTtcbiAgICAgICAgcmV0dXJuIG5ldyB0aGlzKHtcbiAgICAgICAgICAgIGFwaUFuc3dlckNoYWluLFxuICAgICAgICAgICAgYXBpUmVxdWVzdENoYWluLFxuICAgICAgICAgICAgYXBpRG9jcyxcbiAgICAgICAgICAgIC4uLm9wdGlvbnMsXG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/chains/api/api_chain.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/chains/api/prompts.js":
/*!***********************************************************!*\
  !*** ./node_modules/langchain/dist/chains/api/prompts.js ***!
  \***********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   API_RESPONSE_PROMPT_TEMPLATE: () => (/* binding */ API_RESPONSE_PROMPT_TEMPLATE),\n/* harmony export */   API_RESPONSE_RAW_PROMPT_TEMPLATE: () => (/* binding */ API_RESPONSE_RAW_PROMPT_TEMPLATE),\n/* harmony export */   API_URL_PROMPT_TEMPLATE: () => (/* binding */ API_URL_PROMPT_TEMPLATE),\n/* harmony export */   API_URL_RAW_PROMPT_TEMPLATE: () => (/* binding */ API_URL_RAW_PROMPT_TEMPLATE)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/prompts */ \"(rsc)/./node_modules/@langchain/core/prompts.js\");\n/* eslint-disable spaced-comment */\n\nconst API_URL_RAW_PROMPT_TEMPLATE = `You are given the below API Documentation:\n{api_docs}\nUsing this documentation, generate the full API url to call for answering the user question.\nYou should build the API url in order to get a response that is as short as possible, while still getting the necessary information to answer the question. Pay attention to deliberately exclude any unnecessary pieces of data in the API call.\n\nQuestion:{question}\nAPI url:`;\nconst API_URL_PROMPT_TEMPLATE = /* #__PURE__ */ new _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate({\n    inputVariables: [\"api_docs\", \"question\"],\n    template: API_URL_RAW_PROMPT_TEMPLATE,\n});\nconst API_RESPONSE_RAW_PROMPT_TEMPLATE = `${API_URL_RAW_PROMPT_TEMPLATE} {api_url}\n\nHere is the response from the API:\n\n{api_response}\n\nSummarize this response to answer the original question.\n\nSummary:`;\nconst API_RESPONSE_PROMPT_TEMPLATE = /* #__PURE__ */ new _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate({\n    inputVariables: [\"api_docs\", \"question\", \"api_url\", \"api_response\"],\n    template: API_RESPONSE_RAW_PROMPT_TEMPLATE,\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL2FwaS9wcm9tcHRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDeUQ7QUFDbEQ7QUFDUCxDQUFDO0FBQ0Q7QUFDQTs7QUFFQSxVQUFVO0FBQ1Y7QUFDTyxvREFBb0QsbUVBQWM7QUFDekU7QUFDQTtBQUNBLENBQUM7QUFDTSw0Q0FBNEMsOEJBQThCOztBQUVqRjs7QUFFQSxDQUFDOztBQUVEOztBQUVBO0FBQ08seURBQXlELG1FQUFjO0FBQzlFO0FBQ0E7QUFDQSxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWktY29tcGFuaW9uLy4vbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2NoYWlucy9hcGkvcHJvbXB0cy5qcz9jZmVmIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIHNwYWNlZC1jb21tZW50ICovXG5pbXBvcnQgeyBQcm9tcHRUZW1wbGF0ZSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvcHJvbXB0c1wiO1xuZXhwb3J0IGNvbnN0IEFQSV9VUkxfUkFXX1BST01QVF9URU1QTEFURSA9IGBZb3UgYXJlIGdpdmVuIHRoZSBiZWxvdyBBUEkgRG9jdW1lbnRhdGlvbjpcbnthcGlfZG9jc31cblVzaW5nIHRoaXMgZG9jdW1lbnRhdGlvbiwgZ2VuZXJhdGUgdGhlIGZ1bGwgQVBJIHVybCB0byBjYWxsIGZvciBhbnN3ZXJpbmcgdGhlIHVzZXIgcXVlc3Rpb24uXG5Zb3Ugc2hvdWxkIGJ1aWxkIHRoZSBBUEkgdXJsIGluIG9yZGVyIHRvIGdldCBhIHJlc3BvbnNlIHRoYXQgaXMgYXMgc2hvcnQgYXMgcG9zc2libGUsIHdoaWxlIHN0aWxsIGdldHRpbmcgdGhlIG5lY2Vzc2FyeSBpbmZvcm1hdGlvbiB0byBhbnN3ZXIgdGhlIHF1ZXN0aW9uLiBQYXkgYXR0ZW50aW9uIHRvIGRlbGliZXJhdGVseSBleGNsdWRlIGFueSB1bm5lY2Vzc2FyeSBwaWVjZXMgb2YgZGF0YSBpbiB0aGUgQVBJIGNhbGwuXG5cblF1ZXN0aW9uOntxdWVzdGlvbn1cbkFQSSB1cmw6YDtcbmV4cG9ydCBjb25zdCBBUElfVVJMX1BST01QVF9URU1QTEFURSA9IC8qICNfX1BVUkVfXyAqLyBuZXcgUHJvbXB0VGVtcGxhdGUoe1xuICAgIGlucHV0VmFyaWFibGVzOiBbXCJhcGlfZG9jc1wiLCBcInF1ZXN0aW9uXCJdLFxuICAgIHRlbXBsYXRlOiBBUElfVVJMX1JBV19QUk9NUFRfVEVNUExBVEUsXG59KTtcbmV4cG9ydCBjb25zdCBBUElfUkVTUE9OU0VfUkFXX1BST01QVF9URU1QTEFURSA9IGAke0FQSV9VUkxfUkFXX1BST01QVF9URU1QTEFURX0ge2FwaV91cmx9XG5cbkhlcmUgaXMgdGhlIHJlc3BvbnNlIGZyb20gdGhlIEFQSTpcblxue2FwaV9yZXNwb25zZX1cblxuU3VtbWFyaXplIHRoaXMgcmVzcG9uc2UgdG8gYW5zd2VyIHRoZSBvcmlnaW5hbCBxdWVzdGlvbi5cblxuU3VtbWFyeTpgO1xuZXhwb3J0IGNvbnN0IEFQSV9SRVNQT05TRV9QUk9NUFRfVEVNUExBVEUgPSAvKiAjX19QVVJFX18gKi8gbmV3IFByb21wdFRlbXBsYXRlKHtcbiAgICBpbnB1dFZhcmlhYmxlczogW1wiYXBpX2RvY3NcIiwgXCJxdWVzdGlvblwiLCBcImFwaV91cmxcIiwgXCJhcGlfcmVzcG9uc2VcIl0sXG4gICAgdGVtcGxhdGU6IEFQSV9SRVNQT05TRV9SQVdfUFJPTVBUX1RFTVBMQVRFLFxufSk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/chains/api/prompts.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/chains/base.js":
/*!****************************************************!*\
  !*** ./node_modules/langchain/dist/chains/base.js ***!
  \****************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BaseChain: () => (/* binding */ BaseChain)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_outputs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/outputs */ \"(rsc)/./node_modules/@langchain/core/outputs.js\");\n/* harmony import */ var _langchain_core_callbacks_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/callbacks/manager */ \"(rsc)/./node_modules/@langchain/core/callbacks/manager.js\");\n/* harmony import */ var _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/core/runnables */ \"(rsc)/./node_modules/@langchain/core/runnables.js\");\n/* harmony import */ var _langchain_core_language_models_base__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @langchain/core/language_models/base */ \"(rsc)/./node_modules/@langchain/core/language_models/base.js\");\n\n\n\n\n/**\n * Base interface that all chains must implement.\n */\nclass BaseChain extends _langchain_core_language_models_base__WEBPACK_IMPORTED_MODULE_3__.BaseLangChain {\n    get lc_namespace() {\n        return [\"langchain\", \"chains\", this._chainType()];\n    }\n    constructor(fields, \n    /** @deprecated */\n    verbose, \n    /** @deprecated */\n    callbacks) {\n        if (arguments.length === 1 &&\n            typeof fields === \"object\" &&\n            !(\"saveContext\" in fields)) {\n            // fields is not a BaseMemory\n            const { memory, callbackManager, ...rest } = fields;\n            super({ ...rest, callbacks: callbackManager ?? rest.callbacks });\n            this.memory = memory;\n        }\n        else {\n            // fields is a BaseMemory\n            super({ verbose, callbacks });\n            this.memory = fields;\n        }\n    }\n    /** @ignore */\n    _selectMemoryInputs(values) {\n        const valuesForMemory = { ...values };\n        if (\"signal\" in valuesForMemory) {\n            delete valuesForMemory.signal;\n        }\n        if (\"timeout\" in valuesForMemory) {\n            delete valuesForMemory.timeout;\n        }\n        return valuesForMemory;\n    }\n    /**\n     * Invoke the chain with the provided input and returns the output.\n     * @param input Input values for the chain run.\n     * @param config Optional configuration for the Runnable.\n     * @returns Promise that resolves with the output of the chain run.\n     */\n    async invoke(input, options) {\n        const config = (0,_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_2__.ensureConfig)(options);\n        const fullValues = await this._formatValues(input);\n        const callbackManager_ = await _langchain_core_callbacks_manager__WEBPACK_IMPORTED_MODULE_1__.CallbackManager.configure(config?.callbacks, this.callbacks, config?.tags, this.tags, config?.metadata, this.metadata, { verbose: this.verbose });\n        const runManager = await callbackManager_?.handleChainStart(this.toJSON(), fullValues, undefined, undefined, undefined, undefined, config?.runName);\n        let outputValues;\n        try {\n            outputValues = await (fullValues.signal\n                ? Promise.race([\n                    this._call(fullValues, runManager, config),\n                    new Promise((_, reject) => {\n                        fullValues.signal?.addEventListener(\"abort\", () => {\n                            reject(new Error(\"AbortError\"));\n                        });\n                    }),\n                ])\n                : this._call(fullValues, runManager, config));\n        }\n        catch (e) {\n            await runManager?.handleChainError(e);\n            throw e;\n        }\n        if (!(this.memory == null)) {\n            await this.memory.saveContext(this._selectMemoryInputs(input), outputValues);\n        }\n        await runManager?.handleChainEnd(outputValues);\n        // add the runManager's currentRunId to the outputValues\n        Object.defineProperty(outputValues, _langchain_core_outputs__WEBPACK_IMPORTED_MODULE_0__.RUN_KEY, {\n            value: runManager ? { runId: runManager?.runId } : undefined,\n            configurable: true,\n        });\n        return outputValues;\n    }\n    _validateOutputs(outputs) {\n        const missingKeys = this.outputKeys.filter((k) => !(k in outputs));\n        if (missingKeys.length) {\n            throw new Error(`Missing output keys: ${missingKeys.join(\", \")} from chain ${this._chainType()}`);\n        }\n    }\n    async prepOutputs(inputs, outputs, returnOnlyOutputs = false) {\n        this._validateOutputs(outputs);\n        if (this.memory) {\n            await this.memory.saveContext(inputs, outputs);\n        }\n        if (returnOnlyOutputs) {\n            return outputs;\n        }\n        return { ...inputs, ...outputs };\n    }\n    /**\n     * Return a json-like object representing this chain.\n     */\n    serialize() {\n        throw new Error(\"Method not implemented.\");\n    }\n    /** @deprecated Use .invoke() instead. Will be removed in 0.2.0. */\n    async run(\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    input, config) {\n        const inputKeys = this.inputKeys.filter((k) => !this.memory?.memoryKeys.includes(k) ?? true);\n        const isKeylessInput = inputKeys.length <= 1;\n        if (!isKeylessInput) {\n            throw new Error(`Chain ${this._chainType()} expects multiple inputs, cannot use 'run' `);\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const values = inputKeys.length ? { [inputKeys[0]]: input } : {};\n        const returnValues = await this.call(values, config);\n        const keys = Object.keys(returnValues);\n        if (keys.length === 1) {\n            return returnValues[keys[0]];\n        }\n        throw new Error(\"return values have multiple keys, `run` only supported when one key currently\");\n    }\n    async _formatValues(values) {\n        const fullValues = { ...values };\n        if (fullValues.timeout && !fullValues.signal) {\n            fullValues.signal = AbortSignal.timeout(fullValues.timeout);\n            delete fullValues.timeout;\n        }\n        if (!(this.memory == null)) {\n            const newValues = await this.memory.loadMemoryVariables(this._selectMemoryInputs(values));\n            for (const [key, value] of Object.entries(newValues)) {\n                fullValues[key] = value;\n            }\n        }\n        return fullValues;\n    }\n    /**\n     * @deprecated Use .invoke() instead. Will be removed in 0.2.0.\n     *\n     * Run the core logic of this chain and add to output if desired.\n     *\n     * Wraps _call and handles memory.\n     */\n    async call(values, config, \n    /** @deprecated */\n    tags) {\n        const parsedConfig = { tags, ...(0,_langchain_core_callbacks_manager__WEBPACK_IMPORTED_MODULE_1__.parseCallbackConfigArg)(config) };\n        return this.invoke(values, parsedConfig);\n    }\n    /**\n     * @deprecated Use .batch() instead. Will be removed in 0.2.0.\n     *\n     * Call the chain on all inputs in the list\n     */\n    async apply(inputs, config) {\n        return Promise.all(inputs.map(async (i, idx) => this.call(i, config?.[idx])));\n    }\n    /**\n     * Load a chain from a json-like object describing it.\n     */\n    static async deserialize(data, values = {}) {\n        switch (data._type) {\n            case \"llm_chain\": {\n                const { LLMChain } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! ./llm_chain.js */ \"(rsc)/./node_modules/langchain/dist/chains/llm_chain.js\"));\n                return LLMChain.deserialize(data);\n            }\n            case \"sequential_chain\": {\n                const { SequentialChain } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/langchain\").then(__webpack_require__.bind(__webpack_require__, /*! ./sequential_chain.js */ \"(rsc)/./node_modules/langchain/dist/chains/sequential_chain.js\"));\n                return SequentialChain.deserialize(data);\n            }\n            case \"simple_sequential_chain\": {\n                const { SimpleSequentialChain } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/langchain\").then(__webpack_require__.bind(__webpack_require__, /*! ./sequential_chain.js */ \"(rsc)/./node_modules/langchain/dist/chains/sequential_chain.js\"));\n                return SimpleSequentialChain.deserialize(data);\n            }\n            case \"stuff_documents_chain\": {\n                const { StuffDocumentsChain } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/langchain\").then(__webpack_require__.bind(__webpack_require__, /*! ./combine_docs_chain.js */ \"(rsc)/./node_modules/langchain/dist/chains/combine_docs_chain.js\"));\n                return StuffDocumentsChain.deserialize(data);\n            }\n            case \"map_reduce_documents_chain\": {\n                const { MapReduceDocumentsChain } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/langchain\").then(__webpack_require__.bind(__webpack_require__, /*! ./combine_docs_chain.js */ \"(rsc)/./node_modules/langchain/dist/chains/combine_docs_chain.js\"));\n                return MapReduceDocumentsChain.deserialize(data);\n            }\n            case \"refine_documents_chain\": {\n                const { RefineDocumentsChain } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/langchain\").then(__webpack_require__.bind(__webpack_require__, /*! ./combine_docs_chain.js */ \"(rsc)/./node_modules/langchain/dist/chains/combine_docs_chain.js\"));\n                return RefineDocumentsChain.deserialize(data);\n            }\n            case \"vector_db_qa\": {\n                const { VectorDBQAChain } = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/langchain\"), __webpack_require__.e(\"vendor-chunks/@langchain\")]).then(__webpack_require__.bind(__webpack_require__, /*! ./vector_db_qa.js */ \"(rsc)/./node_modules/langchain/dist/chains/vector_db_qa.js\"));\n                return VectorDBQAChain.deserialize(data, values);\n            }\n            case \"api_chain\": {\n                const { APIChain } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/langchain\").then(__webpack_require__.bind(__webpack_require__, /*! ./api/api_chain.js */ \"(rsc)/./node_modules/langchain/dist/chains/api/api_chain.js\"));\n                return APIChain.deserialize(data);\n            }\n            default:\n                throw new Error(`Invalid prompt type in config: ${data._type}`);\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL2Jhc2UuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBa0Q7QUFDMkM7QUFDcEM7QUFDYTtBQUN0RTtBQUNBO0FBQ0E7QUFDTyx3QkFBd0IsK0VBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLG1DQUFtQztBQUN2RCxvQkFBb0IsdURBQXVEO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLG9CQUFvQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qix1RUFBWTtBQUNuQztBQUNBLHVDQUF1Qyw4RUFBZSwwR0FBMEcsdUJBQXVCO0FBQ3ZMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QixxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLDREQUFPO0FBQ25ELGtDQUFrQywyQkFBMkI7QUFDN0Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCx3QkFBd0IsYUFBYSxrQkFBa0I7QUFDM0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxtQkFBbUI7QUFDeEQ7QUFDQTtBQUNBLDRDQUE0Qyx3QkFBd0I7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixTQUFTLHlGQUFzQjtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QztBQUM5QztBQUNBO0FBQ0Esd0JBQXdCLFdBQVcsUUFBUSxxS0FBd0I7QUFDbkU7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGtCQUFrQixRQUFRLG1OQUErQjtBQUNqRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isd0JBQXdCLFFBQVEsbU5BQStCO0FBQ3ZGO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixzQkFBc0IsUUFBUSx1TkFBaUM7QUFDdkY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDBCQUEwQixRQUFRLHVOQUFpQztBQUMzRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCLFFBQVEsdU5BQWlDO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0IsUUFBUSw0UUFBMkI7QUFDN0U7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFdBQVcsUUFBUSw2TUFBNEI7QUFDdkU7QUFDQTtBQUNBO0FBQ0Esa0VBQWtFLFdBQVc7QUFDN0U7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWktY29tcGFuaW9uLy4vbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2NoYWlucy9iYXNlLmpzP2ZlOTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUlVOX0tFWSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvb3V0cHV0c1wiO1xuaW1wb3J0IHsgQ2FsbGJhY2tNYW5hZ2VyLCBwYXJzZUNhbGxiYWNrQ29uZmlnQXJnLCB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvY2FsbGJhY2tzL21hbmFnZXJcIjtcbmltcG9ydCB7IGVuc3VyZUNvbmZpZyB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvcnVubmFibGVzXCI7XG5pbXBvcnQgeyBCYXNlTGFuZ0NoYWluLCB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvbGFuZ3VhZ2VfbW9kZWxzL2Jhc2VcIjtcbi8qKlxuICogQmFzZSBpbnRlcmZhY2UgdGhhdCBhbGwgY2hhaW5zIG11c3QgaW1wbGVtZW50LlxuICovXG5leHBvcnQgY2xhc3MgQmFzZUNoYWluIGV4dGVuZHMgQmFzZUxhbmdDaGFpbiB7XG4gICAgZ2V0IGxjX25hbWVzcGFjZSgpIHtcbiAgICAgICAgcmV0dXJuIFtcImxhbmdjaGFpblwiLCBcImNoYWluc1wiLCB0aGlzLl9jaGFpblR5cGUoKV07XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKGZpZWxkcywgXG4gICAgLyoqIEBkZXByZWNhdGVkICovXG4gICAgdmVyYm9zZSwgXG4gICAgLyoqIEBkZXByZWNhdGVkICovXG4gICAgY2FsbGJhY2tzKSB7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmXG4gICAgICAgICAgICB0eXBlb2YgZmllbGRzID09PSBcIm9iamVjdFwiICYmXG4gICAgICAgICAgICAhKFwic2F2ZUNvbnRleHRcIiBpbiBmaWVsZHMpKSB7XG4gICAgICAgICAgICAvLyBmaWVsZHMgaXMgbm90IGEgQmFzZU1lbW9yeVxuICAgICAgICAgICAgY29uc3QgeyBtZW1vcnksIGNhbGxiYWNrTWFuYWdlciwgLi4ucmVzdCB9ID0gZmllbGRzO1xuICAgICAgICAgICAgc3VwZXIoeyAuLi5yZXN0LCBjYWxsYmFja3M6IGNhbGxiYWNrTWFuYWdlciA/PyByZXN0LmNhbGxiYWNrcyB9KTtcbiAgICAgICAgICAgIHRoaXMubWVtb3J5ID0gbWVtb3J5O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gZmllbGRzIGlzIGEgQmFzZU1lbW9yeVxuICAgICAgICAgICAgc3VwZXIoeyB2ZXJib3NlLCBjYWxsYmFja3MgfSk7XG4gICAgICAgICAgICB0aGlzLm1lbW9yeSA9IGZpZWxkcztcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKiogQGlnbm9yZSAqL1xuICAgIF9zZWxlY3RNZW1vcnlJbnB1dHModmFsdWVzKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlc0Zvck1lbW9yeSA9IHsgLi4udmFsdWVzIH07XG4gICAgICAgIGlmIChcInNpZ25hbFwiIGluIHZhbHVlc0Zvck1lbW9yeSkge1xuICAgICAgICAgICAgZGVsZXRlIHZhbHVlc0Zvck1lbW9yeS5zaWduYWw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwidGltZW91dFwiIGluIHZhbHVlc0Zvck1lbW9yeSkge1xuICAgICAgICAgICAgZGVsZXRlIHZhbHVlc0Zvck1lbW9yeS50aW1lb3V0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZXNGb3JNZW1vcnk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEludm9rZSB0aGUgY2hhaW4gd2l0aCB0aGUgcHJvdmlkZWQgaW5wdXQgYW5kIHJldHVybnMgdGhlIG91dHB1dC5cbiAgICAgKiBAcGFyYW0gaW5wdXQgSW5wdXQgdmFsdWVzIGZvciB0aGUgY2hhaW4gcnVuLlxuICAgICAqIEBwYXJhbSBjb25maWcgT3B0aW9uYWwgY29uZmlndXJhdGlvbiBmb3IgdGhlIFJ1bm5hYmxlLlxuICAgICAqIEByZXR1cm5zIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSBvdXRwdXQgb2YgdGhlIGNoYWluIHJ1bi5cbiAgICAgKi9cbiAgICBhc3luYyBpbnZva2UoaW5wdXQsIG9wdGlvbnMpIHtcbiAgICAgICAgY29uc3QgY29uZmlnID0gZW5zdXJlQ29uZmlnKG9wdGlvbnMpO1xuICAgICAgICBjb25zdCBmdWxsVmFsdWVzID0gYXdhaXQgdGhpcy5fZm9ybWF0VmFsdWVzKGlucHV0KTtcbiAgICAgICAgY29uc3QgY2FsbGJhY2tNYW5hZ2VyXyA9IGF3YWl0IENhbGxiYWNrTWFuYWdlci5jb25maWd1cmUoY29uZmlnPy5jYWxsYmFja3MsIHRoaXMuY2FsbGJhY2tzLCBjb25maWc/LnRhZ3MsIHRoaXMudGFncywgY29uZmlnPy5tZXRhZGF0YSwgdGhpcy5tZXRhZGF0YSwgeyB2ZXJib3NlOiB0aGlzLnZlcmJvc2UgfSk7XG4gICAgICAgIGNvbnN0IHJ1bk1hbmFnZXIgPSBhd2FpdCBjYWxsYmFja01hbmFnZXJfPy5oYW5kbGVDaGFpblN0YXJ0KHRoaXMudG9KU09OKCksIGZ1bGxWYWx1ZXMsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY29uZmlnPy5ydW5OYW1lKTtcbiAgICAgICAgbGV0IG91dHB1dFZhbHVlcztcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG91dHB1dFZhbHVlcyA9IGF3YWl0IChmdWxsVmFsdWVzLnNpZ25hbFxuICAgICAgICAgICAgICAgID8gUHJvbWlzZS5yYWNlKFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2FsbChmdWxsVmFsdWVzLCBydW5NYW5hZ2VyLCBjb25maWcpLFxuICAgICAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZSgoXywgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmdWxsVmFsdWVzLnNpZ25hbD8uYWRkRXZlbnRMaXN0ZW5lcihcImFib3J0XCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKFwiQWJvcnRFcnJvclwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgICAgICA6IHRoaXMuX2NhbGwoZnVsbFZhbHVlcywgcnVuTWFuYWdlciwgY29uZmlnKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHJ1bk1hbmFnZXI/LmhhbmRsZUNoYWluRXJyb3IoZSk7XG4gICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghKHRoaXMubWVtb3J5ID09IG51bGwpKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLm1lbW9yeS5zYXZlQ29udGV4dCh0aGlzLl9zZWxlY3RNZW1vcnlJbnB1dHMoaW5wdXQpLCBvdXRwdXRWYWx1ZXMpO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHJ1bk1hbmFnZXI/LmhhbmRsZUNoYWluRW5kKG91dHB1dFZhbHVlcyk7XG4gICAgICAgIC8vIGFkZCB0aGUgcnVuTWFuYWdlcidzIGN1cnJlbnRSdW5JZCB0byB0aGUgb3V0cHV0VmFsdWVzXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvdXRwdXRWYWx1ZXMsIFJVTl9LRVksIHtcbiAgICAgICAgICAgIHZhbHVlOiBydW5NYW5hZ2VyID8geyBydW5JZDogcnVuTWFuYWdlcj8ucnVuSWQgfSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBvdXRwdXRWYWx1ZXM7XG4gICAgfVxuICAgIF92YWxpZGF0ZU91dHB1dHMob3V0cHV0cykge1xuICAgICAgICBjb25zdCBtaXNzaW5nS2V5cyA9IHRoaXMub3V0cHV0S2V5cy5maWx0ZXIoKGspID0+ICEoayBpbiBvdXRwdXRzKSk7XG4gICAgICAgIGlmIChtaXNzaW5nS2V5cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBvdXRwdXQga2V5czogJHttaXNzaW5nS2V5cy5qb2luKFwiLCBcIil9IGZyb20gY2hhaW4gJHt0aGlzLl9jaGFpblR5cGUoKX1gKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBwcmVwT3V0cHV0cyhpbnB1dHMsIG91dHB1dHMsIHJldHVybk9ubHlPdXRwdXRzID0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5fdmFsaWRhdGVPdXRwdXRzKG91dHB1dHMpO1xuICAgICAgICBpZiAodGhpcy5tZW1vcnkpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMubWVtb3J5LnNhdmVDb250ZXh0KGlucHV0cywgb3V0cHV0cyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJldHVybk9ubHlPdXRwdXRzKSB7XG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0cztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyAuLi5pbnB1dHMsIC4uLm91dHB1dHMgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEganNvbi1saWtlIG9iamVjdCByZXByZXNlbnRpbmcgdGhpcyBjaGFpbi5cbiAgICAgKi9cbiAgICBzZXJpYWxpemUoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1ldGhvZCBub3QgaW1wbGVtZW50ZWQuXCIpO1xuICAgIH1cbiAgICAvKiogQGRlcHJlY2F0ZWQgVXNlIC5pbnZva2UoKSBpbnN0ZWFkLiBXaWxsIGJlIHJlbW92ZWQgaW4gMC4yLjAuICovXG4gICAgYXN5bmMgcnVuKFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgaW5wdXQsIGNvbmZpZykge1xuICAgICAgICBjb25zdCBpbnB1dEtleXMgPSB0aGlzLmlucHV0S2V5cy5maWx0ZXIoKGspID0+ICF0aGlzLm1lbW9yeT8ubWVtb3J5S2V5cy5pbmNsdWRlcyhrKSA/PyB0cnVlKTtcbiAgICAgICAgY29uc3QgaXNLZXlsZXNzSW5wdXQgPSBpbnB1dEtleXMubGVuZ3RoIDw9IDE7XG4gICAgICAgIGlmICghaXNLZXlsZXNzSW5wdXQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2hhaW4gJHt0aGlzLl9jaGFpblR5cGUoKX0gZXhwZWN0cyBtdWx0aXBsZSBpbnB1dHMsIGNhbm5vdCB1c2UgJ3J1bicgYCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgY29uc3QgdmFsdWVzID0gaW5wdXRLZXlzLmxlbmd0aCA/IHsgW2lucHV0S2V5c1swXV06IGlucHV0IH0gOiB7fTtcbiAgICAgICAgY29uc3QgcmV0dXJuVmFsdWVzID0gYXdhaXQgdGhpcy5jYWxsKHZhbHVlcywgY29uZmlnKTtcbiAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHJldHVyblZhbHVlcyk7XG4gICAgICAgIGlmIChrZXlzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIHJldHVyblZhbHVlc1trZXlzWzBdXTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJyZXR1cm4gdmFsdWVzIGhhdmUgbXVsdGlwbGUga2V5cywgYHJ1bmAgb25seSBzdXBwb3J0ZWQgd2hlbiBvbmUga2V5IGN1cnJlbnRseVwiKTtcbiAgICB9XG4gICAgYXN5bmMgX2Zvcm1hdFZhbHVlcyh2YWx1ZXMpIHtcbiAgICAgICAgY29uc3QgZnVsbFZhbHVlcyA9IHsgLi4udmFsdWVzIH07XG4gICAgICAgIGlmIChmdWxsVmFsdWVzLnRpbWVvdXQgJiYgIWZ1bGxWYWx1ZXMuc2lnbmFsKSB7XG4gICAgICAgICAgICBmdWxsVmFsdWVzLnNpZ25hbCA9IEFib3J0U2lnbmFsLnRpbWVvdXQoZnVsbFZhbHVlcy50aW1lb3V0KTtcbiAgICAgICAgICAgIGRlbGV0ZSBmdWxsVmFsdWVzLnRpbWVvdXQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEodGhpcy5tZW1vcnkgPT0gbnVsbCkpIHtcbiAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlcyA9IGF3YWl0IHRoaXMubWVtb3J5LmxvYWRNZW1vcnlWYXJpYWJsZXModGhpcy5fc2VsZWN0TWVtb3J5SW5wdXRzKHZhbHVlcykpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMobmV3VmFsdWVzKSkge1xuICAgICAgICAgICAgICAgIGZ1bGxWYWx1ZXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmdWxsVmFsdWVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVwcmVjYXRlZCBVc2UgLmludm9rZSgpIGluc3RlYWQuIFdpbGwgYmUgcmVtb3ZlZCBpbiAwLjIuMC5cbiAgICAgKlxuICAgICAqIFJ1biB0aGUgY29yZSBsb2dpYyBvZiB0aGlzIGNoYWluIGFuZCBhZGQgdG8gb3V0cHV0IGlmIGRlc2lyZWQuXG4gICAgICpcbiAgICAgKiBXcmFwcyBfY2FsbCBhbmQgaGFuZGxlcyBtZW1vcnkuXG4gICAgICovXG4gICAgYXN5bmMgY2FsbCh2YWx1ZXMsIGNvbmZpZywgXG4gICAgLyoqIEBkZXByZWNhdGVkICovXG4gICAgdGFncykge1xuICAgICAgICBjb25zdCBwYXJzZWRDb25maWcgPSB7IHRhZ3MsIC4uLnBhcnNlQ2FsbGJhY2tDb25maWdBcmcoY29uZmlnKSB9O1xuICAgICAgICByZXR1cm4gdGhpcy5pbnZva2UodmFsdWVzLCBwYXJzZWRDb25maWcpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVwcmVjYXRlZCBVc2UgLmJhdGNoKCkgaW5zdGVhZC4gV2lsbCBiZSByZW1vdmVkIGluIDAuMi4wLlxuICAgICAqXG4gICAgICogQ2FsbCB0aGUgY2hhaW4gb24gYWxsIGlucHV0cyBpbiB0aGUgbGlzdFxuICAgICAqL1xuICAgIGFzeW5jIGFwcGx5KGlucHV0cywgY29uZmlnKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLmFsbChpbnB1dHMubWFwKGFzeW5jIChpLCBpZHgpID0+IHRoaXMuY2FsbChpLCBjb25maWc/LltpZHhdKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb2FkIGEgY2hhaW4gZnJvbSBhIGpzb24tbGlrZSBvYmplY3QgZGVzY3JpYmluZyBpdC5cbiAgICAgKi9cbiAgICBzdGF0aWMgYXN5bmMgZGVzZXJpYWxpemUoZGF0YSwgdmFsdWVzID0ge30pIHtcbiAgICAgICAgc3dpdGNoIChkYXRhLl90eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFwibGxtX2NoYWluXCI6IHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IExMTUNoYWluIH0gPSBhd2FpdCBpbXBvcnQoXCIuL2xsbV9jaGFpbi5qc1wiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gTExNQ2hhaW4uZGVzZXJpYWxpemUoZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFwic2VxdWVudGlhbF9jaGFpblwiOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBTZXF1ZW50aWFsQ2hhaW4gfSA9IGF3YWl0IGltcG9ydChcIi4vc2VxdWVudGlhbF9jaGFpbi5qc1wiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gU2VxdWVudGlhbENoYWluLmRlc2VyaWFsaXplKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBcInNpbXBsZV9zZXF1ZW50aWFsX2NoYWluXCI6IHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IFNpbXBsZVNlcXVlbnRpYWxDaGFpbiB9ID0gYXdhaXQgaW1wb3J0KFwiLi9zZXF1ZW50aWFsX2NoYWluLmpzXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBTaW1wbGVTZXF1ZW50aWFsQ2hhaW4uZGVzZXJpYWxpemUoZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFwic3R1ZmZfZG9jdW1lbnRzX2NoYWluXCI6IHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IFN0dWZmRG9jdW1lbnRzQ2hhaW4gfSA9IGF3YWl0IGltcG9ydChcIi4vY29tYmluZV9kb2NzX2NoYWluLmpzXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBTdHVmZkRvY3VtZW50c0NoYWluLmRlc2VyaWFsaXplKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBcIm1hcF9yZWR1Y2VfZG9jdW1lbnRzX2NoYWluXCI6IHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IE1hcFJlZHVjZURvY3VtZW50c0NoYWluIH0gPSBhd2FpdCBpbXBvcnQoXCIuL2NvbWJpbmVfZG9jc19jaGFpbi5qc1wiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gTWFwUmVkdWNlRG9jdW1lbnRzQ2hhaW4uZGVzZXJpYWxpemUoZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFwicmVmaW5lX2RvY3VtZW50c19jaGFpblwiOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBSZWZpbmVEb2N1bWVudHNDaGFpbiB9ID0gYXdhaXQgaW1wb3J0KFwiLi9jb21iaW5lX2RvY3NfY2hhaW4uanNcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlZmluZURvY3VtZW50c0NoYWluLmRlc2VyaWFsaXplKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBcInZlY3Rvcl9kYl9xYVwiOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBWZWN0b3JEQlFBQ2hhaW4gfSA9IGF3YWl0IGltcG9ydChcIi4vdmVjdG9yX2RiX3FhLmpzXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBWZWN0b3JEQlFBQ2hhaW4uZGVzZXJpYWxpemUoZGF0YSwgdmFsdWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgXCJhcGlfY2hhaW5cIjoge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgQVBJQ2hhaW4gfSA9IGF3YWl0IGltcG9ydChcIi4vYXBpL2FwaV9jaGFpbi5qc1wiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gQVBJQ2hhaW4uZGVzZXJpYWxpemUoZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBwcm9tcHQgdHlwZSBpbiBjb25maWc6ICR7ZGF0YS5fdHlwZX1gKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/chains/base.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/chains/combine_docs_chain.js":
/*!******************************************************************!*\
  !*** ./node_modules/langchain/dist/chains/combine_docs_chain.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MapReduceDocumentsChain: () => (/* binding */ MapReduceDocumentsChain),\n/* harmony export */   RefineDocumentsChain: () => (/* binding */ RefineDocumentsChain),\n/* harmony export */   StuffDocumentsChain: () => (/* binding */ StuffDocumentsChain)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/prompts */ \"(rsc)/./node_modules/@langchain/core/prompts.js\");\n/* harmony import */ var _base_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./base.js */ \"(rsc)/./node_modules/langchain/dist/chains/base.js\");\n/* harmony import */ var _llm_chain_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./llm_chain.js */ \"(rsc)/./node_modules/langchain/dist/chains/llm_chain.js\");\n\n\n\n/**\n * Chain that combines documents by stuffing into context.\n * @augments BaseChain\n * @augments StuffDocumentsChainInput\n */\nclass StuffDocumentsChain extends _base_js__WEBPACK_IMPORTED_MODULE_1__.BaseChain {\n    static lc_name() {\n        return \"StuffDocumentsChain\";\n    }\n    get inputKeys() {\n        return [this.inputKey, ...this.llmChain.inputKeys].filter((key) => key !== this.documentVariableName);\n    }\n    get outputKeys() {\n        return this.llmChain.outputKeys;\n    }\n    constructor(fields) {\n        super(fields);\n        Object.defineProperty(this, \"llmChain\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"inputKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"input_documents\"\n        });\n        Object.defineProperty(this, \"documentVariableName\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"context\"\n        });\n        this.llmChain = fields.llmChain;\n        this.documentVariableName =\n            fields.documentVariableName ?? this.documentVariableName;\n        this.inputKey = fields.inputKey ?? this.inputKey;\n    }\n    /** @ignore */\n    _prepInputs(values) {\n        if (!(this.inputKey in values)) {\n            throw new Error(`Document key ${this.inputKey} not found.`);\n        }\n        const { [this.inputKey]: docs, ...rest } = values;\n        const texts = docs.map(({ pageContent }) => pageContent);\n        const text = texts.join(\"\\n\\n\");\n        return {\n            ...rest,\n            [this.documentVariableName]: text,\n        };\n    }\n    /** @ignore */\n    async _call(values, runManager) {\n        const result = await this.llmChain.call(this._prepInputs(values), runManager?.getChild(\"combine_documents\"));\n        return result;\n    }\n    _chainType() {\n        return \"stuff_documents_chain\";\n    }\n    static async deserialize(data) {\n        if (!data.llm_chain) {\n            throw new Error(\"Missing llm_chain\");\n        }\n        return new StuffDocumentsChain({\n            llmChain: await _llm_chain_js__WEBPACK_IMPORTED_MODULE_2__.LLMChain.deserialize(data.llm_chain),\n        });\n    }\n    serialize() {\n        return {\n            _type: this._chainType(),\n            llm_chain: this.llmChain.serialize(),\n        };\n    }\n}\n/**\n * Combine documents by mapping a chain over them, then combining results.\n * @augments BaseChain\n * @augments StuffDocumentsChainInput\n */\nclass MapReduceDocumentsChain extends _base_js__WEBPACK_IMPORTED_MODULE_1__.BaseChain {\n    static lc_name() {\n        return \"MapReduceDocumentsChain\";\n    }\n    get inputKeys() {\n        return [this.inputKey, ...this.combineDocumentChain.inputKeys];\n    }\n    get outputKeys() {\n        return this.combineDocumentChain.outputKeys;\n    }\n    constructor(fields) {\n        super(fields);\n        Object.defineProperty(this, \"llmChain\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"inputKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"input_documents\"\n        });\n        Object.defineProperty(this, \"documentVariableName\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"context\"\n        });\n        Object.defineProperty(this, \"returnIntermediateSteps\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"maxTokens\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 3000\n        });\n        Object.defineProperty(this, \"maxIterations\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 10\n        });\n        Object.defineProperty(this, \"ensureMapStep\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"combineDocumentChain\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.llmChain = fields.llmChain;\n        this.combineDocumentChain = fields.combineDocumentChain;\n        this.documentVariableName =\n            fields.documentVariableName ?? this.documentVariableName;\n        this.ensureMapStep = fields.ensureMapStep ?? this.ensureMapStep;\n        this.inputKey = fields.inputKey ?? this.inputKey;\n        this.maxTokens = fields.maxTokens ?? this.maxTokens;\n        this.maxIterations = fields.maxIterations ?? this.maxIterations;\n        this.returnIntermediateSteps = fields.returnIntermediateSteps ?? false;\n    }\n    /** @ignore */\n    async _call(values, runManager) {\n        if (!(this.inputKey in values)) {\n            throw new Error(`Document key ${this.inputKey} not found.`);\n        }\n        const { [this.inputKey]: docs, ...rest } = values;\n        let currentDocs = docs;\n        let intermediateSteps = [];\n        // For each iteration, we'll use the `llmChain` to get a new result\n        for (let i = 0; i < this.maxIterations; i += 1) {\n            const inputs = currentDocs.map((d) => ({\n                [this.documentVariableName]: d.pageContent,\n                ...rest,\n            }));\n            const canSkipMapStep = i !== 0 || !this.ensureMapStep;\n            if (canSkipMapStep) {\n                // Calculate the total tokens required in the input\n                const formatted = await this.combineDocumentChain.llmChain.prompt.format(this.combineDocumentChain._prepInputs({\n                    [this.combineDocumentChain.inputKey]: currentDocs,\n                    ...rest,\n                }));\n                const length = await this.combineDocumentChain.llmChain._getNumTokens(formatted);\n                const withinTokenLimit = length < this.maxTokens;\n                // If we can skip the map step, and we're within the token limit, we don't\n                // need to run the map step, so just break out of the loop.\n                if (withinTokenLimit) {\n                    break;\n                }\n            }\n            const results = await this.llmChain.apply(inputs, \n            // If we have a runManager, then we need to create a child for each input\n            // so that we can track the progress of each input.\n            runManager\n                ? Array.from({ length: inputs.length }, (_, i) => runManager.getChild(`map_${i + 1}`))\n                : undefined);\n            const { outputKey } = this.llmChain;\n            // If the flag is set, then concat that to the intermediate steps\n            if (this.returnIntermediateSteps) {\n                intermediateSteps = intermediateSteps.concat(results.map((r) => r[outputKey]));\n            }\n            currentDocs = results.map((r) => ({\n                pageContent: r[outputKey],\n                metadata: {},\n            }));\n        }\n        // Now, with the final result of all the inputs from the `llmChain`, we can\n        // run the `combineDocumentChain` over them.\n        const newInputs = {\n            [this.combineDocumentChain.inputKey]: currentDocs,\n            ...rest,\n        };\n        const result = await this.combineDocumentChain.call(newInputs, runManager?.getChild(\"combine_documents\"));\n        // Return the intermediate steps results if the flag is set\n        if (this.returnIntermediateSteps) {\n            return { ...result, intermediateSteps };\n        }\n        return result;\n    }\n    _chainType() {\n        return \"map_reduce_documents_chain\";\n    }\n    static async deserialize(data) {\n        if (!data.llm_chain) {\n            throw new Error(\"Missing llm_chain\");\n        }\n        if (!data.combine_document_chain) {\n            throw new Error(\"Missing combine_document_chain\");\n        }\n        return new MapReduceDocumentsChain({\n            llmChain: await _llm_chain_js__WEBPACK_IMPORTED_MODULE_2__.LLMChain.deserialize(data.llm_chain),\n            combineDocumentChain: await StuffDocumentsChain.deserialize(data.combine_document_chain),\n        });\n    }\n    serialize() {\n        return {\n            _type: this._chainType(),\n            llm_chain: this.llmChain.serialize(),\n            combine_document_chain: this.combineDocumentChain.serialize(),\n        };\n    }\n}\n/**\n * Combine documents by doing a first pass and then refining on more documents.\n * @augments BaseChain\n * @augments RefineDocumentsChainInput\n */\nclass RefineDocumentsChain extends _base_js__WEBPACK_IMPORTED_MODULE_1__.BaseChain {\n    static lc_name() {\n        return \"RefineDocumentsChain\";\n    }\n    get defaultDocumentPrompt() {\n        return new _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate({\n            inputVariables: [\"page_content\"],\n            template: \"{page_content}\",\n        });\n    }\n    get inputKeys() {\n        return [\n            ...new Set([\n                this.inputKey,\n                ...this.llmChain.inputKeys,\n                ...this.refineLLMChain.inputKeys,\n            ]),\n        ].filter((key) => key !== this.documentVariableName && key !== this.initialResponseName);\n    }\n    get outputKeys() {\n        return [this.outputKey];\n    }\n    constructor(fields) {\n        super(fields);\n        Object.defineProperty(this, \"llmChain\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"inputKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"input_documents\"\n        });\n        Object.defineProperty(this, \"outputKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"output_text\"\n        });\n        Object.defineProperty(this, \"documentVariableName\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"context\"\n        });\n        Object.defineProperty(this, \"initialResponseName\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"existing_answer\"\n        });\n        Object.defineProperty(this, \"refineLLMChain\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"documentPrompt\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: this.defaultDocumentPrompt\n        });\n        this.llmChain = fields.llmChain;\n        this.refineLLMChain = fields.refineLLMChain;\n        this.documentVariableName =\n            fields.documentVariableName ?? this.documentVariableName;\n        this.inputKey = fields.inputKey ?? this.inputKey;\n        this.outputKey = fields.outputKey ?? this.outputKey;\n        this.documentPrompt = fields.documentPrompt ?? this.documentPrompt;\n        this.initialResponseName =\n            fields.initialResponseName ?? this.initialResponseName;\n    }\n    /** @ignore */\n    async _constructInitialInputs(doc, rest) {\n        const baseInfo = {\n            page_content: doc.pageContent,\n            ...doc.metadata,\n        };\n        const documentInfo = {};\n        this.documentPrompt.inputVariables.forEach((value) => {\n            documentInfo[value] = baseInfo[value];\n        });\n        const baseInputs = {\n            [this.documentVariableName]: await this.documentPrompt.format({\n                ...documentInfo,\n            }),\n        };\n        const inputs = { ...baseInputs, ...rest };\n        return inputs;\n    }\n    /** @ignore */\n    async _constructRefineInputs(doc, res) {\n        const baseInfo = {\n            page_content: doc.pageContent,\n            ...doc.metadata,\n        };\n        const documentInfo = {};\n        this.documentPrompt.inputVariables.forEach((value) => {\n            documentInfo[value] = baseInfo[value];\n        });\n        const baseInputs = {\n            [this.documentVariableName]: await this.documentPrompt.format({\n                ...documentInfo,\n            }),\n        };\n        const inputs = { [this.initialResponseName]: res, ...baseInputs };\n        return inputs;\n    }\n    /** @ignore */\n    async _call(values, runManager) {\n        if (!(this.inputKey in values)) {\n            throw new Error(`Document key ${this.inputKey} not found.`);\n        }\n        const { [this.inputKey]: docs, ...rest } = values;\n        const currentDocs = docs;\n        const initialInputs = await this._constructInitialInputs(currentDocs[0], rest);\n        let res = await this.llmChain.predict({ ...initialInputs }, runManager?.getChild(\"answer\"));\n        const refineSteps = [res];\n        for (let i = 1; i < currentDocs.length; i += 1) {\n            const refineInputs = await this._constructRefineInputs(currentDocs[i], res);\n            const inputs = { ...refineInputs, ...rest };\n            res = await this.refineLLMChain.predict({ ...inputs }, runManager?.getChild(\"refine\"));\n            refineSteps.push(res);\n        }\n        return { [this.outputKey]: res };\n    }\n    _chainType() {\n        return \"refine_documents_chain\";\n    }\n    static async deserialize(data) {\n        const SerializedLLMChain = data.llm_chain;\n        if (!SerializedLLMChain) {\n            throw new Error(\"Missing llm_chain\");\n        }\n        const SerializedRefineDocumentChain = data.refine_llm_chain;\n        if (!SerializedRefineDocumentChain) {\n            throw new Error(\"Missing refine_llm_chain\");\n        }\n        return new RefineDocumentsChain({\n            llmChain: await _llm_chain_js__WEBPACK_IMPORTED_MODULE_2__.LLMChain.deserialize(SerializedLLMChain),\n            refineLLMChain: await _llm_chain_js__WEBPACK_IMPORTED_MODULE_2__.LLMChain.deserialize(SerializedRefineDocumentChain),\n        });\n    }\n    serialize() {\n        return {\n            _type: this._chainType(),\n            llm_chain: this.llmChain.serialize(),\n            refine_llm_chain: this.refineLLMChain.serialize(),\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL2NvbWJpbmVfZG9jc19jaGFpbi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBeUQ7QUFDbkI7QUFDSTtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sa0NBQWtDLCtDQUFTO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLGVBQWU7QUFDM0Q7QUFDQSxnQkFBZ0IsaUNBQWlDO0FBQ2pELGtDQUFrQyxhQUFhO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLG1EQUFRO0FBQ3BDLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLHNDQUFzQywrQ0FBUztBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLGVBQWU7QUFDM0Q7QUFDQSxnQkFBZ0IsaUNBQWlDO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix3QkFBd0I7QUFDaEQ7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsdUJBQXVCLHVDQUF1QyxNQUFNO0FBQ25HO0FBQ0Esb0JBQW9CLFlBQVk7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLG1EQUFRO0FBQ3BDO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyxtQ0FBbUMsK0NBQVM7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsbUVBQWM7QUFDakM7QUFDQSx3QkFBd0IsYUFBYTtBQUNyQyxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxlQUFlO0FBQzNEO0FBQ0EsZ0JBQWdCLGlDQUFpQztBQUNqRDtBQUNBO0FBQ0EsZ0RBQWdELGtCQUFrQjtBQUNsRTtBQUNBLHdCQUF3Qix3QkFBd0I7QUFDaEQ7QUFDQSw2QkFBNkI7QUFDN0Isc0RBQXNELFdBQVc7QUFDakU7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLG1EQUFRO0FBQ3BDLGtDQUFrQyxtREFBUTtBQUMxQyxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWktY29tcGFuaW9uLy4vbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2NoYWlucy9jb21iaW5lX2RvY3NfY2hhaW4uanM/MjMyOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcm9tcHRUZW1wbGF0ZSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvcHJvbXB0c1wiO1xuaW1wb3J0IHsgQmFzZUNoYWluIH0gZnJvbSBcIi4vYmFzZS5qc1wiO1xuaW1wb3J0IHsgTExNQ2hhaW4gfSBmcm9tIFwiLi9sbG1fY2hhaW4uanNcIjtcbi8qKlxuICogQ2hhaW4gdGhhdCBjb21iaW5lcyBkb2N1bWVudHMgYnkgc3R1ZmZpbmcgaW50byBjb250ZXh0LlxuICogQGF1Z21lbnRzIEJhc2VDaGFpblxuICogQGF1Z21lbnRzIFN0dWZmRG9jdW1lbnRzQ2hhaW5JbnB1dFxuICovXG5leHBvcnQgY2xhc3MgU3R1ZmZEb2N1bWVudHNDaGFpbiBleHRlbmRzIEJhc2VDaGFpbiB7XG4gICAgc3RhdGljIGxjX25hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIlN0dWZmRG9jdW1lbnRzQ2hhaW5cIjtcbiAgICB9XG4gICAgZ2V0IGlucHV0S2V5cygpIHtcbiAgICAgICAgcmV0dXJuIFt0aGlzLmlucHV0S2V5LCAuLi50aGlzLmxsbUNoYWluLmlucHV0S2V5c10uZmlsdGVyKChrZXkpID0+IGtleSAhPT0gdGhpcy5kb2N1bWVudFZhcmlhYmxlTmFtZSk7XG4gICAgfVxuICAgIGdldCBvdXRwdXRLZXlzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sbG1DaGFpbi5vdXRwdXRLZXlzO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihmaWVsZHMpIHtcbiAgICAgICAgc3VwZXIoZmllbGRzKTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibGxtQ2hhaW5cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiaW5wdXRLZXlcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IFwiaW5wdXRfZG9jdW1lbnRzXCJcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImRvY3VtZW50VmFyaWFibGVOYW1lXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBcImNvbnRleHRcIlxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5sbG1DaGFpbiA9IGZpZWxkcy5sbG1DaGFpbjtcbiAgICAgICAgdGhpcy5kb2N1bWVudFZhcmlhYmxlTmFtZSA9XG4gICAgICAgICAgICBmaWVsZHMuZG9jdW1lbnRWYXJpYWJsZU5hbWUgPz8gdGhpcy5kb2N1bWVudFZhcmlhYmxlTmFtZTtcbiAgICAgICAgdGhpcy5pbnB1dEtleSA9IGZpZWxkcy5pbnB1dEtleSA/PyB0aGlzLmlucHV0S2V5O1xuICAgIH1cbiAgICAvKiogQGlnbm9yZSAqL1xuICAgIF9wcmVwSW5wdXRzKHZhbHVlcykge1xuICAgICAgICBpZiAoISh0aGlzLmlucHV0S2V5IGluIHZhbHVlcykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRG9jdW1lbnQga2V5ICR7dGhpcy5pbnB1dEtleX0gbm90IGZvdW5kLmApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHsgW3RoaXMuaW5wdXRLZXldOiBkb2NzLCAuLi5yZXN0IH0gPSB2YWx1ZXM7XG4gICAgICAgIGNvbnN0IHRleHRzID0gZG9jcy5tYXAoKHsgcGFnZUNvbnRlbnQgfSkgPT4gcGFnZUNvbnRlbnQpO1xuICAgICAgICBjb25zdCB0ZXh0ID0gdGV4dHMuam9pbihcIlxcblxcblwiKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLnJlc3QsXG4gICAgICAgICAgICBbdGhpcy5kb2N1bWVudFZhcmlhYmxlTmFtZV06IHRleHQsXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKiBAaWdub3JlICovXG4gICAgYXN5bmMgX2NhbGwodmFsdWVzLCBydW5NYW5hZ2VyKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMubGxtQ2hhaW4uY2FsbCh0aGlzLl9wcmVwSW5wdXRzKHZhbHVlcyksIHJ1bk1hbmFnZXI/LmdldENoaWxkKFwiY29tYmluZV9kb2N1bWVudHNcIikpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBfY2hhaW5UeXBlKCkge1xuICAgICAgICByZXR1cm4gXCJzdHVmZl9kb2N1bWVudHNfY2hhaW5cIjtcbiAgICB9XG4gICAgc3RhdGljIGFzeW5jIGRlc2VyaWFsaXplKGRhdGEpIHtcbiAgICAgICAgaWYgKCFkYXRhLmxsbV9jaGFpbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyBsbG1fY2hhaW5cIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBTdHVmZkRvY3VtZW50c0NoYWluKHtcbiAgICAgICAgICAgIGxsbUNoYWluOiBhd2FpdCBMTE1DaGFpbi5kZXNlcmlhbGl6ZShkYXRhLmxsbV9jaGFpbiksXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXJpYWxpemUoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBfdHlwZTogdGhpcy5fY2hhaW5UeXBlKCksXG4gICAgICAgICAgICBsbG1fY2hhaW46IHRoaXMubGxtQ2hhaW4uc2VyaWFsaXplKCksXG4gICAgICAgIH07XG4gICAgfVxufVxuLyoqXG4gKiBDb21iaW5lIGRvY3VtZW50cyBieSBtYXBwaW5nIGEgY2hhaW4gb3ZlciB0aGVtLCB0aGVuIGNvbWJpbmluZyByZXN1bHRzLlxuICogQGF1Z21lbnRzIEJhc2VDaGFpblxuICogQGF1Z21lbnRzIFN0dWZmRG9jdW1lbnRzQ2hhaW5JbnB1dFxuICovXG5leHBvcnQgY2xhc3MgTWFwUmVkdWNlRG9jdW1lbnRzQ2hhaW4gZXh0ZW5kcyBCYXNlQ2hhaW4ge1xuICAgIHN0YXRpYyBsY19uYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJNYXBSZWR1Y2VEb2N1bWVudHNDaGFpblwiO1xuICAgIH1cbiAgICBnZXQgaW5wdXRLZXlzKCkge1xuICAgICAgICByZXR1cm4gW3RoaXMuaW5wdXRLZXksIC4uLnRoaXMuY29tYmluZURvY3VtZW50Q2hhaW4uaW5wdXRLZXlzXTtcbiAgICB9XG4gICAgZ2V0IG91dHB1dEtleXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbWJpbmVEb2N1bWVudENoYWluLm91dHB1dEtleXM7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKGZpZWxkcykge1xuICAgICAgICBzdXBlcihmaWVsZHMpO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJsbG1DaGFpblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJpbnB1dEtleVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogXCJpbnB1dF9kb2N1bWVudHNcIlxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZG9jdW1lbnRWYXJpYWJsZU5hbWVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IFwiY29udGV4dFwiXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJyZXR1cm5JbnRlcm1lZGlhdGVTdGVwc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1heFRva2Vuc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogMzAwMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibWF4SXRlcmF0aW9uc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogMTBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImVuc3VyZU1hcFN0ZXBcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjb21iaW5lRG9jdW1lbnRDaGFpblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxsbUNoYWluID0gZmllbGRzLmxsbUNoYWluO1xuICAgICAgICB0aGlzLmNvbWJpbmVEb2N1bWVudENoYWluID0gZmllbGRzLmNvbWJpbmVEb2N1bWVudENoYWluO1xuICAgICAgICB0aGlzLmRvY3VtZW50VmFyaWFibGVOYW1lID1cbiAgICAgICAgICAgIGZpZWxkcy5kb2N1bWVudFZhcmlhYmxlTmFtZSA/PyB0aGlzLmRvY3VtZW50VmFyaWFibGVOYW1lO1xuICAgICAgICB0aGlzLmVuc3VyZU1hcFN0ZXAgPSBmaWVsZHMuZW5zdXJlTWFwU3RlcCA/PyB0aGlzLmVuc3VyZU1hcFN0ZXA7XG4gICAgICAgIHRoaXMuaW5wdXRLZXkgPSBmaWVsZHMuaW5wdXRLZXkgPz8gdGhpcy5pbnB1dEtleTtcbiAgICAgICAgdGhpcy5tYXhUb2tlbnMgPSBmaWVsZHMubWF4VG9rZW5zID8/IHRoaXMubWF4VG9rZW5zO1xuICAgICAgICB0aGlzLm1heEl0ZXJhdGlvbnMgPSBmaWVsZHMubWF4SXRlcmF0aW9ucyA/PyB0aGlzLm1heEl0ZXJhdGlvbnM7XG4gICAgICAgIHRoaXMucmV0dXJuSW50ZXJtZWRpYXRlU3RlcHMgPSBmaWVsZHMucmV0dXJuSW50ZXJtZWRpYXRlU3RlcHMgPz8gZmFsc2U7XG4gICAgfVxuICAgIC8qKiBAaWdub3JlICovXG4gICAgYXN5bmMgX2NhbGwodmFsdWVzLCBydW5NYW5hZ2VyKSB7XG4gICAgICAgIGlmICghKHRoaXMuaW5wdXRLZXkgaW4gdmFsdWVzKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBEb2N1bWVudCBrZXkgJHt0aGlzLmlucHV0S2V5fSBub3QgZm91bmQuYCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBbdGhpcy5pbnB1dEtleV06IGRvY3MsIC4uLnJlc3QgfSA9IHZhbHVlcztcbiAgICAgICAgbGV0IGN1cnJlbnREb2NzID0gZG9jcztcbiAgICAgICAgbGV0IGludGVybWVkaWF0ZVN0ZXBzID0gW107XG4gICAgICAgIC8vIEZvciBlYWNoIGl0ZXJhdGlvbiwgd2UnbGwgdXNlIHRoZSBgbGxtQ2hhaW5gIHRvIGdldCBhIG5ldyByZXN1bHRcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm1heEl0ZXJhdGlvbnM7IGkgKz0gMSkge1xuICAgICAgICAgICAgY29uc3QgaW5wdXRzID0gY3VycmVudERvY3MubWFwKChkKSA9PiAoe1xuICAgICAgICAgICAgICAgIFt0aGlzLmRvY3VtZW50VmFyaWFibGVOYW1lXTogZC5wYWdlQ29udGVudCxcbiAgICAgICAgICAgICAgICAuLi5yZXN0LFxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgY29uc3QgY2FuU2tpcE1hcFN0ZXAgPSBpICE9PSAwIHx8ICF0aGlzLmVuc3VyZU1hcFN0ZXA7XG4gICAgICAgICAgICBpZiAoY2FuU2tpcE1hcFN0ZXApIHtcbiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIHRvdGFsIHRva2VucyByZXF1aXJlZCBpbiB0aGUgaW5wdXRcbiAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBhd2FpdCB0aGlzLmNvbWJpbmVEb2N1bWVudENoYWluLmxsbUNoYWluLnByb21wdC5mb3JtYXQodGhpcy5jb21iaW5lRG9jdW1lbnRDaGFpbi5fcHJlcElucHV0cyh7XG4gICAgICAgICAgICAgICAgICAgIFt0aGlzLmNvbWJpbmVEb2N1bWVudENoYWluLmlucHV0S2V5XTogY3VycmVudERvY3MsXG4gICAgICAgICAgICAgICAgICAgIC4uLnJlc3QsXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxlbmd0aCA9IGF3YWl0IHRoaXMuY29tYmluZURvY3VtZW50Q2hhaW4ubGxtQ2hhaW4uX2dldE51bVRva2Vucyhmb3JtYXR0ZWQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHdpdGhpblRva2VuTGltaXQgPSBsZW5ndGggPCB0aGlzLm1heFRva2VucztcbiAgICAgICAgICAgICAgICAvLyBJZiB3ZSBjYW4gc2tpcCB0aGUgbWFwIHN0ZXAsIGFuZCB3ZSdyZSB3aXRoaW4gdGhlIHRva2VuIGxpbWl0LCB3ZSBkb24ndFxuICAgICAgICAgICAgICAgIC8vIG5lZWQgdG8gcnVuIHRoZSBtYXAgc3RlcCwgc28ganVzdCBicmVhayBvdXQgb2YgdGhlIGxvb3AuXG4gICAgICAgICAgICAgICAgaWYgKHdpdGhpblRva2VuTGltaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHRoaXMubGxtQ2hhaW4uYXBwbHkoaW5wdXRzLCBcbiAgICAgICAgICAgIC8vIElmIHdlIGhhdmUgYSBydW5NYW5hZ2VyLCB0aGVuIHdlIG5lZWQgdG8gY3JlYXRlIGEgY2hpbGQgZm9yIGVhY2ggaW5wdXRcbiAgICAgICAgICAgIC8vIHNvIHRoYXQgd2UgY2FuIHRyYWNrIHRoZSBwcm9ncmVzcyBvZiBlYWNoIGlucHV0LlxuICAgICAgICAgICAgcnVuTWFuYWdlclxuICAgICAgICAgICAgICAgID8gQXJyYXkuZnJvbSh7IGxlbmd0aDogaW5wdXRzLmxlbmd0aCB9LCAoXywgaSkgPT4gcnVuTWFuYWdlci5nZXRDaGlsZChgbWFwXyR7aSArIDF9YCkpXG4gICAgICAgICAgICAgICAgOiB1bmRlZmluZWQpO1xuICAgICAgICAgICAgY29uc3QgeyBvdXRwdXRLZXkgfSA9IHRoaXMubGxtQ2hhaW47XG4gICAgICAgICAgICAvLyBJZiB0aGUgZmxhZyBpcyBzZXQsIHRoZW4gY29uY2F0IHRoYXQgdG8gdGhlIGludGVybWVkaWF0ZSBzdGVwc1xuICAgICAgICAgICAgaWYgKHRoaXMucmV0dXJuSW50ZXJtZWRpYXRlU3RlcHMpIHtcbiAgICAgICAgICAgICAgICBpbnRlcm1lZGlhdGVTdGVwcyA9IGludGVybWVkaWF0ZVN0ZXBzLmNvbmNhdChyZXN1bHRzLm1hcCgocikgPT4gcltvdXRwdXRLZXldKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyZW50RG9jcyA9IHJlc3VsdHMubWFwKChyKSA9PiAoe1xuICAgICAgICAgICAgICAgIHBhZ2VDb250ZW50OiByW291dHB1dEtleV0sXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IHt9LFxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIC8vIE5vdywgd2l0aCB0aGUgZmluYWwgcmVzdWx0IG9mIGFsbCB0aGUgaW5wdXRzIGZyb20gdGhlIGBsbG1DaGFpbmAsIHdlIGNhblxuICAgICAgICAvLyBydW4gdGhlIGBjb21iaW5lRG9jdW1lbnRDaGFpbmAgb3ZlciB0aGVtLlxuICAgICAgICBjb25zdCBuZXdJbnB1dHMgPSB7XG4gICAgICAgICAgICBbdGhpcy5jb21iaW5lRG9jdW1lbnRDaGFpbi5pbnB1dEtleV06IGN1cnJlbnREb2NzLFxuICAgICAgICAgICAgLi4ucmVzdCxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jb21iaW5lRG9jdW1lbnRDaGFpbi5jYWxsKG5ld0lucHV0cywgcnVuTWFuYWdlcj8uZ2V0Q2hpbGQoXCJjb21iaW5lX2RvY3VtZW50c1wiKSk7XG4gICAgICAgIC8vIFJldHVybiB0aGUgaW50ZXJtZWRpYXRlIHN0ZXBzIHJlc3VsdHMgaWYgdGhlIGZsYWcgaXMgc2V0XG4gICAgICAgIGlmICh0aGlzLnJldHVybkludGVybWVkaWF0ZVN0ZXBzKSB7XG4gICAgICAgICAgICByZXR1cm4geyAuLi5yZXN1bHQsIGludGVybWVkaWF0ZVN0ZXBzIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgX2NoYWluVHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIFwibWFwX3JlZHVjZV9kb2N1bWVudHNfY2hhaW5cIjtcbiAgICB9XG4gICAgc3RhdGljIGFzeW5jIGRlc2VyaWFsaXplKGRhdGEpIHtcbiAgICAgICAgaWYgKCFkYXRhLmxsbV9jaGFpbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyBsbG1fY2hhaW5cIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFkYXRhLmNvbWJpbmVfZG9jdW1lbnRfY2hhaW4pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgY29tYmluZV9kb2N1bWVudF9jaGFpblwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IE1hcFJlZHVjZURvY3VtZW50c0NoYWluKHtcbiAgICAgICAgICAgIGxsbUNoYWluOiBhd2FpdCBMTE1DaGFpbi5kZXNlcmlhbGl6ZShkYXRhLmxsbV9jaGFpbiksXG4gICAgICAgICAgICBjb21iaW5lRG9jdW1lbnRDaGFpbjogYXdhaXQgU3R1ZmZEb2N1bWVudHNDaGFpbi5kZXNlcmlhbGl6ZShkYXRhLmNvbWJpbmVfZG9jdW1lbnRfY2hhaW4pLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VyaWFsaXplKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgX3R5cGU6IHRoaXMuX2NoYWluVHlwZSgpLFxuICAgICAgICAgICAgbGxtX2NoYWluOiB0aGlzLmxsbUNoYWluLnNlcmlhbGl6ZSgpLFxuICAgICAgICAgICAgY29tYmluZV9kb2N1bWVudF9jaGFpbjogdGhpcy5jb21iaW5lRG9jdW1lbnRDaGFpbi5zZXJpYWxpemUoKSxcbiAgICAgICAgfTtcbiAgICB9XG59XG4vKipcbiAqIENvbWJpbmUgZG9jdW1lbnRzIGJ5IGRvaW5nIGEgZmlyc3QgcGFzcyBhbmQgdGhlbiByZWZpbmluZyBvbiBtb3JlIGRvY3VtZW50cy5cbiAqIEBhdWdtZW50cyBCYXNlQ2hhaW5cbiAqIEBhdWdtZW50cyBSZWZpbmVEb2N1bWVudHNDaGFpbklucHV0XG4gKi9cbmV4cG9ydCBjbGFzcyBSZWZpbmVEb2N1bWVudHNDaGFpbiBleHRlbmRzIEJhc2VDaGFpbiB7XG4gICAgc3RhdGljIGxjX25hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIlJlZmluZURvY3VtZW50c0NoYWluXCI7XG4gICAgfVxuICAgIGdldCBkZWZhdWx0RG9jdW1lbnRQcm9tcHQoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbXB0VGVtcGxhdGUoe1xuICAgICAgICAgICAgaW5wdXRWYXJpYWJsZXM6IFtcInBhZ2VfY29udGVudFwiXSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiBcIntwYWdlX2NvbnRlbnR9XCIsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXQgaW5wdXRLZXlzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgLi4ubmV3IFNldChbXG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dEtleSxcbiAgICAgICAgICAgICAgICAuLi50aGlzLmxsbUNoYWluLmlucHV0S2V5cyxcbiAgICAgICAgICAgICAgICAuLi50aGlzLnJlZmluZUxMTUNoYWluLmlucHV0S2V5cyxcbiAgICAgICAgICAgIF0pLFxuICAgICAgICBdLmZpbHRlcigoa2V5KSA9PiBrZXkgIT09IHRoaXMuZG9jdW1lbnRWYXJpYWJsZU5hbWUgJiYga2V5ICE9PSB0aGlzLmluaXRpYWxSZXNwb25zZU5hbWUpO1xuICAgIH1cbiAgICBnZXQgb3V0cHV0S2V5cygpIHtcbiAgICAgICAgcmV0dXJuIFt0aGlzLm91dHB1dEtleV07XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKGZpZWxkcykge1xuICAgICAgICBzdXBlcihmaWVsZHMpO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJsbG1DaGFpblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJpbnB1dEtleVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogXCJpbnB1dF9kb2N1bWVudHNcIlxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwib3V0cHV0S2V5XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBcIm91dHB1dF90ZXh0XCJcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImRvY3VtZW50VmFyaWFibGVOYW1lXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBcImNvbnRleHRcIlxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiaW5pdGlhbFJlc3BvbnNlTmFtZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogXCJleGlzdGluZ19hbnN3ZXJcIlxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwicmVmaW5lTExNQ2hhaW5cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZG9jdW1lbnRQcm9tcHRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHRoaXMuZGVmYXVsdERvY3VtZW50UHJvbXB0XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxsbUNoYWluID0gZmllbGRzLmxsbUNoYWluO1xuICAgICAgICB0aGlzLnJlZmluZUxMTUNoYWluID0gZmllbGRzLnJlZmluZUxMTUNoYWluO1xuICAgICAgICB0aGlzLmRvY3VtZW50VmFyaWFibGVOYW1lID1cbiAgICAgICAgICAgIGZpZWxkcy5kb2N1bWVudFZhcmlhYmxlTmFtZSA/PyB0aGlzLmRvY3VtZW50VmFyaWFibGVOYW1lO1xuICAgICAgICB0aGlzLmlucHV0S2V5ID0gZmllbGRzLmlucHV0S2V5ID8/IHRoaXMuaW5wdXRLZXk7XG4gICAgICAgIHRoaXMub3V0cHV0S2V5ID0gZmllbGRzLm91dHB1dEtleSA/PyB0aGlzLm91dHB1dEtleTtcbiAgICAgICAgdGhpcy5kb2N1bWVudFByb21wdCA9IGZpZWxkcy5kb2N1bWVudFByb21wdCA/PyB0aGlzLmRvY3VtZW50UHJvbXB0O1xuICAgICAgICB0aGlzLmluaXRpYWxSZXNwb25zZU5hbWUgPVxuICAgICAgICAgICAgZmllbGRzLmluaXRpYWxSZXNwb25zZU5hbWUgPz8gdGhpcy5pbml0aWFsUmVzcG9uc2VOYW1lO1xuICAgIH1cbiAgICAvKiogQGlnbm9yZSAqL1xuICAgIGFzeW5jIF9jb25zdHJ1Y3RJbml0aWFsSW5wdXRzKGRvYywgcmVzdCkge1xuICAgICAgICBjb25zdCBiYXNlSW5mbyA9IHtcbiAgICAgICAgICAgIHBhZ2VfY29udGVudDogZG9jLnBhZ2VDb250ZW50LFxuICAgICAgICAgICAgLi4uZG9jLm1ldGFkYXRhLFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBkb2N1bWVudEluZm8gPSB7fTtcbiAgICAgICAgdGhpcy5kb2N1bWVudFByb21wdC5pbnB1dFZhcmlhYmxlcy5mb3JFYWNoKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgZG9jdW1lbnRJbmZvW3ZhbHVlXSA9IGJhc2VJbmZvW3ZhbHVlXTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGJhc2VJbnB1dHMgPSB7XG4gICAgICAgICAgICBbdGhpcy5kb2N1bWVudFZhcmlhYmxlTmFtZV06IGF3YWl0IHRoaXMuZG9jdW1lbnRQcm9tcHQuZm9ybWF0KHtcbiAgICAgICAgICAgICAgICAuLi5kb2N1bWVudEluZm8sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaW5wdXRzID0geyAuLi5iYXNlSW5wdXRzLCAuLi5yZXN0IH07XG4gICAgICAgIHJldHVybiBpbnB1dHM7XG4gICAgfVxuICAgIC8qKiBAaWdub3JlICovXG4gICAgYXN5bmMgX2NvbnN0cnVjdFJlZmluZUlucHV0cyhkb2MsIHJlcykge1xuICAgICAgICBjb25zdCBiYXNlSW5mbyA9IHtcbiAgICAgICAgICAgIHBhZ2VfY29udGVudDogZG9jLnBhZ2VDb250ZW50LFxuICAgICAgICAgICAgLi4uZG9jLm1ldGFkYXRhLFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBkb2N1bWVudEluZm8gPSB7fTtcbiAgICAgICAgdGhpcy5kb2N1bWVudFByb21wdC5pbnB1dFZhcmlhYmxlcy5mb3JFYWNoKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgZG9jdW1lbnRJbmZvW3ZhbHVlXSA9IGJhc2VJbmZvW3ZhbHVlXTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGJhc2VJbnB1dHMgPSB7XG4gICAgICAgICAgICBbdGhpcy5kb2N1bWVudFZhcmlhYmxlTmFtZV06IGF3YWl0IHRoaXMuZG9jdW1lbnRQcm9tcHQuZm9ybWF0KHtcbiAgICAgICAgICAgICAgICAuLi5kb2N1bWVudEluZm8sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaW5wdXRzID0geyBbdGhpcy5pbml0aWFsUmVzcG9uc2VOYW1lXTogcmVzLCAuLi5iYXNlSW5wdXRzIH07XG4gICAgICAgIHJldHVybiBpbnB1dHM7XG4gICAgfVxuICAgIC8qKiBAaWdub3JlICovXG4gICAgYXN5bmMgX2NhbGwodmFsdWVzLCBydW5NYW5hZ2VyKSB7XG4gICAgICAgIGlmICghKHRoaXMuaW5wdXRLZXkgaW4gdmFsdWVzKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBEb2N1bWVudCBrZXkgJHt0aGlzLmlucHV0S2V5fSBub3QgZm91bmQuYCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBbdGhpcy5pbnB1dEtleV06IGRvY3MsIC4uLnJlc3QgfSA9IHZhbHVlcztcbiAgICAgICAgY29uc3QgY3VycmVudERvY3MgPSBkb2NzO1xuICAgICAgICBjb25zdCBpbml0aWFsSW5wdXRzID0gYXdhaXQgdGhpcy5fY29uc3RydWN0SW5pdGlhbElucHV0cyhjdXJyZW50RG9jc1swXSwgcmVzdCk7XG4gICAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLmxsbUNoYWluLnByZWRpY3QoeyAuLi5pbml0aWFsSW5wdXRzIH0sIHJ1bk1hbmFnZXI/LmdldENoaWxkKFwiYW5zd2VyXCIpKTtcbiAgICAgICAgY29uc3QgcmVmaW5lU3RlcHMgPSBbcmVzXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBjdXJyZW50RG9jcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgY29uc3QgcmVmaW5lSW5wdXRzID0gYXdhaXQgdGhpcy5fY29uc3RydWN0UmVmaW5lSW5wdXRzKGN1cnJlbnREb2NzW2ldLCByZXMpO1xuICAgICAgICAgICAgY29uc3QgaW5wdXRzID0geyAuLi5yZWZpbmVJbnB1dHMsIC4uLnJlc3QgfTtcbiAgICAgICAgICAgIHJlcyA9IGF3YWl0IHRoaXMucmVmaW5lTExNQ2hhaW4ucHJlZGljdCh7IC4uLmlucHV0cyB9LCBydW5NYW5hZ2VyPy5nZXRDaGlsZChcInJlZmluZVwiKSk7XG4gICAgICAgICAgICByZWZpbmVTdGVwcy5wdXNoKHJlcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgW3RoaXMub3V0cHV0S2V5XTogcmVzIH07XG4gICAgfVxuICAgIF9jaGFpblR5cGUoKSB7XG4gICAgICAgIHJldHVybiBcInJlZmluZV9kb2N1bWVudHNfY2hhaW5cIjtcbiAgICB9XG4gICAgc3RhdGljIGFzeW5jIGRlc2VyaWFsaXplKGRhdGEpIHtcbiAgICAgICAgY29uc3QgU2VyaWFsaXplZExMTUNoYWluID0gZGF0YS5sbG1fY2hhaW47XG4gICAgICAgIGlmICghU2VyaWFsaXplZExMTUNoYWluKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIGxsbV9jaGFpblwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBTZXJpYWxpemVkUmVmaW5lRG9jdW1lbnRDaGFpbiA9IGRhdGEucmVmaW5lX2xsbV9jaGFpbjtcbiAgICAgICAgaWYgKCFTZXJpYWxpemVkUmVmaW5lRG9jdW1lbnRDaGFpbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyByZWZpbmVfbGxtX2NoYWluXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgUmVmaW5lRG9jdW1lbnRzQ2hhaW4oe1xuICAgICAgICAgICAgbGxtQ2hhaW46IGF3YWl0IExMTUNoYWluLmRlc2VyaWFsaXplKFNlcmlhbGl6ZWRMTE1DaGFpbiksXG4gICAgICAgICAgICByZWZpbmVMTE1DaGFpbjogYXdhaXQgTExNQ2hhaW4uZGVzZXJpYWxpemUoU2VyaWFsaXplZFJlZmluZURvY3VtZW50Q2hhaW4pLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VyaWFsaXplKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgX3R5cGU6IHRoaXMuX2NoYWluVHlwZSgpLFxuICAgICAgICAgICAgbGxtX2NoYWluOiB0aGlzLmxsbUNoYWluLnNlcmlhbGl6ZSgpLFxuICAgICAgICAgICAgcmVmaW5lX2xsbV9jaGFpbjogdGhpcy5yZWZpbmVMTE1DaGFpbi5zZXJpYWxpemUoKSxcbiAgICAgICAgfTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/chains/combine_docs_chain.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/chains/llm_chain.js":
/*!*********************************************************!*\
  !*** ./node_modules/langchain/dist/chains/llm_chain.js ***!
  \*********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LLMChain: () => (/* binding */ LLMChain)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_language_models_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/language_models/base */ \"(rsc)/./node_modules/@langchain/core/language_models/base.js\");\n/* harmony import */ var _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/prompts */ \"(rsc)/./node_modules/@langchain/core/prompts.js\");\n/* harmony import */ var _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/core/runnables */ \"(rsc)/./node_modules/@langchain/core/runnables.js\");\n/* harmony import */ var _base_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./base.js */ \"(rsc)/./node_modules/langchain/dist/chains/base.js\");\n/* harmony import */ var _output_parsers_noop_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../output_parsers/noop.js */ \"(rsc)/./node_modules/langchain/dist/output_parsers/noop.js\");\n\n\n\n\n\nfunction isBaseLanguageModel(llmLike) {\n    return typeof llmLike._llmType === \"function\";\n}\nfunction _getLanguageModel(llmLike) {\n    if (isBaseLanguageModel(llmLike)) {\n        return llmLike;\n    }\n    else if (\"bound\" in llmLike && _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_2__.Runnable.isRunnable(llmLike.bound)) {\n        return _getLanguageModel(llmLike.bound);\n    }\n    else if (\"runnable\" in llmLike &&\n        \"fallbacks\" in llmLike &&\n        _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_2__.Runnable.isRunnable(llmLike.runnable)) {\n        return _getLanguageModel(llmLike.runnable);\n    }\n    else if (\"default\" in llmLike && _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_2__.Runnable.isRunnable(llmLike.default)) {\n        return _getLanguageModel(llmLike.default);\n    }\n    else {\n        throw new Error(\"Unable to extract BaseLanguageModel from llmLike object.\");\n    }\n}\n/**\n * @deprecated This class will be removed in 0.3.0. Use the LangChain Expression Language (LCEL) instead.\n * See the example below for how to use LCEL with the LLMChain class:\n *\n * Chain to run queries against LLMs.\n *\n * @example\n * ```ts\n * import { ChatPromptTemplate } from \"@langchain/core/prompts\";\n * import { ChatOpenAI } from \"@langchain/openai\";\n *\n * const prompt = ChatPromptTemplate.fromTemplate(\"Tell me a {adjective} joke\");\n * const llm = new ChatOpenAI();\n * const chain = prompt.pipe(llm);\n *\n * const response = await chain.invoke({ adjective: \"funny\" });\n * ```\n */\nclass LLMChain extends _base_js__WEBPACK_IMPORTED_MODULE_3__.BaseChain {\n    static lc_name() {\n        return \"LLMChain\";\n    }\n    get inputKeys() {\n        return this.prompt.inputVariables;\n    }\n    get outputKeys() {\n        return [this.outputKey];\n    }\n    constructor(fields) {\n        super(fields);\n        Object.defineProperty(this, \"lc_serializable\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: true\n        });\n        Object.defineProperty(this, \"prompt\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"llm\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"llmKwargs\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"outputKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"text\"\n        });\n        Object.defineProperty(this, \"outputParser\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.prompt = fields.prompt;\n        this.llm = fields.llm;\n        this.llmKwargs = fields.llmKwargs;\n        this.outputKey = fields.outputKey ?? this.outputKey;\n        this.outputParser =\n            fields.outputParser ?? new _output_parsers_noop_js__WEBPACK_IMPORTED_MODULE_4__.NoOpOutputParser();\n        if (this.prompt.outputParser) {\n            if (fields.outputParser) {\n                throw new Error(\"Cannot set both outputParser and prompt.outputParser\");\n            }\n            this.outputParser = this.prompt.outputParser;\n        }\n    }\n    getCallKeys() {\n        const callKeys = \"callKeys\" in this.llm ? this.llm.callKeys : [];\n        return callKeys;\n    }\n    /** @ignore */\n    _selectMemoryInputs(values) {\n        const valuesForMemory = super._selectMemoryInputs(values);\n        const callKeys = this.getCallKeys();\n        for (const key of callKeys) {\n            if (key in values) {\n                delete valuesForMemory[key];\n            }\n        }\n        return valuesForMemory;\n    }\n    /** @ignore */\n    async _getFinalOutput(generations, promptValue, runManager) {\n        let finalCompletion;\n        if (this.outputParser) {\n            finalCompletion = await this.outputParser.parseResultWithPrompt(generations, promptValue, runManager?.getChild());\n        }\n        else {\n            finalCompletion = generations[0].text;\n        }\n        return finalCompletion;\n    }\n    /**\n     * Run the core logic of this chain and add to output if desired.\n     *\n     * Wraps _call and handles memory.\n     */\n    call(values, config) {\n        return super.call(values, config);\n    }\n    /** @ignore */\n    async _call(values, runManager) {\n        const valuesForPrompt = { ...values };\n        const valuesForLLM = {\n            ...this.llmKwargs,\n        };\n        const callKeys = this.getCallKeys();\n        for (const key of callKeys) {\n            if (key in values) {\n                if (valuesForLLM) {\n                    valuesForLLM[key] =\n                        values[key];\n                    delete valuesForPrompt[key];\n                }\n            }\n        }\n        const promptValue = await this.prompt.formatPromptValue(valuesForPrompt);\n        if (\"generatePrompt\" in this.llm) {\n            const { generations } = await this.llm.generatePrompt([promptValue], valuesForLLM, runManager?.getChild());\n            return {\n                [this.outputKey]: await this._getFinalOutput(generations[0], promptValue, runManager),\n            };\n        }\n        const modelWithParser = this.outputParser\n            ? this.llm.pipe(this.outputParser)\n            : this.llm;\n        const response = await modelWithParser.invoke(promptValue, runManager?.getChild());\n        return {\n            [this.outputKey]: response,\n        };\n    }\n    /**\n     * Format prompt with values and pass to LLM\n     *\n     * @param values - keys to pass to prompt template\n     * @param callbackManager - CallbackManager to use\n     * @returns Completion from LLM.\n     *\n     * @example\n     * ```ts\n     * llm.predict({ adjective: \"funny\" })\n     * ```\n     */\n    async predict(values, callbackManager) {\n        const output = await this.call(values, callbackManager);\n        return output[this.outputKey];\n    }\n    _chainType() {\n        return \"llm\";\n    }\n    static async deserialize(data) {\n        const { llm, prompt } = data;\n        if (!llm) {\n            throw new Error(\"LLMChain must have llm\");\n        }\n        if (!prompt) {\n            throw new Error(\"LLMChain must have prompt\");\n        }\n        return new LLMChain({\n            llm: await _langchain_core_language_models_base__WEBPACK_IMPORTED_MODULE_0__.BaseLanguageModel.deserialize(llm),\n            prompt: await _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_1__.BasePromptTemplate.deserialize(prompt),\n        });\n    }\n    /** @deprecated */\n    serialize() {\n        const serialize = \"serialize\" in this.llm ? this.llm.serialize() : undefined;\n        return {\n            _type: `${this._chainType()}_chain`,\n            llm: serialize,\n            prompt: this.prompt.serialize(),\n        };\n    }\n    _getNumTokens(text) {\n        return _getLanguageModel(this.llm).getNumTokens(text);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL2xsbV9jaGFpbi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBMEU7QUFDYjtBQUNSO0FBQ2Y7QUFDdUI7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsK0RBQVE7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLCtEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxxQ0FBcUMsK0RBQVE7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkscUJBQXFCO0FBQ2pDLFlBQVksYUFBYTtBQUN6QjtBQUNBLDhEQUE4RCxXQUFXO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxvQkFBb0I7QUFDN0Q7QUFDQTtBQUNPLHVCQUF1QiwrQ0FBUztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QyxxRUFBZ0I7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGNBQWM7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLG9CQUFvQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixjQUFjO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLG1GQUFpQjtBQUN4QywwQkFBMEIsdUVBQWtCO0FBQzVDLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGtCQUFrQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWktY29tcGFuaW9uLy4vbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2NoYWlucy9sbG1fY2hhaW4uanM/ODRlYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCYXNlTGFuZ3VhZ2VNb2RlbCwgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL2xhbmd1YWdlX21vZGVscy9iYXNlXCI7XG5pbXBvcnQgeyBCYXNlUHJvbXB0VGVtcGxhdGUgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL3Byb21wdHNcIjtcbmltcG9ydCB7IFJ1bm5hYmxlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS9ydW5uYWJsZXNcIjtcbmltcG9ydCB7IEJhc2VDaGFpbiB9IGZyb20gXCIuL2Jhc2UuanNcIjtcbmltcG9ydCB7IE5vT3BPdXRwdXRQYXJzZXIgfSBmcm9tIFwiLi4vb3V0cHV0X3BhcnNlcnMvbm9vcC5qc1wiO1xuZnVuY3Rpb24gaXNCYXNlTGFuZ3VhZ2VNb2RlbChsbG1MaWtlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBsbG1MaWtlLl9sbG1UeXBlID09PSBcImZ1bmN0aW9uXCI7XG59XG5mdW5jdGlvbiBfZ2V0TGFuZ3VhZ2VNb2RlbChsbG1MaWtlKSB7XG4gICAgaWYgKGlzQmFzZUxhbmd1YWdlTW9kZWwobGxtTGlrZSkpIHtcbiAgICAgICAgcmV0dXJuIGxsbUxpa2U7XG4gICAgfVxuICAgIGVsc2UgaWYgKFwiYm91bmRcIiBpbiBsbG1MaWtlICYmIFJ1bm5hYmxlLmlzUnVubmFibGUobGxtTGlrZS5ib3VuZCkpIHtcbiAgICAgICAgcmV0dXJuIF9nZXRMYW5ndWFnZU1vZGVsKGxsbUxpa2UuYm91bmQpO1xuICAgIH1cbiAgICBlbHNlIGlmIChcInJ1bm5hYmxlXCIgaW4gbGxtTGlrZSAmJlxuICAgICAgICBcImZhbGxiYWNrc1wiIGluIGxsbUxpa2UgJiZcbiAgICAgICAgUnVubmFibGUuaXNSdW5uYWJsZShsbG1MaWtlLnJ1bm5hYmxlKSkge1xuICAgICAgICByZXR1cm4gX2dldExhbmd1YWdlTW9kZWwobGxtTGlrZS5ydW5uYWJsZSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKFwiZGVmYXVsdFwiIGluIGxsbUxpa2UgJiYgUnVubmFibGUuaXNSdW5uYWJsZShsbG1MaWtlLmRlZmF1bHQpKSB7XG4gICAgICAgIHJldHVybiBfZ2V0TGFuZ3VhZ2VNb2RlbChsbG1MaWtlLmRlZmF1bHQpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIGV4dHJhY3QgQmFzZUxhbmd1YWdlTW9kZWwgZnJvbSBsbG1MaWtlIG9iamVjdC5cIik7XG4gICAgfVxufVxuLyoqXG4gKiBAZGVwcmVjYXRlZCBUaGlzIGNsYXNzIHdpbGwgYmUgcmVtb3ZlZCBpbiAwLjMuMC4gVXNlIHRoZSBMYW5nQ2hhaW4gRXhwcmVzc2lvbiBMYW5ndWFnZSAoTENFTCkgaW5zdGVhZC5cbiAqIFNlZSB0aGUgZXhhbXBsZSBiZWxvdyBmb3IgaG93IHRvIHVzZSBMQ0VMIHdpdGggdGhlIExMTUNoYWluIGNsYXNzOlxuICpcbiAqIENoYWluIHRvIHJ1biBxdWVyaWVzIGFnYWluc3QgTExNcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIGltcG9ydCB7IENoYXRQcm9tcHRUZW1wbGF0ZSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvcHJvbXB0c1wiO1xuICogaW1wb3J0IHsgQ2hhdE9wZW5BSSB9IGZyb20gXCJAbGFuZ2NoYWluL29wZW5haVwiO1xuICpcbiAqIGNvbnN0IHByb21wdCA9IENoYXRQcm9tcHRUZW1wbGF0ZS5mcm9tVGVtcGxhdGUoXCJUZWxsIG1lIGEge2FkamVjdGl2ZX0gam9rZVwiKTtcbiAqIGNvbnN0IGxsbSA9IG5ldyBDaGF0T3BlbkFJKCk7XG4gKiBjb25zdCBjaGFpbiA9IHByb21wdC5waXBlKGxsbSk7XG4gKlxuICogY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjaGFpbi5pbnZva2UoeyBhZGplY3RpdmU6IFwiZnVubnlcIiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgTExNQ2hhaW4gZXh0ZW5kcyBCYXNlQ2hhaW4ge1xuICAgIHN0YXRpYyBsY19uYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJMTE1DaGFpblwiO1xuICAgIH1cbiAgICBnZXQgaW5wdXRLZXlzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9tcHQuaW5wdXRWYXJpYWJsZXM7XG4gICAgfVxuICAgIGdldCBvdXRwdXRLZXlzKCkge1xuICAgICAgICByZXR1cm4gW3RoaXMub3V0cHV0S2V5XTtcbiAgICB9XG4gICAgY29uc3RydWN0b3IoZmllbGRzKSB7XG4gICAgICAgIHN1cGVyKGZpZWxkcyk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImxjX3NlcmlhbGl6YWJsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwicHJvbXB0XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImxsbVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJsbG1Ld2FyZ3NcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwib3V0cHV0S2V5XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBcInRleHRcIlxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwib3V0cHV0UGFyc2VyXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucHJvbXB0ID0gZmllbGRzLnByb21wdDtcbiAgICAgICAgdGhpcy5sbG0gPSBmaWVsZHMubGxtO1xuICAgICAgICB0aGlzLmxsbUt3YXJncyA9IGZpZWxkcy5sbG1Ld2FyZ3M7XG4gICAgICAgIHRoaXMub3V0cHV0S2V5ID0gZmllbGRzLm91dHB1dEtleSA/PyB0aGlzLm91dHB1dEtleTtcbiAgICAgICAgdGhpcy5vdXRwdXRQYXJzZXIgPVxuICAgICAgICAgICAgZmllbGRzLm91dHB1dFBhcnNlciA/PyBuZXcgTm9PcE91dHB1dFBhcnNlcigpO1xuICAgICAgICBpZiAodGhpcy5wcm9tcHQub3V0cHV0UGFyc2VyKSB7XG4gICAgICAgICAgICBpZiAoZmllbGRzLm91dHB1dFBhcnNlcikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBzZXQgYm90aCBvdXRwdXRQYXJzZXIgYW5kIHByb21wdC5vdXRwdXRQYXJzZXJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm91dHB1dFBhcnNlciA9IHRoaXMucHJvbXB0Lm91dHB1dFBhcnNlcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRDYWxsS2V5cygpIHtcbiAgICAgICAgY29uc3QgY2FsbEtleXMgPSBcImNhbGxLZXlzXCIgaW4gdGhpcy5sbG0gPyB0aGlzLmxsbS5jYWxsS2V5cyA6IFtdO1xuICAgICAgICByZXR1cm4gY2FsbEtleXM7XG4gICAgfVxuICAgIC8qKiBAaWdub3JlICovXG4gICAgX3NlbGVjdE1lbW9yeUlucHV0cyh2YWx1ZXMpIHtcbiAgICAgICAgY29uc3QgdmFsdWVzRm9yTWVtb3J5ID0gc3VwZXIuX3NlbGVjdE1lbW9yeUlucHV0cyh2YWx1ZXMpO1xuICAgICAgICBjb25zdCBjYWxsS2V5cyA9IHRoaXMuZ2V0Q2FsbEtleXMoKTtcbiAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgY2FsbEtleXMpIHtcbiAgICAgICAgICAgIGlmIChrZXkgaW4gdmFsdWVzKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHZhbHVlc0Zvck1lbW9yeVtrZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZXNGb3JNZW1vcnk7XG4gICAgfVxuICAgIC8qKiBAaWdub3JlICovXG4gICAgYXN5bmMgX2dldEZpbmFsT3V0cHV0KGdlbmVyYXRpb25zLCBwcm9tcHRWYWx1ZSwgcnVuTWFuYWdlcikge1xuICAgICAgICBsZXQgZmluYWxDb21wbGV0aW9uO1xuICAgICAgICBpZiAodGhpcy5vdXRwdXRQYXJzZXIpIHtcbiAgICAgICAgICAgIGZpbmFsQ29tcGxldGlvbiA9IGF3YWl0IHRoaXMub3V0cHV0UGFyc2VyLnBhcnNlUmVzdWx0V2l0aFByb21wdChnZW5lcmF0aW9ucywgcHJvbXB0VmFsdWUsIHJ1bk1hbmFnZXI/LmdldENoaWxkKCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZmluYWxDb21wbGV0aW9uID0gZ2VuZXJhdGlvbnNbMF0udGV4dDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmluYWxDb21wbGV0aW9uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSdW4gdGhlIGNvcmUgbG9naWMgb2YgdGhpcyBjaGFpbiBhbmQgYWRkIHRvIG91dHB1dCBpZiBkZXNpcmVkLlxuICAgICAqXG4gICAgICogV3JhcHMgX2NhbGwgYW5kIGhhbmRsZXMgbWVtb3J5LlxuICAgICAqL1xuICAgIGNhbGwodmFsdWVzLCBjb25maWcpIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmNhbGwodmFsdWVzLCBjb25maWcpO1xuICAgIH1cbiAgICAvKiogQGlnbm9yZSAqL1xuICAgIGFzeW5jIF9jYWxsKHZhbHVlcywgcnVuTWFuYWdlcikge1xuICAgICAgICBjb25zdCB2YWx1ZXNGb3JQcm9tcHQgPSB7IC4uLnZhbHVlcyB9O1xuICAgICAgICBjb25zdCB2YWx1ZXNGb3JMTE0gPSB7XG4gICAgICAgICAgICAuLi50aGlzLmxsbUt3YXJncyxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgY2FsbEtleXMgPSB0aGlzLmdldENhbGxLZXlzKCk7XG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGNhbGxLZXlzKSB7XG4gICAgICAgICAgICBpZiAoa2V5IGluIHZhbHVlcykge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNGb3JMTE0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzRm9yTExNW2tleV0gPVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzW2tleV07XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB2YWx1ZXNGb3JQcm9tcHRba2V5XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcHJvbXB0VmFsdWUgPSBhd2FpdCB0aGlzLnByb21wdC5mb3JtYXRQcm9tcHRWYWx1ZSh2YWx1ZXNGb3JQcm9tcHQpO1xuICAgICAgICBpZiAoXCJnZW5lcmF0ZVByb21wdFwiIGluIHRoaXMubGxtKSB7XG4gICAgICAgICAgICBjb25zdCB7IGdlbmVyYXRpb25zIH0gPSBhd2FpdCB0aGlzLmxsbS5nZW5lcmF0ZVByb21wdChbcHJvbXB0VmFsdWVdLCB2YWx1ZXNGb3JMTE0sIHJ1bk1hbmFnZXI/LmdldENoaWxkKCkpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBbdGhpcy5vdXRwdXRLZXldOiBhd2FpdCB0aGlzLl9nZXRGaW5hbE91dHB1dChnZW5lcmF0aW9uc1swXSwgcHJvbXB0VmFsdWUsIHJ1bk1hbmFnZXIpLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBtb2RlbFdpdGhQYXJzZXIgPSB0aGlzLm91dHB1dFBhcnNlclxuICAgICAgICAgICAgPyB0aGlzLmxsbS5waXBlKHRoaXMub3V0cHV0UGFyc2VyKVxuICAgICAgICAgICAgOiB0aGlzLmxsbTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBtb2RlbFdpdGhQYXJzZXIuaW52b2tlKHByb21wdFZhbHVlLCBydW5NYW5hZ2VyPy5nZXRDaGlsZCgpKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFt0aGlzLm91dHB1dEtleV06IHJlc3BvbnNlLFxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb3JtYXQgcHJvbXB0IHdpdGggdmFsdWVzIGFuZCBwYXNzIHRvIExMTVxuICAgICAqXG4gICAgICogQHBhcmFtIHZhbHVlcyAtIGtleXMgdG8gcGFzcyB0byBwcm9tcHQgdGVtcGxhdGVcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2tNYW5hZ2VyIC0gQ2FsbGJhY2tNYW5hZ2VyIHRvIHVzZVxuICAgICAqIEByZXR1cm5zIENvbXBsZXRpb24gZnJvbSBMTE0uXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGBgYHRzXG4gICAgICogbGxtLnByZWRpY3QoeyBhZGplY3RpdmU6IFwiZnVubnlcIiB9KVxuICAgICAqIGBgYFxuICAgICAqL1xuICAgIGFzeW5jIHByZWRpY3QodmFsdWVzLCBjYWxsYmFja01hbmFnZXIpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0ID0gYXdhaXQgdGhpcy5jYWxsKHZhbHVlcywgY2FsbGJhY2tNYW5hZ2VyKTtcbiAgICAgICAgcmV0dXJuIG91dHB1dFt0aGlzLm91dHB1dEtleV07XG4gICAgfVxuICAgIF9jaGFpblR5cGUoKSB7XG4gICAgICAgIHJldHVybiBcImxsbVwiO1xuICAgIH1cbiAgICBzdGF0aWMgYXN5bmMgZGVzZXJpYWxpemUoZGF0YSkge1xuICAgICAgICBjb25zdCB7IGxsbSwgcHJvbXB0IH0gPSBkYXRhO1xuICAgICAgICBpZiAoIWxsbSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTExNQ2hhaW4gbXVzdCBoYXZlIGxsbVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXByb21wdCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTExNQ2hhaW4gbXVzdCBoYXZlIHByb21wdFwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IExMTUNoYWluKHtcbiAgICAgICAgICAgIGxsbTogYXdhaXQgQmFzZUxhbmd1YWdlTW9kZWwuZGVzZXJpYWxpemUobGxtKSxcbiAgICAgICAgICAgIHByb21wdDogYXdhaXQgQmFzZVByb21wdFRlbXBsYXRlLmRlc2VyaWFsaXplKHByb21wdCksXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKiogQGRlcHJlY2F0ZWQgKi9cbiAgICBzZXJpYWxpemUoKSB7XG4gICAgICAgIGNvbnN0IHNlcmlhbGl6ZSA9IFwic2VyaWFsaXplXCIgaW4gdGhpcy5sbG0gPyB0aGlzLmxsbS5zZXJpYWxpemUoKSA6IHVuZGVmaW5lZDtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIF90eXBlOiBgJHt0aGlzLl9jaGFpblR5cGUoKX1fY2hhaW5gLFxuICAgICAgICAgICAgbGxtOiBzZXJpYWxpemUsXG4gICAgICAgICAgICBwcm9tcHQ6IHRoaXMucHJvbXB0LnNlcmlhbGl6ZSgpLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBfZ2V0TnVtVG9rZW5zKHRleHQpIHtcbiAgICAgICAgcmV0dXJuIF9nZXRMYW5ndWFnZU1vZGVsKHRoaXMubGxtKS5nZXROdW1Ub2tlbnModGV4dCk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/chains/llm_chain.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/chains/question_answering/load.js":
/*!***********************************************************************!*\
  !*** ./node_modules/langchain/dist/chains/question_answering/load.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   loadQAChain: () => (/* binding */ loadQAChain),\n/* harmony export */   loadQAMapReduceChain: () => (/* binding */ loadQAMapReduceChain),\n/* harmony export */   loadQARefineChain: () => (/* binding */ loadQARefineChain),\n/* harmony export */   loadQAStuffChain: () => (/* binding */ loadQAStuffChain)\n/* harmony export */ });\n/* harmony import */ var _llm_chain_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../llm_chain.js */ \"(rsc)/./node_modules/langchain/dist/chains/llm_chain.js\");\n/* harmony import */ var _combine_docs_chain_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../combine_docs_chain.js */ \"(rsc)/./node_modules/langchain/dist/chains/combine_docs_chain.js\");\n/* harmony import */ var _stuff_prompts_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./stuff_prompts.js */ \"(rsc)/./node_modules/langchain/dist/chains/question_answering/stuff_prompts.js\");\n/* harmony import */ var _map_reduce_prompts_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./map_reduce_prompts.js */ \"(rsc)/./node_modules/langchain/dist/chains/question_answering/map_reduce_prompts.js\");\n/* harmony import */ var _refine_prompts_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./refine_prompts.js */ \"(rsc)/./node_modules/langchain/dist/chains/question_answering/refine_prompts.js\");\n\n\n\n\n\nconst loadQAChain = (llm, params = { type: \"stuff\" }) => {\n    const { type } = params;\n    if (type === \"stuff\") {\n        return loadQAStuffChain(llm, params);\n    }\n    if (type === \"map_reduce\") {\n        return loadQAMapReduceChain(llm, params);\n    }\n    if (type === \"refine\") {\n        return loadQARefineChain(llm, params);\n    }\n    throw new Error(`Invalid _type: ${type}`);\n};\n/**\n * Loads a StuffQAChain based on the provided parameters. It takes an LLM\n * instance and StuffQAChainParams as parameters.\n * @param llm An instance of BaseLanguageModel.\n * @param params Parameters for creating a StuffQAChain.\n * @returns A StuffQAChain instance.\n */\nfunction loadQAStuffChain(llm, params = {}) {\n    const { prompt = _stuff_prompts_js__WEBPACK_IMPORTED_MODULE_2__.QA_PROMPT_SELECTOR.getPrompt(llm), verbose } = params;\n    const llmChain = new _llm_chain_js__WEBPACK_IMPORTED_MODULE_0__.LLMChain({ prompt, llm, verbose });\n    const chain = new _combine_docs_chain_js__WEBPACK_IMPORTED_MODULE_1__.StuffDocumentsChain({ llmChain, verbose });\n    return chain;\n}\n/**\n * Loads a MapReduceQAChain based on the provided parameters. It takes an\n * LLM instance and MapReduceQAChainParams as parameters.\n * @param llm An instance of BaseLanguageModel.\n * @param params Parameters for creating a MapReduceQAChain.\n * @returns A MapReduceQAChain instance.\n */\nfunction loadQAMapReduceChain(llm, params = {}) {\n    const { combineMapPrompt = _map_reduce_prompts_js__WEBPACK_IMPORTED_MODULE_3__.COMBINE_QA_PROMPT_SELECTOR.getPrompt(llm), combinePrompt = _map_reduce_prompts_js__WEBPACK_IMPORTED_MODULE_3__.COMBINE_PROMPT_SELECTOR.getPrompt(llm), verbose, combineLLM, returnIntermediateSteps, } = params;\n    const llmChain = new _llm_chain_js__WEBPACK_IMPORTED_MODULE_0__.LLMChain({ prompt: combineMapPrompt, llm, verbose });\n    const combineLLMChain = new _llm_chain_js__WEBPACK_IMPORTED_MODULE_0__.LLMChain({\n        prompt: combinePrompt,\n        llm: combineLLM ?? llm,\n        verbose,\n    });\n    const combineDocumentChain = new _combine_docs_chain_js__WEBPACK_IMPORTED_MODULE_1__.StuffDocumentsChain({\n        llmChain: combineLLMChain,\n        documentVariableName: \"summaries\",\n        verbose,\n    });\n    const chain = new _combine_docs_chain_js__WEBPACK_IMPORTED_MODULE_1__.MapReduceDocumentsChain({\n        llmChain,\n        combineDocumentChain,\n        returnIntermediateSteps,\n        verbose,\n    });\n    return chain;\n}\n/**\n * Loads a RefineQAChain based on the provided parameters. It takes an LLM\n * instance and RefineQAChainParams as parameters.\n * @param llm An instance of BaseLanguageModel.\n * @param params Parameters for creating a RefineQAChain.\n * @returns A RefineQAChain instance.\n */\nfunction loadQARefineChain(llm, params = {}) {\n    const { questionPrompt = _refine_prompts_js__WEBPACK_IMPORTED_MODULE_4__.QUESTION_PROMPT_SELECTOR.getPrompt(llm), refinePrompt = _refine_prompts_js__WEBPACK_IMPORTED_MODULE_4__.REFINE_PROMPT_SELECTOR.getPrompt(llm), refineLLM, verbose, } = params;\n    const llmChain = new _llm_chain_js__WEBPACK_IMPORTED_MODULE_0__.LLMChain({ prompt: questionPrompt, llm, verbose });\n    const refineLLMChain = new _llm_chain_js__WEBPACK_IMPORTED_MODULE_0__.LLMChain({\n        prompt: refinePrompt,\n        llm: refineLLM ?? llm,\n        verbose,\n    });\n    const chain = new _combine_docs_chain_js__WEBPACK_IMPORTED_MODULE_1__.RefineDocumentsChain({\n        llmChain,\n        refineLLMChain,\n        verbose,\n    });\n    return chain;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL3F1ZXN0aW9uX2Fuc3dlcmluZy9sb2FkLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUEyQztBQUNvRTtBQUN2RDtBQUN1QztBQUNQO0FBQ2pGLHFDQUFxQyxlQUFlO0FBQzNELFlBQVksT0FBTztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsS0FBSztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sMENBQTBDO0FBQ2pELFlBQVksU0FBUyxpRUFBa0IsMkJBQTJCO0FBQ2xFLHlCQUF5QixtREFBUSxHQUFHLHNCQUFzQjtBQUMxRCxzQkFBc0IsdUVBQW1CLEdBQUcsbUJBQW1CO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLDhDQUE4QztBQUNyRCxZQUFZLG1CQUFtQiw4RUFBMEIsaUNBQWlDLDJFQUF1QixpRUFBaUU7QUFDbEwseUJBQXlCLG1EQUFRLEdBQUcsd0NBQXdDO0FBQzVFLGdDQUFnQyxtREFBUTtBQUN4QztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wscUNBQXFDLHVFQUFtQjtBQUN4RDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsc0JBQXNCLDJFQUF1QjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTywyQ0FBMkM7QUFDbEQsWUFBWSxpQkFBaUIsd0VBQXdCLGdDQUFnQyxzRUFBc0IsdUNBQXVDO0FBQ2xKLHlCQUF5QixtREFBUSxHQUFHLHNDQUFzQztBQUMxRSwrQkFBK0IsbURBQVE7QUFDdkM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLHNCQUFzQix3RUFBb0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1jb21wYW5pb24vLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL3F1ZXN0aW9uX2Fuc3dlcmluZy9sb2FkLmpzPzE2NTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTExNQ2hhaW4gfSBmcm9tIFwiLi4vbGxtX2NoYWluLmpzXCI7XG5pbXBvcnQgeyBTdHVmZkRvY3VtZW50c0NoYWluLCBNYXBSZWR1Y2VEb2N1bWVudHNDaGFpbiwgUmVmaW5lRG9jdW1lbnRzQ2hhaW4sIH0gZnJvbSBcIi4uL2NvbWJpbmVfZG9jc19jaGFpbi5qc1wiO1xuaW1wb3J0IHsgUUFfUFJPTVBUX1NFTEVDVE9SIH0gZnJvbSBcIi4vc3R1ZmZfcHJvbXB0cy5qc1wiO1xuaW1wb3J0IHsgQ09NQklORV9QUk9NUFRfU0VMRUNUT1IsIENPTUJJTkVfUUFfUFJPTVBUX1NFTEVDVE9SLCB9IGZyb20gXCIuL21hcF9yZWR1Y2VfcHJvbXB0cy5qc1wiO1xuaW1wb3J0IHsgUVVFU1RJT05fUFJPTVBUX1NFTEVDVE9SLCBSRUZJTkVfUFJPTVBUX1NFTEVDVE9SLCB9IGZyb20gXCIuL3JlZmluZV9wcm9tcHRzLmpzXCI7XG5leHBvcnQgY29uc3QgbG9hZFFBQ2hhaW4gPSAobGxtLCBwYXJhbXMgPSB7IHR5cGU6IFwic3R1ZmZcIiB9KSA9PiB7XG4gICAgY29uc3QgeyB0eXBlIH0gPSBwYXJhbXM7XG4gICAgaWYgKHR5cGUgPT09IFwic3R1ZmZcIikge1xuICAgICAgICByZXR1cm4gbG9hZFFBU3R1ZmZDaGFpbihsbG0sIHBhcmFtcyk7XG4gICAgfVxuICAgIGlmICh0eXBlID09PSBcIm1hcF9yZWR1Y2VcIikge1xuICAgICAgICByZXR1cm4gbG9hZFFBTWFwUmVkdWNlQ2hhaW4obGxtLCBwYXJhbXMpO1xuICAgIH1cbiAgICBpZiAodHlwZSA9PT0gXCJyZWZpbmVcIikge1xuICAgICAgICByZXR1cm4gbG9hZFFBUmVmaW5lQ2hhaW4obGxtLCBwYXJhbXMpO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgX3R5cGU6ICR7dHlwZX1gKTtcbn07XG4vKipcbiAqIExvYWRzIGEgU3R1ZmZRQUNoYWluIGJhc2VkIG9uIHRoZSBwcm92aWRlZCBwYXJhbWV0ZXJzLiBJdCB0YWtlcyBhbiBMTE1cbiAqIGluc3RhbmNlIGFuZCBTdHVmZlFBQ2hhaW5QYXJhbXMgYXMgcGFyYW1ldGVycy5cbiAqIEBwYXJhbSBsbG0gQW4gaW5zdGFuY2Ugb2YgQmFzZUxhbmd1YWdlTW9kZWwuXG4gKiBAcGFyYW0gcGFyYW1zIFBhcmFtZXRlcnMgZm9yIGNyZWF0aW5nIGEgU3R1ZmZRQUNoYWluLlxuICogQHJldHVybnMgQSBTdHVmZlFBQ2hhaW4gaW5zdGFuY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsb2FkUUFTdHVmZkNoYWluKGxsbSwgcGFyYW1zID0ge30pIHtcbiAgICBjb25zdCB7IHByb21wdCA9IFFBX1BST01QVF9TRUxFQ1RPUi5nZXRQcm9tcHQobGxtKSwgdmVyYm9zZSB9ID0gcGFyYW1zO1xuICAgIGNvbnN0IGxsbUNoYWluID0gbmV3IExMTUNoYWluKHsgcHJvbXB0LCBsbG0sIHZlcmJvc2UgfSk7XG4gICAgY29uc3QgY2hhaW4gPSBuZXcgU3R1ZmZEb2N1bWVudHNDaGFpbih7IGxsbUNoYWluLCB2ZXJib3NlIH0pO1xuICAgIHJldHVybiBjaGFpbjtcbn1cbi8qKlxuICogTG9hZHMgYSBNYXBSZWR1Y2VRQUNoYWluIGJhc2VkIG9uIHRoZSBwcm92aWRlZCBwYXJhbWV0ZXJzLiBJdCB0YWtlcyBhblxuICogTExNIGluc3RhbmNlIGFuZCBNYXBSZWR1Y2VRQUNoYWluUGFyYW1zIGFzIHBhcmFtZXRlcnMuXG4gKiBAcGFyYW0gbGxtIEFuIGluc3RhbmNlIG9mIEJhc2VMYW5ndWFnZU1vZGVsLlxuICogQHBhcmFtIHBhcmFtcyBQYXJhbWV0ZXJzIGZvciBjcmVhdGluZyBhIE1hcFJlZHVjZVFBQ2hhaW4uXG4gKiBAcmV0dXJucyBBIE1hcFJlZHVjZVFBQ2hhaW4gaW5zdGFuY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsb2FkUUFNYXBSZWR1Y2VDaGFpbihsbG0sIHBhcmFtcyA9IHt9KSB7XG4gICAgY29uc3QgeyBjb21iaW5lTWFwUHJvbXB0ID0gQ09NQklORV9RQV9QUk9NUFRfU0VMRUNUT1IuZ2V0UHJvbXB0KGxsbSksIGNvbWJpbmVQcm9tcHQgPSBDT01CSU5FX1BST01QVF9TRUxFQ1RPUi5nZXRQcm9tcHQobGxtKSwgdmVyYm9zZSwgY29tYmluZUxMTSwgcmV0dXJuSW50ZXJtZWRpYXRlU3RlcHMsIH0gPSBwYXJhbXM7XG4gICAgY29uc3QgbGxtQ2hhaW4gPSBuZXcgTExNQ2hhaW4oeyBwcm9tcHQ6IGNvbWJpbmVNYXBQcm9tcHQsIGxsbSwgdmVyYm9zZSB9KTtcbiAgICBjb25zdCBjb21iaW5lTExNQ2hhaW4gPSBuZXcgTExNQ2hhaW4oe1xuICAgICAgICBwcm9tcHQ6IGNvbWJpbmVQcm9tcHQsXG4gICAgICAgIGxsbTogY29tYmluZUxMTSA/PyBsbG0sXG4gICAgICAgIHZlcmJvc2UsXG4gICAgfSk7XG4gICAgY29uc3QgY29tYmluZURvY3VtZW50Q2hhaW4gPSBuZXcgU3R1ZmZEb2N1bWVudHNDaGFpbih7XG4gICAgICAgIGxsbUNoYWluOiBjb21iaW5lTExNQ2hhaW4sXG4gICAgICAgIGRvY3VtZW50VmFyaWFibGVOYW1lOiBcInN1bW1hcmllc1wiLFxuICAgICAgICB2ZXJib3NlLFxuICAgIH0pO1xuICAgIGNvbnN0IGNoYWluID0gbmV3IE1hcFJlZHVjZURvY3VtZW50c0NoYWluKHtcbiAgICAgICAgbGxtQ2hhaW4sXG4gICAgICAgIGNvbWJpbmVEb2N1bWVudENoYWluLFxuICAgICAgICByZXR1cm5JbnRlcm1lZGlhdGVTdGVwcyxcbiAgICAgICAgdmVyYm9zZSxcbiAgICB9KTtcbiAgICByZXR1cm4gY2hhaW47XG59XG4vKipcbiAqIExvYWRzIGEgUmVmaW5lUUFDaGFpbiBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgcGFyYW1ldGVycy4gSXQgdGFrZXMgYW4gTExNXG4gKiBpbnN0YW5jZSBhbmQgUmVmaW5lUUFDaGFpblBhcmFtcyBhcyBwYXJhbWV0ZXJzLlxuICogQHBhcmFtIGxsbSBBbiBpbnN0YW5jZSBvZiBCYXNlTGFuZ3VhZ2VNb2RlbC5cbiAqIEBwYXJhbSBwYXJhbXMgUGFyYW1ldGVycyBmb3IgY3JlYXRpbmcgYSBSZWZpbmVRQUNoYWluLlxuICogQHJldHVybnMgQSBSZWZpbmVRQUNoYWluIGluc3RhbmNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9hZFFBUmVmaW5lQ2hhaW4obGxtLCBwYXJhbXMgPSB7fSkge1xuICAgIGNvbnN0IHsgcXVlc3Rpb25Qcm9tcHQgPSBRVUVTVElPTl9QUk9NUFRfU0VMRUNUT1IuZ2V0UHJvbXB0KGxsbSksIHJlZmluZVByb21wdCA9IFJFRklORV9QUk9NUFRfU0VMRUNUT1IuZ2V0UHJvbXB0KGxsbSksIHJlZmluZUxMTSwgdmVyYm9zZSwgfSA9IHBhcmFtcztcbiAgICBjb25zdCBsbG1DaGFpbiA9IG5ldyBMTE1DaGFpbih7IHByb21wdDogcXVlc3Rpb25Qcm9tcHQsIGxsbSwgdmVyYm9zZSB9KTtcbiAgICBjb25zdCByZWZpbmVMTE1DaGFpbiA9IG5ldyBMTE1DaGFpbih7XG4gICAgICAgIHByb21wdDogcmVmaW5lUHJvbXB0LFxuICAgICAgICBsbG06IHJlZmluZUxMTSA/PyBsbG0sXG4gICAgICAgIHZlcmJvc2UsXG4gICAgfSk7XG4gICAgY29uc3QgY2hhaW4gPSBuZXcgUmVmaW5lRG9jdW1lbnRzQ2hhaW4oe1xuICAgICAgICBsbG1DaGFpbixcbiAgICAgICAgcmVmaW5lTExNQ2hhaW4sXG4gICAgICAgIHZlcmJvc2UsXG4gICAgfSk7XG4gICAgcmV0dXJuIGNoYWluO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/chains/question_answering/load.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/chains/question_answering/map_reduce_prompts.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/langchain/dist/chains/question_answering/map_reduce_prompts.js ***!
  \*************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   COMBINE_PROMPT: () => (/* binding */ COMBINE_PROMPT),\n/* harmony export */   COMBINE_PROMPT_SELECTOR: () => (/* binding */ COMBINE_PROMPT_SELECTOR),\n/* harmony export */   COMBINE_QA_PROMPT_SELECTOR: () => (/* binding */ COMBINE_QA_PROMPT_SELECTOR),\n/* harmony export */   DEFAULT_COMBINE_QA_PROMPT: () => (/* binding */ DEFAULT_COMBINE_QA_PROMPT)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/prompts */ \"(rsc)/./node_modules/@langchain/core/prompts.js\");\n/* harmony import */ var _langchain_core_example_selectors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/example_selectors */ \"(rsc)/./node_modules/@langchain/core/example_selectors.js\");\n/* eslint-disable spaced-comment */\n\n\nconst qa_template = `Use the following portion of a long document to see if any of the text is relevant to answer the question. \nReturn any relevant text verbatim.\n{context}\nQuestion: {question}\nRelevant text, if any:`;\nconst DEFAULT_COMBINE_QA_PROMPT = \n/*#__PURE__*/\n_langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate.fromTemplate(qa_template);\nconst system_template = `Use the following portion of a long document to see if any of the text is relevant to answer the question. \nReturn any relevant text verbatim.\n----------------\n{context}`;\nconst messages = [\n    /*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.SystemMessagePromptTemplate.fromTemplate(system_template),\n    /*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.HumanMessagePromptTemplate.fromTemplate(\"{question}\"),\n];\nconst CHAT_QA_PROMPT = /*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.ChatPromptTemplate.fromMessages(messages);\nconst COMBINE_QA_PROMPT_SELECTOR = \n/*#__PURE__*/ new _langchain_core_example_selectors__WEBPACK_IMPORTED_MODULE_1__.ConditionalPromptSelector(DEFAULT_COMBINE_QA_PROMPT, [\n    [_langchain_core_example_selectors__WEBPACK_IMPORTED_MODULE_1__.isChatModel, CHAT_QA_PROMPT],\n]);\nconst combine_prompt = `Given the following extracted parts of a long document and a question, create a final answer. \nIf you don't know the answer, just say that you don't know. Don't try to make up an answer.\n\nQUESTION: Which state/country's law governs the interpretation of the contract?\n=========\nContent: This Agreement is governed by English law and the parties submit to the exclusive jurisdiction of the English courts in  relation to any dispute (contractual or non-contractual) concerning this Agreement save that either party may apply to any court for an  injunction or other relief to protect its Intellectual Property Rights.\n\nContent: No Waiver. Failure or delay in exercising any right or remedy under this Agreement shall not constitute a waiver of such (or any other)  right or remedy.\\n\\n11.7 Severability. The invalidity, illegality or unenforceability of any term (or part of a term) of this Agreement shall not affect the continuation  in force of the remainder of the term (if any) and this Agreement.\\n\\n11.8 No Agency. Except as expressly stated otherwise, nothing in this Agreement shall create an agency, partnership or joint venture of any  kind between the parties.\\n\\n11.9 No Third-Party Beneficiaries.\n\nContent: (b) if Google believes, in good faith, that the Distributor has violated or caused Google to violate any Anti-Bribery Laws (as  defined in Clause 8.5) or that such a violation is reasonably likely to occur,\n=========\nFINAL ANSWER: This Agreement is governed by English law.\n\nQUESTION: What did the president say about Michael Jackson?\n=========\nContent: Madam Speaker, Madam Vice President, our First Lady and Second Gentleman. Members of Congress and the Cabinet. Justices of the Supreme Court. My fellow Americans.  \\n\\nLast year COVID-19 kept us apart. This year we are finally together again. \\n\\nTonight, we meet as Democrats Republicans and Independents. But most importantly as Americans. \\n\\nWith a duty to one another to the American people to the Constitution. \\n\\nAnd with an unwavering resolve that freedom will always triumph over tyranny. \\n\\nSix days ago, Russias Vladimir Putin sought to shake the foundations of the free world thinking he could make it bend to his menacing ways. But he badly miscalculated. \\n\\nHe thought he could roll into Ukraine and the world would roll over. Instead he met a wall of strength he never imagined. \\n\\nHe met the Ukrainian people. \\n\\nFrom President Zelenskyy to every Ukrainian, their fearlessness, their courage, their determination, inspires the world. \\n\\nGroups of citizens blocking tanks with their bodies. Everyone from students to retirees teachers turned soldiers defending their homeland.\n\nContent: And we wont stop. \\n\\nWe have lost so much to COVID-19. Time with one another. And worst of all, so much loss of life. \\n\\nLets use this moment to reset. Lets stop looking at COVID-19 as a partisan dividing line and see it for what it is: A God-awful disease.  \\n\\nLets stop seeing each other as enemies, and start seeing each other for who we really are: Fellow Americans.  \\n\\nWe cant change how divided weve been. But we can change how we move forwardon COVID-19 and other issues we must face together. \\n\\nI recently visited the New York City Police Department days after the funerals of Officer Wilbert Mora and his partner, Officer Jason Rivera. \\n\\nThey were responding to a 9-1-1 call when a man shot and killed them with a stolen gun. \\n\\nOfficer Mora was 27 years old. \\n\\nOfficer Rivera was 22. \\n\\nBoth Dominican Americans whod grown up on the same streets they later chose to patrol as police officers. \\n\\nI spoke with their families and told them that we are forever in debt for their sacrifice, and we will carry on their mission to restore the trust and safety every community deserves.\n\nContent: And a proud Ukrainian people, who have known 30 years  of independence, have repeatedly shown that they will not tolerate anyone who tries to take their country backwards.  \\n\\nTo all Americans, I will be honest with you, as Ive always promised. A Russian dictator, invading a foreign country, has costs around the world. \\n\\nAnd Im taking robust action to make sure the pain of our sanctions  is targeted at Russias economy. And I will use every tool at our disposal to protect American businesses and consumers. \\n\\nTonight, I can announce that the United States has worked with 30 other countries to release 60 Million barrels of oil from reserves around the world.  \\n\\nAmerica will lead that effort, releasing 30 Million barrels from our own Strategic Petroleum Reserve. And we stand ready to do more if necessary, unified with our allies.  \\n\\nThese steps will help blunt gas prices here at home. And I know the news about whats happening can seem alarming. \\n\\nBut I want you to know that we are going to be okay.\n\nContent: More support for patients and families. \\n\\nTo get there, I call on Congress to fund ARPA-H, the Advanced Research Projects Agency for Health. \\n\\nIts based on DARPAthe Defense Department project that led to the Internet, GPS, and so much more.  \\n\\nARPA-H will have a singular purposeto drive breakthroughs in cancer, Alzheimers, diabetes, and more. \\n\\nA unity agenda for the nation. \\n\\nWe can do this. \\n\\nMy fellow Americanstonight , we have gathered in a sacred spacethe citadel of our democracy. \\n\\nIn this Capitol, generation after generation, Americans have debated great questions amid great strife, and have done great things. \\n\\nWe have fought for freedom, expanded liberty, defeated totalitarianism and terror. \\n\\nAnd built the strongest, freest, and most prosperous nation the world has ever known. \\n\\nNow is the hour. \\n\\nOur moment of responsibility. \\n\\nOur test of resolve and conscience, of history itself. \\n\\nIt is in this moment that our character is formed. Our purpose is found. Our future is forged. \\n\\nWell I know this nation.\n=========\nFINAL ANSWER: The president did not mention Michael Jackson.\n\nQUESTION: {question}\n=========\n{summaries}\n=========\nFINAL ANSWER:`;\nconst COMBINE_PROMPT = \n/*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate.fromTemplate(combine_prompt);\nconst system_combine_template = `Given the following extracted parts of a long document and a question, create a final answer. \nIf you don't know the answer, just say that you don't know. Don't try to make up an answer.\n----------------\n{summaries}`;\nconst combine_messages = [\n    /*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.SystemMessagePromptTemplate.fromTemplate(system_combine_template),\n    /*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.HumanMessagePromptTemplate.fromTemplate(\"{question}\"),\n];\nconst CHAT_COMBINE_PROMPT = \n/*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.ChatPromptTemplate.fromMessages(combine_messages);\nconst COMBINE_PROMPT_SELECTOR = \n/*#__PURE__*/ new _langchain_core_example_selectors__WEBPACK_IMPORTED_MODULE_1__.ConditionalPromptSelector(COMBINE_PROMPT, [\n    [_langchain_core_example_selectors__WEBPACK_IMPORTED_MODULE_1__.isChatModel, CHAT_COMBINE_PROMPT],\n]);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL3F1ZXN0aW9uX2Fuc3dlcmluZy9tYXBfcmVkdWNlX3Byb21wdHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDdUk7QUFDM0M7QUFDNUY7QUFDQTtBQUNBLENBQUM7QUFDRCxXQUFXO0FBQ1g7QUFDTztBQUNQO0FBQ0EsbUVBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQSxDQUFDLFFBQVE7QUFDVDtBQUNBLGtCQUFrQixnRkFBMkI7QUFDN0Msa0JBQWtCLCtFQUEwQixnQkFBZ0IsU0FBUztBQUNyRTtBQUNBLHFDQUFxQyx1RUFBa0I7QUFDaEQ7QUFDUCxrQkFBa0Isd0ZBQXlCO0FBQzNDLEtBQUssMEVBQVc7QUFDaEI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxXQUFXO0FBQ1g7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNPO0FBQ1AsY0FBYyxtRUFBYztBQUM1QjtBQUNBO0FBQ0E7QUFDQSxDQUFDLFVBQVU7QUFDWDtBQUNBLGtCQUFrQixnRkFBMkI7QUFDN0Msa0JBQWtCLCtFQUEwQixnQkFBZ0IsU0FBUztBQUNyRTtBQUNBO0FBQ0EsY0FBYyx1RUFBa0I7QUFDekI7QUFDUCxrQkFBa0Isd0ZBQXlCO0FBQzNDLEtBQUssMEVBQVc7QUFDaEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1jb21wYW5pb24vLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL3F1ZXN0aW9uX2Fuc3dlcmluZy9tYXBfcmVkdWNlX3Byb21wdHMuanM/ZTk0ZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBzcGFjZWQtY29tbWVudCAqL1xuaW1wb3J0IHsgQ2hhdFByb21wdFRlbXBsYXRlLCBTeXN0ZW1NZXNzYWdlUHJvbXB0VGVtcGxhdGUsIEh1bWFuTWVzc2FnZVByb21wdFRlbXBsYXRlLCBQcm9tcHRUZW1wbGF0ZSwgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL3Byb21wdHNcIjtcbmltcG9ydCB7IENvbmRpdGlvbmFsUHJvbXB0U2VsZWN0b3IsIGlzQ2hhdE1vZGVsLCB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvZXhhbXBsZV9zZWxlY3RvcnNcIjtcbmNvbnN0IHFhX3RlbXBsYXRlID0gYFVzZSB0aGUgZm9sbG93aW5nIHBvcnRpb24gb2YgYSBsb25nIGRvY3VtZW50IHRvIHNlZSBpZiBhbnkgb2YgdGhlIHRleHQgaXMgcmVsZXZhbnQgdG8gYW5zd2VyIHRoZSBxdWVzdGlvbi4gXG5SZXR1cm4gYW55IHJlbGV2YW50IHRleHQgdmVyYmF0aW0uXG57Y29udGV4dH1cblF1ZXN0aW9uOiB7cXVlc3Rpb259XG5SZWxldmFudCB0ZXh0LCBpZiBhbnk6YDtcbmV4cG9ydCBjb25zdCBERUZBVUxUX0NPTUJJTkVfUUFfUFJPTVBUID0gXG4vKiNfX1BVUkVfXyovXG5Qcm9tcHRUZW1wbGF0ZS5mcm9tVGVtcGxhdGUocWFfdGVtcGxhdGUpO1xuY29uc3Qgc3lzdGVtX3RlbXBsYXRlID0gYFVzZSB0aGUgZm9sbG93aW5nIHBvcnRpb24gb2YgYSBsb25nIGRvY3VtZW50IHRvIHNlZSBpZiBhbnkgb2YgdGhlIHRleHQgaXMgcmVsZXZhbnQgdG8gYW5zd2VyIHRoZSBxdWVzdGlvbi4gXG5SZXR1cm4gYW55IHJlbGV2YW50IHRleHQgdmVyYmF0aW0uXG4tLS0tLS0tLS0tLS0tLS0tXG57Y29udGV4dH1gO1xuY29uc3QgbWVzc2FnZXMgPSBbXG4gICAgLyojX19QVVJFX18qLyBTeXN0ZW1NZXNzYWdlUHJvbXB0VGVtcGxhdGUuZnJvbVRlbXBsYXRlKHN5c3RlbV90ZW1wbGF0ZSksXG4gICAgLyojX19QVVJFX18qLyBIdW1hbk1lc3NhZ2VQcm9tcHRUZW1wbGF0ZS5mcm9tVGVtcGxhdGUoXCJ7cXVlc3Rpb259XCIpLFxuXTtcbmNvbnN0IENIQVRfUUFfUFJPTVBUID0gLyojX19QVVJFX18qLyBDaGF0UHJvbXB0VGVtcGxhdGUuZnJvbU1lc3NhZ2VzKG1lc3NhZ2VzKTtcbmV4cG9ydCBjb25zdCBDT01CSU5FX1FBX1BST01QVF9TRUxFQ1RPUiA9IFxuLyojX19QVVJFX18qLyBuZXcgQ29uZGl0aW9uYWxQcm9tcHRTZWxlY3RvcihERUZBVUxUX0NPTUJJTkVfUUFfUFJPTVBULCBbXG4gICAgW2lzQ2hhdE1vZGVsLCBDSEFUX1FBX1BST01QVF0sXG5dKTtcbmNvbnN0IGNvbWJpbmVfcHJvbXB0ID0gYEdpdmVuIHRoZSBmb2xsb3dpbmcgZXh0cmFjdGVkIHBhcnRzIG9mIGEgbG9uZyBkb2N1bWVudCBhbmQgYSBxdWVzdGlvbiwgY3JlYXRlIGEgZmluYWwgYW5zd2VyLiBcbklmIHlvdSBkb24ndCBrbm93IHRoZSBhbnN3ZXIsIGp1c3Qgc2F5IHRoYXQgeW91IGRvbid0IGtub3cuIERvbid0IHRyeSB0byBtYWtlIHVwIGFuIGFuc3dlci5cblxuUVVFU1RJT046IFdoaWNoIHN0YXRlL2NvdW50cnkncyBsYXcgZ292ZXJucyB0aGUgaW50ZXJwcmV0YXRpb24gb2YgdGhlIGNvbnRyYWN0P1xuPT09PT09PT09XG5Db250ZW50OiBUaGlzIEFncmVlbWVudCBpcyBnb3Zlcm5lZCBieSBFbmdsaXNoIGxhdyBhbmQgdGhlIHBhcnRpZXMgc3VibWl0IHRvIHRoZSBleGNsdXNpdmUganVyaXNkaWN0aW9uIG9mIHRoZSBFbmdsaXNoIGNvdXJ0cyBpbiAgcmVsYXRpb24gdG8gYW55IGRpc3B1dGUgKGNvbnRyYWN0dWFsIG9yIG5vbi1jb250cmFjdHVhbCkgY29uY2VybmluZyB0aGlzIEFncmVlbWVudCBzYXZlIHRoYXQgZWl0aGVyIHBhcnR5IG1heSBhcHBseSB0byBhbnkgY291cnQgZm9yIGFuICBpbmp1bmN0aW9uIG9yIG90aGVyIHJlbGllZiB0byBwcm90ZWN0IGl0cyBJbnRlbGxlY3R1YWwgUHJvcGVydHkgUmlnaHRzLlxuXG5Db250ZW50OiBObyBXYWl2ZXIuIEZhaWx1cmUgb3IgZGVsYXkgaW4gZXhlcmNpc2luZyBhbnkgcmlnaHQgb3IgcmVtZWR5IHVuZGVyIHRoaXMgQWdyZWVtZW50IHNoYWxsIG5vdCBjb25zdGl0dXRlIGEgd2FpdmVyIG9mIHN1Y2ggKG9yIGFueSBvdGhlcikgIHJpZ2h0IG9yIHJlbWVkeS5cXG5cXG4xMS43IFNldmVyYWJpbGl0eS4gVGhlIGludmFsaWRpdHksIGlsbGVnYWxpdHkgb3IgdW5lbmZvcmNlYWJpbGl0eSBvZiBhbnkgdGVybSAob3IgcGFydCBvZiBhIHRlcm0pIG9mIHRoaXMgQWdyZWVtZW50IHNoYWxsIG5vdCBhZmZlY3QgdGhlIGNvbnRpbnVhdGlvbiAgaW4gZm9yY2Ugb2YgdGhlIHJlbWFpbmRlciBvZiB0aGUgdGVybSAoaWYgYW55KSBhbmQgdGhpcyBBZ3JlZW1lbnQuXFxuXFxuMTEuOCBObyBBZ2VuY3kuIEV4Y2VwdCBhcyBleHByZXNzbHkgc3RhdGVkIG90aGVyd2lzZSwgbm90aGluZyBpbiB0aGlzIEFncmVlbWVudCBzaGFsbCBjcmVhdGUgYW4gYWdlbmN5LCBwYXJ0bmVyc2hpcCBvciBqb2ludCB2ZW50dXJlIG9mIGFueSAga2luZCBiZXR3ZWVuIHRoZSBwYXJ0aWVzLlxcblxcbjExLjkgTm8gVGhpcmQtUGFydHkgQmVuZWZpY2lhcmllcy5cblxuQ29udGVudDogKGIpIGlmIEdvb2dsZSBiZWxpZXZlcywgaW4gZ29vZCBmYWl0aCwgdGhhdCB0aGUgRGlzdHJpYnV0b3IgaGFzIHZpb2xhdGVkIG9yIGNhdXNlZCBHb29nbGUgdG8gdmlvbGF0ZSBhbnkgQW50aS1CcmliZXJ5IExhd3MgKGFzICBkZWZpbmVkIGluIENsYXVzZSA4LjUpIG9yIHRoYXQgc3VjaCBhIHZpb2xhdGlvbiBpcyByZWFzb25hYmx5IGxpa2VseSB0byBvY2N1cixcbj09PT09PT09PVxuRklOQUwgQU5TV0VSOiBUaGlzIEFncmVlbWVudCBpcyBnb3Zlcm5lZCBieSBFbmdsaXNoIGxhdy5cblxuUVVFU1RJT046IFdoYXQgZGlkIHRoZSBwcmVzaWRlbnQgc2F5IGFib3V0IE1pY2hhZWwgSmFja3Nvbj9cbj09PT09PT09PVxuQ29udGVudDogTWFkYW0gU3BlYWtlciwgTWFkYW0gVmljZSBQcmVzaWRlbnQsIG91ciBGaXJzdCBMYWR5IGFuZCBTZWNvbmQgR2VudGxlbWFuLiBNZW1iZXJzIG9mIENvbmdyZXNzIGFuZCB0aGUgQ2FiaW5ldC4gSnVzdGljZXMgb2YgdGhlIFN1cHJlbWUgQ291cnQuIE15IGZlbGxvdyBBbWVyaWNhbnMuICBcXG5cXG5MYXN0IHllYXIgQ09WSUQtMTkga2VwdCB1cyBhcGFydC4gVGhpcyB5ZWFyIHdlIGFyZSBmaW5hbGx5IHRvZ2V0aGVyIGFnYWluLiBcXG5cXG5Ub25pZ2h0LCB3ZSBtZWV0IGFzIERlbW9jcmF0cyBSZXB1YmxpY2FucyBhbmQgSW5kZXBlbmRlbnRzLiBCdXQgbW9zdCBpbXBvcnRhbnRseSBhcyBBbWVyaWNhbnMuIFxcblxcbldpdGggYSBkdXR5IHRvIG9uZSBhbm90aGVyIHRvIHRoZSBBbWVyaWNhbiBwZW9wbGUgdG8gdGhlIENvbnN0aXR1dGlvbi4gXFxuXFxuQW5kIHdpdGggYW4gdW53YXZlcmluZyByZXNvbHZlIHRoYXQgZnJlZWRvbSB3aWxsIGFsd2F5cyB0cml1bXBoIG92ZXIgdHlyYW5ueS4gXFxuXFxuU2l4IGRheXMgYWdvLCBSdXNzaWHigJlzIFZsYWRpbWlyIFB1dGluIHNvdWdodCB0byBzaGFrZSB0aGUgZm91bmRhdGlvbnMgb2YgdGhlIGZyZWUgd29ybGQgdGhpbmtpbmcgaGUgY291bGQgbWFrZSBpdCBiZW5kIHRvIGhpcyBtZW5hY2luZyB3YXlzLiBCdXQgaGUgYmFkbHkgbWlzY2FsY3VsYXRlZC4gXFxuXFxuSGUgdGhvdWdodCBoZSBjb3VsZCByb2xsIGludG8gVWtyYWluZSBhbmQgdGhlIHdvcmxkIHdvdWxkIHJvbGwgb3Zlci4gSW5zdGVhZCBoZSBtZXQgYSB3YWxsIG9mIHN0cmVuZ3RoIGhlIG5ldmVyIGltYWdpbmVkLiBcXG5cXG5IZSBtZXQgdGhlIFVrcmFpbmlhbiBwZW9wbGUuIFxcblxcbkZyb20gUHJlc2lkZW50IFplbGVuc2t5eSB0byBldmVyeSBVa3JhaW5pYW4sIHRoZWlyIGZlYXJsZXNzbmVzcywgdGhlaXIgY291cmFnZSwgdGhlaXIgZGV0ZXJtaW5hdGlvbiwgaW5zcGlyZXMgdGhlIHdvcmxkLiBcXG5cXG5Hcm91cHMgb2YgY2l0aXplbnMgYmxvY2tpbmcgdGFua3Mgd2l0aCB0aGVpciBib2RpZXMuIEV2ZXJ5b25lIGZyb20gc3R1ZGVudHMgdG8gcmV0aXJlZXMgdGVhY2hlcnMgdHVybmVkIHNvbGRpZXJzIGRlZmVuZGluZyB0aGVpciBob21lbGFuZC5cblxuQ29udGVudDogQW5kIHdlIHdvbuKAmXQgc3RvcC4gXFxuXFxuV2UgaGF2ZSBsb3N0IHNvIG11Y2ggdG8gQ09WSUQtMTkuIFRpbWUgd2l0aCBvbmUgYW5vdGhlci4gQW5kIHdvcnN0IG9mIGFsbCwgc28gbXVjaCBsb3NzIG9mIGxpZmUuIFxcblxcbkxldOKAmXMgdXNlIHRoaXMgbW9tZW50IHRvIHJlc2V0LiBMZXTigJlzIHN0b3AgbG9va2luZyBhdCBDT1ZJRC0xOSBhcyBhIHBhcnRpc2FuIGRpdmlkaW5nIGxpbmUgYW5kIHNlZSBpdCBmb3Igd2hhdCBpdCBpczogQSBHb2QtYXdmdWwgZGlzZWFzZS4gIFxcblxcbkxldOKAmXMgc3RvcCBzZWVpbmcgZWFjaCBvdGhlciBhcyBlbmVtaWVzLCBhbmQgc3RhcnQgc2VlaW5nIGVhY2ggb3RoZXIgZm9yIHdobyB3ZSByZWFsbHkgYXJlOiBGZWxsb3cgQW1lcmljYW5zLiAgXFxuXFxuV2UgY2Fu4oCZdCBjaGFuZ2UgaG93IGRpdmlkZWQgd2XigJl2ZSBiZWVuLiBCdXQgd2UgY2FuIGNoYW5nZSBob3cgd2UgbW92ZSBmb3J3YXJk4oCUb24gQ09WSUQtMTkgYW5kIG90aGVyIGlzc3VlcyB3ZSBtdXN0IGZhY2UgdG9nZXRoZXIuIFxcblxcbkkgcmVjZW50bHkgdmlzaXRlZCB0aGUgTmV3IFlvcmsgQ2l0eSBQb2xpY2UgRGVwYXJ0bWVudCBkYXlzIGFmdGVyIHRoZSBmdW5lcmFscyBvZiBPZmZpY2VyIFdpbGJlcnQgTW9yYSBhbmQgaGlzIHBhcnRuZXIsIE9mZmljZXIgSmFzb24gUml2ZXJhLiBcXG5cXG5UaGV5IHdlcmUgcmVzcG9uZGluZyB0byBhIDktMS0xIGNhbGwgd2hlbiBhIG1hbiBzaG90IGFuZCBraWxsZWQgdGhlbSB3aXRoIGEgc3RvbGVuIGd1bi4gXFxuXFxuT2ZmaWNlciBNb3JhIHdhcyAyNyB5ZWFycyBvbGQuIFxcblxcbk9mZmljZXIgUml2ZXJhIHdhcyAyMi4gXFxuXFxuQm90aCBEb21pbmljYW4gQW1lcmljYW5zIHdob+KAmWQgZ3Jvd24gdXAgb24gdGhlIHNhbWUgc3RyZWV0cyB0aGV5IGxhdGVyIGNob3NlIHRvIHBhdHJvbCBhcyBwb2xpY2Ugb2ZmaWNlcnMuIFxcblxcbkkgc3Bva2Ugd2l0aCB0aGVpciBmYW1pbGllcyBhbmQgdG9sZCB0aGVtIHRoYXQgd2UgYXJlIGZvcmV2ZXIgaW4gZGVidCBmb3IgdGhlaXIgc2FjcmlmaWNlLCBhbmQgd2Ugd2lsbCBjYXJyeSBvbiB0aGVpciBtaXNzaW9uIHRvIHJlc3RvcmUgdGhlIHRydXN0IGFuZCBzYWZldHkgZXZlcnkgY29tbXVuaXR5IGRlc2VydmVzLlxuXG5Db250ZW50OiBBbmQgYSBwcm91ZCBVa3JhaW5pYW4gcGVvcGxlLCB3aG8gaGF2ZSBrbm93biAzMCB5ZWFycyAgb2YgaW5kZXBlbmRlbmNlLCBoYXZlIHJlcGVhdGVkbHkgc2hvd24gdGhhdCB0aGV5IHdpbGwgbm90IHRvbGVyYXRlIGFueW9uZSB3aG8gdHJpZXMgdG8gdGFrZSB0aGVpciBjb3VudHJ5IGJhY2t3YXJkcy4gIFxcblxcblRvIGFsbCBBbWVyaWNhbnMsIEkgd2lsbCBiZSBob25lc3Qgd2l0aCB5b3UsIGFzIEnigJl2ZSBhbHdheXMgcHJvbWlzZWQuIEEgUnVzc2lhbiBkaWN0YXRvciwgaW52YWRpbmcgYSBmb3JlaWduIGNvdW50cnksIGhhcyBjb3N0cyBhcm91bmQgdGhlIHdvcmxkLiBcXG5cXG5BbmQgSeKAmW0gdGFraW5nIHJvYnVzdCBhY3Rpb24gdG8gbWFrZSBzdXJlIHRoZSBwYWluIG9mIG91ciBzYW5jdGlvbnMgIGlzIHRhcmdldGVkIGF0IFJ1c3NpYeKAmXMgZWNvbm9teS4gQW5kIEkgd2lsbCB1c2UgZXZlcnkgdG9vbCBhdCBvdXIgZGlzcG9zYWwgdG8gcHJvdGVjdCBBbWVyaWNhbiBidXNpbmVzc2VzIGFuZCBjb25zdW1lcnMuIFxcblxcblRvbmlnaHQsIEkgY2FuIGFubm91bmNlIHRoYXQgdGhlIFVuaXRlZCBTdGF0ZXMgaGFzIHdvcmtlZCB3aXRoIDMwIG90aGVyIGNvdW50cmllcyB0byByZWxlYXNlIDYwIE1pbGxpb24gYmFycmVscyBvZiBvaWwgZnJvbSByZXNlcnZlcyBhcm91bmQgdGhlIHdvcmxkLiAgXFxuXFxuQW1lcmljYSB3aWxsIGxlYWQgdGhhdCBlZmZvcnQsIHJlbGVhc2luZyAzMCBNaWxsaW9uIGJhcnJlbHMgZnJvbSBvdXIgb3duIFN0cmF0ZWdpYyBQZXRyb2xldW0gUmVzZXJ2ZS4gQW5kIHdlIHN0YW5kIHJlYWR5IHRvIGRvIG1vcmUgaWYgbmVjZXNzYXJ5LCB1bmlmaWVkIHdpdGggb3VyIGFsbGllcy4gIFxcblxcblRoZXNlIHN0ZXBzIHdpbGwgaGVscCBibHVudCBnYXMgcHJpY2VzIGhlcmUgYXQgaG9tZS4gQW5kIEkga25vdyB0aGUgbmV3cyBhYm91dCB3aGF04oCZcyBoYXBwZW5pbmcgY2FuIHNlZW0gYWxhcm1pbmcuIFxcblxcbkJ1dCBJIHdhbnQgeW91IHRvIGtub3cgdGhhdCB3ZSBhcmUgZ29pbmcgdG8gYmUgb2theS5cblxuQ29udGVudDogTW9yZSBzdXBwb3J0IGZvciBwYXRpZW50cyBhbmQgZmFtaWxpZXMuIFxcblxcblRvIGdldCB0aGVyZSwgSSBjYWxsIG9uIENvbmdyZXNzIHRvIGZ1bmQgQVJQQS1ILCB0aGUgQWR2YW5jZWQgUmVzZWFyY2ggUHJvamVjdHMgQWdlbmN5IGZvciBIZWFsdGguIFxcblxcbkl04oCZcyBiYXNlZCBvbiBEQVJQQeKAlHRoZSBEZWZlbnNlIERlcGFydG1lbnQgcHJvamVjdCB0aGF0IGxlZCB0byB0aGUgSW50ZXJuZXQsIEdQUywgYW5kIHNvIG11Y2ggbW9yZS4gIFxcblxcbkFSUEEtSCB3aWxsIGhhdmUgYSBzaW5ndWxhciBwdXJwb3Nl4oCUdG8gZHJpdmUgYnJlYWt0aHJvdWdocyBpbiBjYW5jZXIsIEFsemhlaW1lcuKAmXMsIGRpYWJldGVzLCBhbmQgbW9yZS4gXFxuXFxuQSB1bml0eSBhZ2VuZGEgZm9yIHRoZSBuYXRpb24uIFxcblxcbldlIGNhbiBkbyB0aGlzLiBcXG5cXG5NeSBmZWxsb3cgQW1lcmljYW5z4oCUdG9uaWdodCAsIHdlIGhhdmUgZ2F0aGVyZWQgaW4gYSBzYWNyZWQgc3BhY2XigJR0aGUgY2l0YWRlbCBvZiBvdXIgZGVtb2NyYWN5LiBcXG5cXG5JbiB0aGlzIENhcGl0b2wsIGdlbmVyYXRpb24gYWZ0ZXIgZ2VuZXJhdGlvbiwgQW1lcmljYW5zIGhhdmUgZGViYXRlZCBncmVhdCBxdWVzdGlvbnMgYW1pZCBncmVhdCBzdHJpZmUsIGFuZCBoYXZlIGRvbmUgZ3JlYXQgdGhpbmdzLiBcXG5cXG5XZSBoYXZlIGZvdWdodCBmb3IgZnJlZWRvbSwgZXhwYW5kZWQgbGliZXJ0eSwgZGVmZWF0ZWQgdG90YWxpdGFyaWFuaXNtIGFuZCB0ZXJyb3IuIFxcblxcbkFuZCBidWlsdCB0aGUgc3Ryb25nZXN0LCBmcmVlc3QsIGFuZCBtb3N0IHByb3NwZXJvdXMgbmF0aW9uIHRoZSB3b3JsZCBoYXMgZXZlciBrbm93bi4gXFxuXFxuTm93IGlzIHRoZSBob3VyLiBcXG5cXG5PdXIgbW9tZW50IG9mIHJlc3BvbnNpYmlsaXR5LiBcXG5cXG5PdXIgdGVzdCBvZiByZXNvbHZlIGFuZCBjb25zY2llbmNlLCBvZiBoaXN0b3J5IGl0c2VsZi4gXFxuXFxuSXQgaXMgaW4gdGhpcyBtb21lbnQgdGhhdCBvdXIgY2hhcmFjdGVyIGlzIGZvcm1lZC4gT3VyIHB1cnBvc2UgaXMgZm91bmQuIE91ciBmdXR1cmUgaXMgZm9yZ2VkLiBcXG5cXG5XZWxsIEkga25vdyB0aGlzIG5hdGlvbi5cbj09PT09PT09PVxuRklOQUwgQU5TV0VSOiBUaGUgcHJlc2lkZW50IGRpZCBub3QgbWVudGlvbiBNaWNoYWVsIEphY2tzb24uXG5cblFVRVNUSU9OOiB7cXVlc3Rpb259XG49PT09PT09PT1cbntzdW1tYXJpZXN9XG49PT09PT09PT1cbkZJTkFMIEFOU1dFUjpgO1xuZXhwb3J0IGNvbnN0IENPTUJJTkVfUFJPTVBUID0gXG4vKiNfX1BVUkVfXyovIFByb21wdFRlbXBsYXRlLmZyb21UZW1wbGF0ZShjb21iaW5lX3Byb21wdCk7XG5jb25zdCBzeXN0ZW1fY29tYmluZV90ZW1wbGF0ZSA9IGBHaXZlbiB0aGUgZm9sbG93aW5nIGV4dHJhY3RlZCBwYXJ0cyBvZiBhIGxvbmcgZG9jdW1lbnQgYW5kIGEgcXVlc3Rpb24sIGNyZWF0ZSBhIGZpbmFsIGFuc3dlci4gXG5JZiB5b3UgZG9uJ3Qga25vdyB0aGUgYW5zd2VyLCBqdXN0IHNheSB0aGF0IHlvdSBkb24ndCBrbm93LiBEb24ndCB0cnkgdG8gbWFrZSB1cCBhbiBhbnN3ZXIuXG4tLS0tLS0tLS0tLS0tLS0tXG57c3VtbWFyaWVzfWA7XG5jb25zdCBjb21iaW5lX21lc3NhZ2VzID0gW1xuICAgIC8qI19fUFVSRV9fKi8gU3lzdGVtTWVzc2FnZVByb21wdFRlbXBsYXRlLmZyb21UZW1wbGF0ZShzeXN0ZW1fY29tYmluZV90ZW1wbGF0ZSksXG4gICAgLyojX19QVVJFX18qLyBIdW1hbk1lc3NhZ2VQcm9tcHRUZW1wbGF0ZS5mcm9tVGVtcGxhdGUoXCJ7cXVlc3Rpb259XCIpLFxuXTtcbmNvbnN0IENIQVRfQ09NQklORV9QUk9NUFQgPSBcbi8qI19fUFVSRV9fKi8gQ2hhdFByb21wdFRlbXBsYXRlLmZyb21NZXNzYWdlcyhjb21iaW5lX21lc3NhZ2VzKTtcbmV4cG9ydCBjb25zdCBDT01CSU5FX1BST01QVF9TRUxFQ1RPUiA9IFxuLyojX19QVVJFX18qLyBuZXcgQ29uZGl0aW9uYWxQcm9tcHRTZWxlY3RvcihDT01CSU5FX1BST01QVCwgW1xuICAgIFtpc0NoYXRNb2RlbCwgQ0hBVF9DT01CSU5FX1BST01QVF0sXG5dKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/chains/question_answering/map_reduce_prompts.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/chains/question_answering/refine_prompts.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/langchain/dist/chains/question_answering/refine_prompts.js ***!
  \*********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CHAT_QUESTION_PROMPT: () => (/* binding */ CHAT_QUESTION_PROMPT),\n/* harmony export */   CHAT_REFINE_PROMPT: () => (/* binding */ CHAT_REFINE_PROMPT),\n/* harmony export */   DEFAULT_REFINE_PROMPT: () => (/* binding */ DEFAULT_REFINE_PROMPT),\n/* harmony export */   DEFAULT_REFINE_PROMPT_TMPL: () => (/* binding */ DEFAULT_REFINE_PROMPT_TMPL),\n/* harmony export */   DEFAULT_TEXT_QA_PROMPT: () => (/* binding */ DEFAULT_TEXT_QA_PROMPT),\n/* harmony export */   DEFAULT_TEXT_QA_PROMPT_TMPL: () => (/* binding */ DEFAULT_TEXT_QA_PROMPT_TMPL),\n/* harmony export */   QUESTION_PROMPT_SELECTOR: () => (/* binding */ QUESTION_PROMPT_SELECTOR),\n/* harmony export */   REFINE_PROMPT_SELECTOR: () => (/* binding */ REFINE_PROMPT_SELECTOR)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/prompts */ \"(rsc)/./node_modules/@langchain/core/prompts.js\");\n/* harmony import */ var _langchain_core_example_selectors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/example_selectors */ \"(rsc)/./node_modules/@langchain/core/example_selectors.js\");\n/* eslint-disable spaced-comment */\n\n\nconst DEFAULT_REFINE_PROMPT_TMPL = `The original question is as follows: {question}\nWe have provided an existing answer: {existing_answer}\nWe have the opportunity to refine the existing answer\n(only if needed) with some more context below.\n------------\n{context}\n------------\nGiven the new context, refine the original answer to better answer the question. \nIf the context isn't useful, return the original answer.`;\nconst DEFAULT_REFINE_PROMPT = /*#__PURE__*/ new _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate({\n    inputVariables: [\"question\", \"existing_answer\", \"context\"],\n    template: DEFAULT_REFINE_PROMPT_TMPL,\n});\nconst refineTemplate = `The original question is as follows: {question}\nWe have provided an existing answer: {existing_answer}\nWe have the opportunity to refine the existing answer\n(only if needed) with some more context below.\n------------\n{context}\n------------\nGiven the new context, refine the original answer to better answer the question. \nIf the context isn't useful, return the original answer.`;\nconst messages = [\n    /*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.HumanMessagePromptTemplate.fromTemplate(\"{question}\"),\n    /*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.AIMessagePromptTemplate.fromTemplate(\"{existing_answer}\"),\n    /*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.HumanMessagePromptTemplate.fromTemplate(refineTemplate),\n];\nconst CHAT_REFINE_PROMPT = \n/*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.ChatPromptTemplate.fromMessages(messages);\nconst REFINE_PROMPT_SELECTOR = \n/*#__PURE__*/ new _langchain_core_example_selectors__WEBPACK_IMPORTED_MODULE_1__.ConditionalPromptSelector(DEFAULT_REFINE_PROMPT, [\n    [_langchain_core_example_selectors__WEBPACK_IMPORTED_MODULE_1__.isChatModel, CHAT_REFINE_PROMPT],\n]);\nconst DEFAULT_TEXT_QA_PROMPT_TMPL = `Context information is below. \n---------------------\n{context}\n---------------------\nGiven the context information and no prior knowledge, answer the question: {question}`;\nconst DEFAULT_TEXT_QA_PROMPT = /*#__PURE__*/ new _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate({\n    inputVariables: [\"context\", \"question\"],\n    template: DEFAULT_TEXT_QA_PROMPT_TMPL,\n});\nconst chat_qa_prompt_template = `Context information is below. \n---------------------\n{context}\n---------------------\nGiven the context information and no prior knowledge, answer any questions`;\nconst chat_messages = [\n    /*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.SystemMessagePromptTemplate.fromTemplate(chat_qa_prompt_template),\n    /*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.HumanMessagePromptTemplate.fromTemplate(\"{question}\"),\n];\nconst CHAT_QUESTION_PROMPT = \n/*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.ChatPromptTemplate.fromMessages(chat_messages);\nconst QUESTION_PROMPT_SELECTOR = \n/*#__PURE__*/ new _langchain_core_example_selectors__WEBPACK_IMPORTED_MODULE_1__.ConditionalPromptSelector(DEFAULT_TEXT_QA_PROMPT, [\n    [_langchain_core_example_selectors__WEBPACK_IMPORTED_MODULE_1__.isChatModel, CHAT_QUESTION_PROMPT],\n]);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL3F1ZXN0aW9uX2Fuc3dlcmluZy9yZWZpbmVfcHJvbXB0cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUE7QUFDZ0s7QUFDcEU7QUFDckYsMEVBQTBFO0FBQ2pGLHNDQUFzQztBQUN0QztBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ08sZ0RBQWdELG1FQUFjO0FBQ3JFO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsOERBQThEO0FBQzlELHNDQUFzQztBQUN0QztBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsK0VBQTBCLGdCQUFnQixTQUFTO0FBQ3JFLGtCQUFrQiw0RUFBdUIsZ0JBQWdCLGdCQUFnQjtBQUN6RSxrQkFBa0IsK0VBQTBCO0FBQzVDO0FBQ087QUFDUCxjQUFjLHVFQUFrQjtBQUN6QjtBQUNQLGtCQUFrQix3RkFBeUI7QUFDM0MsS0FBSywwRUFBVztBQUNoQjtBQUNPO0FBQ1A7QUFDQSxDQUFDO0FBQ0Q7QUFDQSw0RUFBNEUsU0FBUztBQUM5RSxpREFBaUQsbUVBQWM7QUFDdEU7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixnRkFBMkI7QUFDN0Msa0JBQWtCLCtFQUEwQixnQkFBZ0IsU0FBUztBQUNyRTtBQUNPO0FBQ1AsY0FBYyx1RUFBa0I7QUFDekI7QUFDUCxrQkFBa0Isd0ZBQXlCO0FBQzNDLEtBQUssMEVBQVc7QUFDaEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1jb21wYW5pb24vLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL3F1ZXN0aW9uX2Fuc3dlcmluZy9yZWZpbmVfcHJvbXB0cy5qcz85ODllIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIHNwYWNlZC1jb21tZW50ICovXG5pbXBvcnQgeyBQcm9tcHRUZW1wbGF0ZSwgQ2hhdFByb21wdFRlbXBsYXRlLCBTeXN0ZW1NZXNzYWdlUHJvbXB0VGVtcGxhdGUsIEh1bWFuTWVzc2FnZVByb21wdFRlbXBsYXRlLCBBSU1lc3NhZ2VQcm9tcHRUZW1wbGF0ZSwgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL3Byb21wdHNcIjtcbmltcG9ydCB7IENvbmRpdGlvbmFsUHJvbXB0U2VsZWN0b3IsIGlzQ2hhdE1vZGVsLCB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvZXhhbXBsZV9zZWxlY3RvcnNcIjtcbmV4cG9ydCBjb25zdCBERUZBVUxUX1JFRklORV9QUk9NUFRfVE1QTCA9IGBUaGUgb3JpZ2luYWwgcXVlc3Rpb24gaXMgYXMgZm9sbG93czoge3F1ZXN0aW9ufVxuV2UgaGF2ZSBwcm92aWRlZCBhbiBleGlzdGluZyBhbnN3ZXI6IHtleGlzdGluZ19hbnN3ZXJ9XG5XZSBoYXZlIHRoZSBvcHBvcnR1bml0eSB0byByZWZpbmUgdGhlIGV4aXN0aW5nIGFuc3dlclxuKG9ubHkgaWYgbmVlZGVkKSB3aXRoIHNvbWUgbW9yZSBjb250ZXh0IGJlbG93LlxuLS0tLS0tLS0tLS0tXG57Y29udGV4dH1cbi0tLS0tLS0tLS0tLVxuR2l2ZW4gdGhlIG5ldyBjb250ZXh0LCByZWZpbmUgdGhlIG9yaWdpbmFsIGFuc3dlciB0byBiZXR0ZXIgYW5zd2VyIHRoZSBxdWVzdGlvbi4gXG5JZiB0aGUgY29udGV4dCBpc24ndCB1c2VmdWwsIHJldHVybiB0aGUgb3JpZ2luYWwgYW5zd2VyLmA7XG5leHBvcnQgY29uc3QgREVGQVVMVF9SRUZJTkVfUFJPTVBUID0gLyojX19QVVJFX18qLyBuZXcgUHJvbXB0VGVtcGxhdGUoe1xuICAgIGlucHV0VmFyaWFibGVzOiBbXCJxdWVzdGlvblwiLCBcImV4aXN0aW5nX2Fuc3dlclwiLCBcImNvbnRleHRcIl0sXG4gICAgdGVtcGxhdGU6IERFRkFVTFRfUkVGSU5FX1BST01QVF9UTVBMLFxufSk7XG5jb25zdCByZWZpbmVUZW1wbGF0ZSA9IGBUaGUgb3JpZ2luYWwgcXVlc3Rpb24gaXMgYXMgZm9sbG93czoge3F1ZXN0aW9ufVxuV2UgaGF2ZSBwcm92aWRlZCBhbiBleGlzdGluZyBhbnN3ZXI6IHtleGlzdGluZ19hbnN3ZXJ9XG5XZSBoYXZlIHRoZSBvcHBvcnR1bml0eSB0byByZWZpbmUgdGhlIGV4aXN0aW5nIGFuc3dlclxuKG9ubHkgaWYgbmVlZGVkKSB3aXRoIHNvbWUgbW9yZSBjb250ZXh0IGJlbG93LlxuLS0tLS0tLS0tLS0tXG57Y29udGV4dH1cbi0tLS0tLS0tLS0tLVxuR2l2ZW4gdGhlIG5ldyBjb250ZXh0LCByZWZpbmUgdGhlIG9yaWdpbmFsIGFuc3dlciB0byBiZXR0ZXIgYW5zd2VyIHRoZSBxdWVzdGlvbi4gXG5JZiB0aGUgY29udGV4dCBpc24ndCB1c2VmdWwsIHJldHVybiB0aGUgb3JpZ2luYWwgYW5zd2VyLmA7XG5jb25zdCBtZXNzYWdlcyA9IFtcbiAgICAvKiNfX1BVUkVfXyovIEh1bWFuTWVzc2FnZVByb21wdFRlbXBsYXRlLmZyb21UZW1wbGF0ZShcIntxdWVzdGlvbn1cIiksXG4gICAgLyojX19QVVJFX18qLyBBSU1lc3NhZ2VQcm9tcHRUZW1wbGF0ZS5mcm9tVGVtcGxhdGUoXCJ7ZXhpc3RpbmdfYW5zd2VyfVwiKSxcbiAgICAvKiNfX1BVUkVfXyovIEh1bWFuTWVzc2FnZVByb21wdFRlbXBsYXRlLmZyb21UZW1wbGF0ZShyZWZpbmVUZW1wbGF0ZSksXG5dO1xuZXhwb3J0IGNvbnN0IENIQVRfUkVGSU5FX1BST01QVCA9IFxuLyojX19QVVJFX18qLyBDaGF0UHJvbXB0VGVtcGxhdGUuZnJvbU1lc3NhZ2VzKG1lc3NhZ2VzKTtcbmV4cG9ydCBjb25zdCBSRUZJTkVfUFJPTVBUX1NFTEVDVE9SID0gXG4vKiNfX1BVUkVfXyovIG5ldyBDb25kaXRpb25hbFByb21wdFNlbGVjdG9yKERFRkFVTFRfUkVGSU5FX1BST01QVCwgW1xuICAgIFtpc0NoYXRNb2RlbCwgQ0hBVF9SRUZJTkVfUFJPTVBUXSxcbl0pO1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfVEVYVF9RQV9QUk9NUFRfVE1QTCA9IGBDb250ZXh0IGluZm9ybWF0aW9uIGlzIGJlbG93LiBcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLVxue2NvbnRleHR9XG4tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkdpdmVuIHRoZSBjb250ZXh0IGluZm9ybWF0aW9uIGFuZCBubyBwcmlvciBrbm93bGVkZ2UsIGFuc3dlciB0aGUgcXVlc3Rpb246IHtxdWVzdGlvbn1gO1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfVEVYVF9RQV9QUk9NUFQgPSAvKiNfX1BVUkVfXyovIG5ldyBQcm9tcHRUZW1wbGF0ZSh7XG4gICAgaW5wdXRWYXJpYWJsZXM6IFtcImNvbnRleHRcIiwgXCJxdWVzdGlvblwiXSxcbiAgICB0ZW1wbGF0ZTogREVGQVVMVF9URVhUX1FBX1BST01QVF9UTVBMLFxufSk7XG5jb25zdCBjaGF0X3FhX3Byb21wdF90ZW1wbGF0ZSA9IGBDb250ZXh0IGluZm9ybWF0aW9uIGlzIGJlbG93LiBcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLVxue2NvbnRleHR9XG4tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkdpdmVuIHRoZSBjb250ZXh0IGluZm9ybWF0aW9uIGFuZCBubyBwcmlvciBrbm93bGVkZ2UsIGFuc3dlciBhbnkgcXVlc3Rpb25zYDtcbmNvbnN0IGNoYXRfbWVzc2FnZXMgPSBbXG4gICAgLyojX19QVVJFX18qLyBTeXN0ZW1NZXNzYWdlUHJvbXB0VGVtcGxhdGUuZnJvbVRlbXBsYXRlKGNoYXRfcWFfcHJvbXB0X3RlbXBsYXRlKSxcbiAgICAvKiNfX1BVUkVfXyovIEh1bWFuTWVzc2FnZVByb21wdFRlbXBsYXRlLmZyb21UZW1wbGF0ZShcIntxdWVzdGlvbn1cIiksXG5dO1xuZXhwb3J0IGNvbnN0IENIQVRfUVVFU1RJT05fUFJPTVBUID0gXG4vKiNfX1BVUkVfXyovIENoYXRQcm9tcHRUZW1wbGF0ZS5mcm9tTWVzc2FnZXMoY2hhdF9tZXNzYWdlcyk7XG5leHBvcnQgY29uc3QgUVVFU1RJT05fUFJPTVBUX1NFTEVDVE9SID0gXG4vKiNfX1BVUkVfXyovIG5ldyBDb25kaXRpb25hbFByb21wdFNlbGVjdG9yKERFRkFVTFRfVEVYVF9RQV9QUk9NUFQsIFtcbiAgICBbaXNDaGF0TW9kZWwsIENIQVRfUVVFU1RJT05fUFJPTVBUXSxcbl0pO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/chains/question_answering/refine_prompts.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/chains/question_answering/stuff_prompts.js":
/*!********************************************************************************!*\
  !*** ./node_modules/langchain/dist/chains/question_answering/stuff_prompts.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DEFAULT_QA_PROMPT: () => (/* binding */ DEFAULT_QA_PROMPT),\n/* harmony export */   QA_PROMPT_SELECTOR: () => (/* binding */ QA_PROMPT_SELECTOR)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/prompts */ \"(rsc)/./node_modules/@langchain/core/prompts.js\");\n/* harmony import */ var _langchain_core_example_selectors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/example_selectors */ \"(rsc)/./node_modules/@langchain/core/example_selectors.js\");\n/* eslint-disable spaced-comment */\n\n\nconst DEFAULT_QA_PROMPT = /*#__PURE__*/ new _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate({\n    template: \"Use the following pieces of context to answer the question at the end. If you don't know the answer, just say that you don't know, don't try to make up an answer.\\n\\n{context}\\n\\nQuestion: {question}\\nHelpful Answer:\",\n    inputVariables: [\"context\", \"question\"],\n});\nconst system_template = `Use the following pieces of context to answer the users question. \nIf you don't know the answer, just say that you don't know, don't try to make up an answer.\n----------------\n{context}`;\nconst messages = [\n    /*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.SystemMessagePromptTemplate.fromTemplate(system_template),\n    /*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.HumanMessagePromptTemplate.fromTemplate(\"{question}\"),\n];\nconst CHAT_PROMPT = /*#__PURE__*/ _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.ChatPromptTemplate.fromMessages(messages);\nconst QA_PROMPT_SELECTOR = /*#__PURE__*/ new _langchain_core_example_selectors__WEBPACK_IMPORTED_MODULE_1__.ConditionalPromptSelector(DEFAULT_QA_PROMPT, [[_langchain_core_example_selectors__WEBPACK_IMPORTED_MODULE_1__.isChatModel, CHAT_PROMPT]]);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL3F1ZXN0aW9uX2Fuc3dlcmluZy9zdHVmZl9wcm9tcHRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUN1STtBQUMzQztBQUNyRiw0Q0FBNEMsbUVBQWM7QUFDakUsc0xBQXNMLFFBQVEsZUFBZSxTQUFTO0FBQ3ROO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLENBQUMsUUFBUTtBQUNUO0FBQ0Esa0JBQWtCLGdGQUEyQjtBQUM3QyxrQkFBa0IsK0VBQTBCLGdCQUFnQixTQUFTO0FBQ3JFO0FBQ0Esa0NBQWtDLHVFQUFrQjtBQUM3Qyw2Q0FBNkMsd0ZBQXlCLHNCQUFzQiwwRUFBVyIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvbXBhbmlvbi8uL25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9jaGFpbnMvcXVlc3Rpb25fYW5zd2VyaW5nL3N0dWZmX3Byb21wdHMuanM/Yjc4NSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBzcGFjZWQtY29tbWVudCAqL1xuaW1wb3J0IHsgQ2hhdFByb21wdFRlbXBsYXRlLCBTeXN0ZW1NZXNzYWdlUHJvbXB0VGVtcGxhdGUsIEh1bWFuTWVzc2FnZVByb21wdFRlbXBsYXRlLCBQcm9tcHRUZW1wbGF0ZSwgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL3Byb21wdHNcIjtcbmltcG9ydCB7IENvbmRpdGlvbmFsUHJvbXB0U2VsZWN0b3IsIGlzQ2hhdE1vZGVsLCB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvZXhhbXBsZV9zZWxlY3RvcnNcIjtcbmV4cG9ydCBjb25zdCBERUZBVUxUX1FBX1BST01QVCA9IC8qI19fUFVSRV9fKi8gbmV3IFByb21wdFRlbXBsYXRlKHtcbiAgICB0ZW1wbGF0ZTogXCJVc2UgdGhlIGZvbGxvd2luZyBwaWVjZXMgb2YgY29udGV4dCB0byBhbnN3ZXIgdGhlIHF1ZXN0aW9uIGF0IHRoZSBlbmQuIElmIHlvdSBkb24ndCBrbm93IHRoZSBhbnN3ZXIsIGp1c3Qgc2F5IHRoYXQgeW91IGRvbid0IGtub3csIGRvbid0IHRyeSB0byBtYWtlIHVwIGFuIGFuc3dlci5cXG5cXG57Y29udGV4dH1cXG5cXG5RdWVzdGlvbjoge3F1ZXN0aW9ufVxcbkhlbHBmdWwgQW5zd2VyOlwiLFxuICAgIGlucHV0VmFyaWFibGVzOiBbXCJjb250ZXh0XCIsIFwicXVlc3Rpb25cIl0sXG59KTtcbmNvbnN0IHN5c3RlbV90ZW1wbGF0ZSA9IGBVc2UgdGhlIGZvbGxvd2luZyBwaWVjZXMgb2YgY29udGV4dCB0byBhbnN3ZXIgdGhlIHVzZXJzIHF1ZXN0aW9uLiBcbklmIHlvdSBkb24ndCBrbm93IHRoZSBhbnN3ZXIsIGp1c3Qgc2F5IHRoYXQgeW91IGRvbid0IGtub3csIGRvbid0IHRyeSB0byBtYWtlIHVwIGFuIGFuc3dlci5cbi0tLS0tLS0tLS0tLS0tLS1cbntjb250ZXh0fWA7XG5jb25zdCBtZXNzYWdlcyA9IFtcbiAgICAvKiNfX1BVUkVfXyovIFN5c3RlbU1lc3NhZ2VQcm9tcHRUZW1wbGF0ZS5mcm9tVGVtcGxhdGUoc3lzdGVtX3RlbXBsYXRlKSxcbiAgICAvKiNfX1BVUkVfXyovIEh1bWFuTWVzc2FnZVByb21wdFRlbXBsYXRlLmZyb21UZW1wbGF0ZShcIntxdWVzdGlvbn1cIiksXG5dO1xuY29uc3QgQ0hBVF9QUk9NUFQgPSAvKiNfX1BVUkVfXyovIENoYXRQcm9tcHRUZW1wbGF0ZS5mcm9tTWVzc2FnZXMobWVzc2FnZXMpO1xuZXhwb3J0IGNvbnN0IFFBX1BST01QVF9TRUxFQ1RPUiA9IC8qI19fUFVSRV9fKi8gbmV3IENvbmRpdGlvbmFsUHJvbXB0U2VsZWN0b3IoREVGQVVMVF9RQV9QUk9NUFQsIFtbaXNDaGF0TW9kZWwsIENIQVRfUFJPTVBUXV0pO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/chains/question_answering/stuff_prompts.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/chains/sequential_chain.js":
/*!****************************************************************!*\
  !*** ./node_modules/langchain/dist/chains/sequential_chain.js ***!
  \****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SequentialChain: () => (/* binding */ SequentialChain),\n/* harmony export */   SimpleSequentialChain: () => (/* binding */ SimpleSequentialChain)\n/* harmony export */ });\n/* harmony import */ var _base_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base.js */ \"(rsc)/./node_modules/langchain/dist/chains/base.js\");\n/* harmony import */ var _util_set_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/set.js */ \"(rsc)/./node_modules/langchain/dist/util/set.js\");\n\n\nfunction formatSet(input) {\n    return Array.from(input)\n        .map((i) => `\"${i}\"`)\n        .join(\", \");\n}\n/**\n * Chain where the outputs of one chain feed directly into next.\n * @example\n * ```typescript\n * const promptTemplate = new PromptTemplate({\n *   template: `You are a playwright. Given the title of play and the era it is set in, it is your job to write a synopsis for that title.\n * Title: {title}\n * Era: {era}\n * Playwright: This is a synopsis for the above play:`,\n *   inputVariables: [\"title\", \"era\"],\n * });\n\n * const reviewPromptTemplate = new PromptTemplate({\n *   template: `You are a play critic from the New York Times. Given the synopsis of play, it is your job to write a review for that play.\n *\n *     Play Synopsis:\n *     {synopsis}\n *     Review from a New York Times play critic of the above play:`,\n *   inputVariables: [\"synopsis\"],\n * });\n\n * const overallChain = new SequentialChain({\n *   chains: [\n *     new LLMChain({\n *       llm: new ChatOpenAI({ temperature: 0 }),\n *       prompt: promptTemplate,\n *       outputKey: \"synopsis\",\n *     }),\n *     new LLMChain({\n *       llm: new OpenAI({ temperature: 0 }),\n *       prompt: reviewPromptTemplate,\n *       outputKey: \"review\",\n *     }),\n *   ],\n *   inputVariables: [\"era\", \"title\"],\n *   outputVariables: [\"synopsis\", \"review\"],\n *   verbose: true,\n * });\n\n * const chainExecutionResult = await overallChain.call({\n *   title: \"Tragedy at sunset on the beach\",\n *   era: \"Victorian England\",\n * });\n * console.log(chainExecutionResult);\n * ```\n *\n * @deprecated\n * Switch to {@link https://js.langchain.com/docs/expression_language/ | expression language}.\n * Will be removed in 0.2.0\n */\nclass SequentialChain extends _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain {\n    static lc_name() {\n        return \"SequentialChain\";\n    }\n    get inputKeys() {\n        return this.inputVariables;\n    }\n    get outputKeys() {\n        return this.outputVariables;\n    }\n    constructor(fields) {\n        super(fields);\n        Object.defineProperty(this, \"chains\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"inputVariables\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"outputVariables\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"returnAll\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.chains = fields.chains;\n        this.inputVariables = fields.inputVariables;\n        this.outputVariables = fields.outputVariables ?? [];\n        if (this.outputVariables.length > 0 && fields.returnAll) {\n            throw new Error(\"Either specify variables to return using `outputVariables` or use `returnAll` param. Cannot apply both conditions at the same time.\");\n        }\n        this.returnAll = fields.returnAll ?? false;\n        this._validateChains();\n    }\n    /** @ignore */\n    _validateChains() {\n        if (this.chains.length === 0) {\n            throw new Error(\"Sequential chain must have at least one chain.\");\n        }\n        const memoryKeys = this.memory?.memoryKeys ?? [];\n        const inputKeysSet = new Set(this.inputKeys);\n        const memoryKeysSet = new Set(memoryKeys);\n        const keysIntersection = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.intersection)(inputKeysSet, memoryKeysSet);\n        if (keysIntersection.size > 0) {\n            throw new Error(`The following keys: ${formatSet(keysIntersection)} are overlapping between memory and input keys of the chain variables. This can lead to unexpected behaviour. Please use input and memory keys that don't overlap.`);\n        }\n        const availableKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.union)(inputKeysSet, memoryKeysSet);\n        for (const chain of this.chains) {\n            let missingKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.difference)(new Set(chain.inputKeys), availableKeys);\n            if (chain.memory) {\n                missingKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.difference)(missingKeys, new Set(chain.memory.memoryKeys));\n            }\n            if (missingKeys.size > 0) {\n                throw new Error(`Missing variables for chain \"${chain._chainType()}\": ${formatSet(missingKeys)}. Only got the following variables: ${formatSet(availableKeys)}.`);\n            }\n            const outputKeysSet = new Set(chain.outputKeys);\n            const overlappingOutputKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.intersection)(availableKeys, outputKeysSet);\n            if (overlappingOutputKeys.size > 0) {\n                throw new Error(`The following output variables for chain \"${chain._chainType()}\" are overlapping: ${formatSet(overlappingOutputKeys)}. This can lead to unexpected behaviour.`);\n            }\n            for (const outputKey of outputKeysSet) {\n                availableKeys.add(outputKey);\n            }\n        }\n        if (this.outputVariables.length === 0) {\n            if (this.returnAll) {\n                const outputKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.difference)(availableKeys, inputKeysSet);\n                this.outputVariables = Array.from(outputKeys);\n            }\n            else {\n                this.outputVariables = this.chains[this.chains.length - 1].outputKeys;\n            }\n        }\n        else {\n            const missingKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.difference)(new Set(this.outputVariables), new Set(availableKeys));\n            if (missingKeys.size > 0) {\n                throw new Error(`The following output variables were expected to be in the final chain output but were not found: ${formatSet(missingKeys)}.`);\n            }\n        }\n    }\n    /** @ignore */\n    async _call(values, runManager) {\n        let input = {};\n        const allChainValues = values;\n        let i = 0;\n        for (const chain of this.chains) {\n            i += 1;\n            input = await chain.call(allChainValues, runManager?.getChild(`step_${i}`));\n            for (const key of Object.keys(input)) {\n                allChainValues[key] = input[key];\n            }\n        }\n        const output = {};\n        for (const key of this.outputVariables) {\n            output[key] = allChainValues[key];\n        }\n        return output;\n    }\n    _chainType() {\n        return \"sequential_chain\";\n    }\n    static async deserialize(data) {\n        const chains = [];\n        const inputVariables = data.input_variables;\n        const outputVariables = data.output_variables;\n        const serializedChains = data.chains;\n        for (const serializedChain of serializedChains) {\n            const deserializedChain = await _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain.deserialize(serializedChain);\n            chains.push(deserializedChain);\n        }\n        return new SequentialChain({ chains, inputVariables, outputVariables });\n    }\n    serialize() {\n        const chains = [];\n        for (const chain of this.chains) {\n            chains.push(chain.serialize());\n        }\n        return {\n            _type: this._chainType(),\n            input_variables: this.inputVariables,\n            output_variables: this.outputVariables,\n            chains,\n        };\n    }\n}\n/**\n * @deprecated Switch to expression language: https://js.langchain.com/docs/expression_language/\n * Simple chain where a single string output of one chain is fed directly into the next.\n * @augments BaseChain\n * @augments SimpleSequentialChainInput\n *\n * @example\n * ```ts\n * import { SimpleSequentialChain, LLMChain } from \"langchain/chains\";\n * import { OpenAI } from \"langchain/llms/openai\";\n * import { PromptTemplate } from \"langchain/prompts\";\n *\n * // This is an LLMChain to write a synopsis given a title of a play.\n * const llm = new OpenAI({ temperature: 0 });\n * const template = `You are a playwright. Given the title of play, it is your job to write a synopsis for that title.\n *\n * Title: {title}\n * Playwright: This is a synopsis for the above play:`\n * const promptTemplate = new PromptTemplate({ template, inputVariables: [\"title\"] });\n * const synopsisChain = new LLMChain({ llm, prompt: promptTemplate });\n *\n *\n * // This is an LLMChain to write a review of a play given a synopsis.\n * const reviewLLM = new OpenAI({ temperature: 0 })\n * const reviewTemplate = `You are a play critic from the New York Times. Given the synopsis of play, it is your job to write a review for that play.\n *\n * Play Synopsis:\n * {synopsis}\n * Review from a New York Times play critic of the above play:`\n * const reviewPromptTemplate = new PromptTemplate({ template: reviewTemplate, inputVariables: [\"synopsis\"] });\n * const reviewChain = new LLMChain({ llm: reviewLLM, prompt: reviewPromptTemplate });\n *\n * const overallChain = new SimpleSequentialChain({chains: [synopsisChain, reviewChain], verbose:true})\n * const review = await overallChain.run(\"Tragedy at sunset on the beach\")\n * // the variable review contains resulting play review.\n * ```\n */\nclass SimpleSequentialChain extends _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain {\n    static lc_name() {\n        return \"SimpleSequentialChain\";\n    }\n    get inputKeys() {\n        return [this.inputKey];\n    }\n    get outputKeys() {\n        return [this.outputKey];\n    }\n    constructor(fields) {\n        super(fields);\n        Object.defineProperty(this, \"chains\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"inputKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"input\"\n        });\n        Object.defineProperty(this, \"outputKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"output\"\n        });\n        Object.defineProperty(this, \"trimOutputs\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.chains = fields.chains;\n        this.trimOutputs = fields.trimOutputs ?? false;\n        this._validateChains();\n    }\n    /** @ignore */\n    _validateChains() {\n        for (const chain of this.chains) {\n            if (chain.inputKeys.filter((k) => !chain.memory?.memoryKeys.includes(k) ?? true).length !== 1) {\n                throw new Error(`Chains used in SimpleSequentialChain should all have one input, got ${chain.inputKeys.length} for ${chain._chainType()}.`);\n            }\n            if (chain.outputKeys.length !== 1) {\n                throw new Error(`Chains used in SimpleSequentialChain should all have one output, got ${chain.outputKeys.length} for ${chain._chainType()}.`);\n            }\n        }\n    }\n    /** @ignore */\n    async _call(values, runManager) {\n        let input = values[this.inputKey];\n        let i = 0;\n        for (const chain of this.chains) {\n            i += 1;\n            input = (await chain.call({ [chain.inputKeys[0]]: input, signal: values.signal }, runManager?.getChild(`step_${i}`)))[chain.outputKeys[0]];\n            if (this.trimOutputs) {\n                input = input.trim();\n            }\n            await runManager?.handleText(input);\n        }\n        return { [this.outputKey]: input };\n    }\n    _chainType() {\n        return \"simple_sequential_chain\";\n    }\n    static async deserialize(data) {\n        const chains = [];\n        const serializedChains = data.chains;\n        for (const serializedChain of serializedChains) {\n            const deserializedChain = await _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain.deserialize(serializedChain);\n            chains.push(deserializedChain);\n        }\n        return new SimpleSequentialChain({ chains });\n    }\n    serialize() {\n        const chains = [];\n        for (const chain of this.chains) {\n            chains.push(chain.serialize());\n        }\n        return {\n            _type: this._chainType(),\n            chains,\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL3NlcXVlbnRpYWxfY2hhaW4uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFzQztBQUMyQjtBQUNqRTtBQUNBO0FBQ0Esd0JBQXdCLEVBQUU7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1Q7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGdCQUFnQjtBQUMvQztBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsMkJBQTJCLGdCQUFnQjtBQUMzQztBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLCtFQUErRTtBQUM3RjtBQUNBO0FBQ08sOEJBQThCLCtDQUFTO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsMERBQVk7QUFDN0M7QUFDQSxtREFBbUQsNkJBQTZCO0FBQ2hGO0FBQ0EsOEJBQThCLG1EQUFLO0FBQ25DO0FBQ0EsOEJBQThCLHdEQUFVO0FBQ3hDO0FBQ0EsOEJBQThCLHdEQUFVO0FBQ3hDO0FBQ0E7QUFDQSxnRUFBZ0UsbUJBQW1CLEtBQUssdUJBQXVCLHNDQUFzQyx5QkFBeUI7QUFDOUs7QUFDQTtBQUNBLDBDQUEwQywwREFBWTtBQUN0RDtBQUNBLDZFQUE2RSxtQkFBbUIscUJBQXFCLGlDQUFpQztBQUN0SjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyx3REFBVTtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyx3REFBVTtBQUMxQztBQUNBLG9JQUFvSSx1QkFBdUI7QUFDM0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRkFBa0YsRUFBRTtBQUNwRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QywrQ0FBUztBQUNyRDtBQUNBO0FBQ0EscUNBQXFDLHlDQUF5QztBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksa0NBQWtDO0FBQzlDLFlBQVksU0FBUztBQUNyQixZQUFZLGlCQUFpQjtBQUM3QjtBQUNBO0FBQ0EsNEJBQTRCLGdCQUFnQjtBQUM1QztBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsK0NBQStDLHFDQUFxQztBQUNwRix3Q0FBd0MsNkJBQTZCO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxnQkFBZ0I7QUFDbEQ7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EscURBQXFELHdEQUF3RDtBQUM3RyxzQ0FBc0MsOENBQThDO0FBQ3BGO0FBQ0EsbURBQW1ELG1EQUFtRDtBQUN0RztBQUNBO0FBQ0E7QUFDQTtBQUNPLG9DQUFvQywrQ0FBUztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUdBQXVHLHdCQUF3QixNQUFNLG1CQUFtQjtBQUN4SjtBQUNBO0FBQ0Esd0dBQXdHLHlCQUF5QixNQUFNLG1CQUFtQjtBQUMxSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0Msb0RBQW9ELCtCQUErQixFQUFFO0FBQzdIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QywrQ0FBUztBQUNyRDtBQUNBO0FBQ0EsMkNBQTJDLFFBQVE7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWktY29tcGFuaW9uLy4vbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2NoYWlucy9zZXF1ZW50aWFsX2NoYWluLmpzPzJkMTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQmFzZUNoYWluIH0gZnJvbSBcIi4vYmFzZS5qc1wiO1xuaW1wb3J0IHsgaW50ZXJzZWN0aW9uLCB1bmlvbiwgZGlmZmVyZW5jZSB9IGZyb20gXCIuLi91dGlsL3NldC5qc1wiO1xuZnVuY3Rpb24gZm9ybWF0U2V0KGlucHV0KSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oaW5wdXQpXG4gICAgICAgIC5tYXAoKGkpID0+IGBcIiR7aX1cImApXG4gICAgICAgIC5qb2luKFwiLCBcIik7XG59XG4vKipcbiAqIENoYWluIHdoZXJlIHRoZSBvdXRwdXRzIG9mIG9uZSBjaGFpbiBmZWVkIGRpcmVjdGx5IGludG8gbmV4dC5cbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBwcm9tcHRUZW1wbGF0ZSA9IG5ldyBQcm9tcHRUZW1wbGF0ZSh7XG4gKiAgIHRlbXBsYXRlOiBgWW91IGFyZSBhIHBsYXl3cmlnaHQuIEdpdmVuIHRoZSB0aXRsZSBvZiBwbGF5IGFuZCB0aGUgZXJhIGl0IGlzIHNldCBpbiwgaXQgaXMgeW91ciBqb2IgdG8gd3JpdGUgYSBzeW5vcHNpcyBmb3IgdGhhdCB0aXRsZS5cbiAqIFRpdGxlOiB7dGl0bGV9XG4gKiBFcmE6IHtlcmF9XG4gKiBQbGF5d3JpZ2h0OiBUaGlzIGlzIGEgc3lub3BzaXMgZm9yIHRoZSBhYm92ZSBwbGF5OmAsXG4gKiAgIGlucHV0VmFyaWFibGVzOiBbXCJ0aXRsZVwiLCBcImVyYVwiXSxcbiAqIH0pO1xuXG4gKiBjb25zdCByZXZpZXdQcm9tcHRUZW1wbGF0ZSA9IG5ldyBQcm9tcHRUZW1wbGF0ZSh7XG4gKiAgIHRlbXBsYXRlOiBgWW91IGFyZSBhIHBsYXkgY3JpdGljIGZyb20gdGhlIE5ldyBZb3JrIFRpbWVzLiBHaXZlbiB0aGUgc3lub3BzaXMgb2YgcGxheSwgaXQgaXMgeW91ciBqb2IgdG8gd3JpdGUgYSByZXZpZXcgZm9yIHRoYXQgcGxheS5cbiAqXG4gKiAgICAgUGxheSBTeW5vcHNpczpcbiAqICAgICB7c3lub3BzaXN9XG4gKiAgICAgUmV2aWV3IGZyb20gYSBOZXcgWW9yayBUaW1lcyBwbGF5IGNyaXRpYyBvZiB0aGUgYWJvdmUgcGxheTpgLFxuICogICBpbnB1dFZhcmlhYmxlczogW1wic3lub3BzaXNcIl0sXG4gKiB9KTtcblxuICogY29uc3Qgb3ZlcmFsbENoYWluID0gbmV3IFNlcXVlbnRpYWxDaGFpbih7XG4gKiAgIGNoYWluczogW1xuICogICAgIG5ldyBMTE1DaGFpbih7XG4gKiAgICAgICBsbG06IG5ldyBDaGF0T3BlbkFJKHsgdGVtcGVyYXR1cmU6IDAgfSksXG4gKiAgICAgICBwcm9tcHQ6IHByb21wdFRlbXBsYXRlLFxuICogICAgICAgb3V0cHV0S2V5OiBcInN5bm9wc2lzXCIsXG4gKiAgICAgfSksXG4gKiAgICAgbmV3IExMTUNoYWluKHtcbiAqICAgICAgIGxsbTogbmV3IE9wZW5BSSh7IHRlbXBlcmF0dXJlOiAwIH0pLFxuICogICAgICAgcHJvbXB0OiByZXZpZXdQcm9tcHRUZW1wbGF0ZSxcbiAqICAgICAgIG91dHB1dEtleTogXCJyZXZpZXdcIixcbiAqICAgICB9KSxcbiAqICAgXSxcbiAqICAgaW5wdXRWYXJpYWJsZXM6IFtcImVyYVwiLCBcInRpdGxlXCJdLFxuICogICBvdXRwdXRWYXJpYWJsZXM6IFtcInN5bm9wc2lzXCIsIFwicmV2aWV3XCJdLFxuICogICB2ZXJib3NlOiB0cnVlLFxuICogfSk7XG5cbiAqIGNvbnN0IGNoYWluRXhlY3V0aW9uUmVzdWx0ID0gYXdhaXQgb3ZlcmFsbENoYWluLmNhbGwoe1xuICogICB0aXRsZTogXCJUcmFnZWR5IGF0IHN1bnNldCBvbiB0aGUgYmVhY2hcIixcbiAqICAgZXJhOiBcIlZpY3RvcmlhbiBFbmdsYW5kXCIsXG4gKiB9KTtcbiAqIGNvbnNvbGUubG9nKGNoYWluRXhlY3V0aW9uUmVzdWx0KTtcbiAqIGBgYFxuICpcbiAqIEBkZXByZWNhdGVkXG4gKiBTd2l0Y2ggdG8ge0BsaW5rIGh0dHBzOi8vanMubGFuZ2NoYWluLmNvbS9kb2NzL2V4cHJlc3Npb25fbGFuZ3VhZ2UvIHwgZXhwcmVzc2lvbiBsYW5ndWFnZX0uXG4gKiBXaWxsIGJlIHJlbW92ZWQgaW4gMC4yLjBcbiAqL1xuZXhwb3J0IGNsYXNzIFNlcXVlbnRpYWxDaGFpbiBleHRlbmRzIEJhc2VDaGFpbiB7XG4gICAgc3RhdGljIGxjX25hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIlNlcXVlbnRpYWxDaGFpblwiO1xuICAgIH1cbiAgICBnZXQgaW5wdXRLZXlzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbnB1dFZhcmlhYmxlcztcbiAgICB9XG4gICAgZ2V0IG91dHB1dEtleXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm91dHB1dFZhcmlhYmxlcztcbiAgICB9XG4gICAgY29uc3RydWN0b3IoZmllbGRzKSB7XG4gICAgICAgIHN1cGVyKGZpZWxkcyk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNoYWluc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJpbnB1dFZhcmlhYmxlc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJvdXRwdXRWYXJpYWJsZXNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwicmV0dXJuQWxsXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY2hhaW5zID0gZmllbGRzLmNoYWlucztcbiAgICAgICAgdGhpcy5pbnB1dFZhcmlhYmxlcyA9IGZpZWxkcy5pbnB1dFZhcmlhYmxlcztcbiAgICAgICAgdGhpcy5vdXRwdXRWYXJpYWJsZXMgPSBmaWVsZHMub3V0cHV0VmFyaWFibGVzID8/IFtdO1xuICAgICAgICBpZiAodGhpcy5vdXRwdXRWYXJpYWJsZXMubGVuZ3RoID4gMCAmJiBmaWVsZHMucmV0dXJuQWxsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFaXRoZXIgc3BlY2lmeSB2YXJpYWJsZXMgdG8gcmV0dXJuIHVzaW5nIGBvdXRwdXRWYXJpYWJsZXNgIG9yIHVzZSBgcmV0dXJuQWxsYCBwYXJhbS4gQ2Fubm90IGFwcGx5IGJvdGggY29uZGl0aW9ucyBhdCB0aGUgc2FtZSB0aW1lLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJldHVybkFsbCA9IGZpZWxkcy5yZXR1cm5BbGwgPz8gZmFsc2U7XG4gICAgICAgIHRoaXMuX3ZhbGlkYXRlQ2hhaW5zKCk7XG4gICAgfVxuICAgIC8qKiBAaWdub3JlICovXG4gICAgX3ZhbGlkYXRlQ2hhaW5zKCkge1xuICAgICAgICBpZiAodGhpcy5jaGFpbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTZXF1ZW50aWFsIGNoYWluIG11c3QgaGF2ZSBhdCBsZWFzdCBvbmUgY2hhaW4uXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG1lbW9yeUtleXMgPSB0aGlzLm1lbW9yeT8ubWVtb3J5S2V5cyA/PyBbXTtcbiAgICAgICAgY29uc3QgaW5wdXRLZXlzU2V0ID0gbmV3IFNldCh0aGlzLmlucHV0S2V5cyk7XG4gICAgICAgIGNvbnN0IG1lbW9yeUtleXNTZXQgPSBuZXcgU2V0KG1lbW9yeUtleXMpO1xuICAgICAgICBjb25zdCBrZXlzSW50ZXJzZWN0aW9uID0gaW50ZXJzZWN0aW9uKGlucHV0S2V5c1NldCwgbWVtb3J5S2V5c1NldCk7XG4gICAgICAgIGlmIChrZXlzSW50ZXJzZWN0aW9uLnNpemUgPiAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSBmb2xsb3dpbmcga2V5czogJHtmb3JtYXRTZXQoa2V5c0ludGVyc2VjdGlvbil9IGFyZSBvdmVybGFwcGluZyBiZXR3ZWVuIG1lbW9yeSBhbmQgaW5wdXQga2V5cyBvZiB0aGUgY2hhaW4gdmFyaWFibGVzLiBUaGlzIGNhbiBsZWFkIHRvIHVuZXhwZWN0ZWQgYmVoYXZpb3VyLiBQbGVhc2UgdXNlIGlucHV0IGFuZCBtZW1vcnkga2V5cyB0aGF0IGRvbid0IG92ZXJsYXAuYCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYXZhaWxhYmxlS2V5cyA9IHVuaW9uKGlucHV0S2V5c1NldCwgbWVtb3J5S2V5c1NldCk7XG4gICAgICAgIGZvciAoY29uc3QgY2hhaW4gb2YgdGhpcy5jaGFpbnMpIHtcbiAgICAgICAgICAgIGxldCBtaXNzaW5nS2V5cyA9IGRpZmZlcmVuY2UobmV3IFNldChjaGFpbi5pbnB1dEtleXMpLCBhdmFpbGFibGVLZXlzKTtcbiAgICAgICAgICAgIGlmIChjaGFpbi5tZW1vcnkpIHtcbiAgICAgICAgICAgICAgICBtaXNzaW5nS2V5cyA9IGRpZmZlcmVuY2UobWlzc2luZ0tleXMsIG5ldyBTZXQoY2hhaW4ubWVtb3J5Lm1lbW9yeUtleXMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChtaXNzaW5nS2V5cy5zaXplID4gMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyB2YXJpYWJsZXMgZm9yIGNoYWluIFwiJHtjaGFpbi5fY2hhaW5UeXBlKCl9XCI6ICR7Zm9ybWF0U2V0KG1pc3NpbmdLZXlzKX0uIE9ubHkgZ290IHRoZSBmb2xsb3dpbmcgdmFyaWFibGVzOiAke2Zvcm1hdFNldChhdmFpbGFibGVLZXlzKX0uYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBvdXRwdXRLZXlzU2V0ID0gbmV3IFNldChjaGFpbi5vdXRwdXRLZXlzKTtcbiAgICAgICAgICAgIGNvbnN0IG92ZXJsYXBwaW5nT3V0cHV0S2V5cyA9IGludGVyc2VjdGlvbihhdmFpbGFibGVLZXlzLCBvdXRwdXRLZXlzU2V0KTtcbiAgICAgICAgICAgIGlmIChvdmVybGFwcGluZ091dHB1dEtleXMuc2l6ZSA+IDApIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSBmb2xsb3dpbmcgb3V0cHV0IHZhcmlhYmxlcyBmb3IgY2hhaW4gXCIke2NoYWluLl9jaGFpblR5cGUoKX1cIiBhcmUgb3ZlcmxhcHBpbmc6ICR7Zm9ybWF0U2V0KG92ZXJsYXBwaW5nT3V0cHV0S2V5cyl9LiBUaGlzIGNhbiBsZWFkIHRvIHVuZXhwZWN0ZWQgYmVoYXZpb3VyLmApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBvdXRwdXRLZXkgb2Ygb3V0cHV0S2V5c1NldCkge1xuICAgICAgICAgICAgICAgIGF2YWlsYWJsZUtleXMuYWRkKG91dHB1dEtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub3V0cHV0VmFyaWFibGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucmV0dXJuQWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0S2V5cyA9IGRpZmZlcmVuY2UoYXZhaWxhYmxlS2V5cywgaW5wdXRLZXlzU2V0KTtcbiAgICAgICAgICAgICAgICB0aGlzLm91dHB1dFZhcmlhYmxlcyA9IEFycmF5LmZyb20ob3V0cHV0S2V5cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm91dHB1dFZhcmlhYmxlcyA9IHRoaXMuY2hhaW5zW3RoaXMuY2hhaW5zLmxlbmd0aCAtIDFdLm91dHB1dEtleXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBtaXNzaW5nS2V5cyA9IGRpZmZlcmVuY2UobmV3IFNldCh0aGlzLm91dHB1dFZhcmlhYmxlcyksIG5ldyBTZXQoYXZhaWxhYmxlS2V5cykpO1xuICAgICAgICAgICAgaWYgKG1pc3NpbmdLZXlzLnNpemUgPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgZm9sbG93aW5nIG91dHB1dCB2YXJpYWJsZXMgd2VyZSBleHBlY3RlZCB0byBiZSBpbiB0aGUgZmluYWwgY2hhaW4gb3V0cHV0IGJ1dCB3ZXJlIG5vdCBmb3VuZDogJHtmb3JtYXRTZXQobWlzc2luZ0tleXMpfS5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKiogQGlnbm9yZSAqL1xuICAgIGFzeW5jIF9jYWxsKHZhbHVlcywgcnVuTWFuYWdlcikge1xuICAgICAgICBsZXQgaW5wdXQgPSB7fTtcbiAgICAgICAgY29uc3QgYWxsQ2hhaW5WYWx1ZXMgPSB2YWx1ZXM7XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBjaGFpbiBvZiB0aGlzLmNoYWlucykge1xuICAgICAgICAgICAgaSArPSAxO1xuICAgICAgICAgICAgaW5wdXQgPSBhd2FpdCBjaGFpbi5jYWxsKGFsbENoYWluVmFsdWVzLCBydW5NYW5hZ2VyPy5nZXRDaGlsZChgc3RlcF8ke2l9YCkpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgYWxsQ2hhaW5WYWx1ZXNba2V5XSA9IGlucHV0W2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb3V0cHV0ID0ge307XG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIHRoaXMub3V0cHV0VmFyaWFibGVzKSB7XG4gICAgICAgICAgICBvdXRwdXRba2V5XSA9IGFsbENoYWluVmFsdWVzW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgX2NoYWluVHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIFwic2VxdWVudGlhbF9jaGFpblwiO1xuICAgIH1cbiAgICBzdGF0aWMgYXN5bmMgZGVzZXJpYWxpemUoZGF0YSkge1xuICAgICAgICBjb25zdCBjaGFpbnMgPSBbXTtcbiAgICAgICAgY29uc3QgaW5wdXRWYXJpYWJsZXMgPSBkYXRhLmlucHV0X3ZhcmlhYmxlcztcbiAgICAgICAgY29uc3Qgb3V0cHV0VmFyaWFibGVzID0gZGF0YS5vdXRwdXRfdmFyaWFibGVzO1xuICAgICAgICBjb25zdCBzZXJpYWxpemVkQ2hhaW5zID0gZGF0YS5jaGFpbnM7XG4gICAgICAgIGZvciAoY29uc3Qgc2VyaWFsaXplZENoYWluIG9mIHNlcmlhbGl6ZWRDaGFpbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlc2VyaWFsaXplZENoYWluID0gYXdhaXQgQmFzZUNoYWluLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRDaGFpbik7XG4gICAgICAgICAgICBjaGFpbnMucHVzaChkZXNlcmlhbGl6ZWRDaGFpbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBTZXF1ZW50aWFsQ2hhaW4oeyBjaGFpbnMsIGlucHV0VmFyaWFibGVzLCBvdXRwdXRWYXJpYWJsZXMgfSk7XG4gICAgfVxuICAgIHNlcmlhbGl6ZSgpIHtcbiAgICAgICAgY29uc3QgY2hhaW5zID0gW107XG4gICAgICAgIGZvciAoY29uc3QgY2hhaW4gb2YgdGhpcy5jaGFpbnMpIHtcbiAgICAgICAgICAgIGNoYWlucy5wdXNoKGNoYWluLnNlcmlhbGl6ZSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgX3R5cGU6IHRoaXMuX2NoYWluVHlwZSgpLFxuICAgICAgICAgICAgaW5wdXRfdmFyaWFibGVzOiB0aGlzLmlucHV0VmFyaWFibGVzLFxuICAgICAgICAgICAgb3V0cHV0X3ZhcmlhYmxlczogdGhpcy5vdXRwdXRWYXJpYWJsZXMsXG4gICAgICAgICAgICBjaGFpbnMsXG4gICAgICAgIH07XG4gICAgfVxufVxuLyoqXG4gKiBAZGVwcmVjYXRlZCBTd2l0Y2ggdG8gZXhwcmVzc2lvbiBsYW5ndWFnZTogaHR0cHM6Ly9qcy5sYW5nY2hhaW4uY29tL2RvY3MvZXhwcmVzc2lvbl9sYW5ndWFnZS9cbiAqIFNpbXBsZSBjaGFpbiB3aGVyZSBhIHNpbmdsZSBzdHJpbmcgb3V0cHV0IG9mIG9uZSBjaGFpbiBpcyBmZWQgZGlyZWN0bHkgaW50byB0aGUgbmV4dC5cbiAqIEBhdWdtZW50cyBCYXNlQ2hhaW5cbiAqIEBhdWdtZW50cyBTaW1wbGVTZXF1ZW50aWFsQ2hhaW5JbnB1dFxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogaW1wb3J0IHsgU2ltcGxlU2VxdWVudGlhbENoYWluLCBMTE1DaGFpbiB9IGZyb20gXCJsYW5nY2hhaW4vY2hhaW5zXCI7XG4gKiBpbXBvcnQgeyBPcGVuQUkgfSBmcm9tIFwibGFuZ2NoYWluL2xsbXMvb3BlbmFpXCI7XG4gKiBpbXBvcnQgeyBQcm9tcHRUZW1wbGF0ZSB9IGZyb20gXCJsYW5nY2hhaW4vcHJvbXB0c1wiO1xuICpcbiAqIC8vIFRoaXMgaXMgYW4gTExNQ2hhaW4gdG8gd3JpdGUgYSBzeW5vcHNpcyBnaXZlbiBhIHRpdGxlIG9mIGEgcGxheS5cbiAqIGNvbnN0IGxsbSA9IG5ldyBPcGVuQUkoeyB0ZW1wZXJhdHVyZTogMCB9KTtcbiAqIGNvbnN0IHRlbXBsYXRlID0gYFlvdSBhcmUgYSBwbGF5d3JpZ2h0LiBHaXZlbiB0aGUgdGl0bGUgb2YgcGxheSwgaXQgaXMgeW91ciBqb2IgdG8gd3JpdGUgYSBzeW5vcHNpcyBmb3IgdGhhdCB0aXRsZS5cbiAqXG4gKiBUaXRsZToge3RpdGxlfVxuICogUGxheXdyaWdodDogVGhpcyBpcyBhIHN5bm9wc2lzIGZvciB0aGUgYWJvdmUgcGxheTpgXG4gKiBjb25zdCBwcm9tcHRUZW1wbGF0ZSA9IG5ldyBQcm9tcHRUZW1wbGF0ZSh7IHRlbXBsYXRlLCBpbnB1dFZhcmlhYmxlczogW1widGl0bGVcIl0gfSk7XG4gKiBjb25zdCBzeW5vcHNpc0NoYWluID0gbmV3IExMTUNoYWluKHsgbGxtLCBwcm9tcHQ6IHByb21wdFRlbXBsYXRlIH0pO1xuICpcbiAqXG4gKiAvLyBUaGlzIGlzIGFuIExMTUNoYWluIHRvIHdyaXRlIGEgcmV2aWV3IG9mIGEgcGxheSBnaXZlbiBhIHN5bm9wc2lzLlxuICogY29uc3QgcmV2aWV3TExNID0gbmV3IE9wZW5BSSh7IHRlbXBlcmF0dXJlOiAwIH0pXG4gKiBjb25zdCByZXZpZXdUZW1wbGF0ZSA9IGBZb3UgYXJlIGEgcGxheSBjcml0aWMgZnJvbSB0aGUgTmV3IFlvcmsgVGltZXMuIEdpdmVuIHRoZSBzeW5vcHNpcyBvZiBwbGF5LCBpdCBpcyB5b3VyIGpvYiB0byB3cml0ZSBhIHJldmlldyBmb3IgdGhhdCBwbGF5LlxuICpcbiAqIFBsYXkgU3lub3BzaXM6XG4gKiB7c3lub3BzaXN9XG4gKiBSZXZpZXcgZnJvbSBhIE5ldyBZb3JrIFRpbWVzIHBsYXkgY3JpdGljIG9mIHRoZSBhYm92ZSBwbGF5OmBcbiAqIGNvbnN0IHJldmlld1Byb21wdFRlbXBsYXRlID0gbmV3IFByb21wdFRlbXBsYXRlKHsgdGVtcGxhdGU6IHJldmlld1RlbXBsYXRlLCBpbnB1dFZhcmlhYmxlczogW1wic3lub3BzaXNcIl0gfSk7XG4gKiBjb25zdCByZXZpZXdDaGFpbiA9IG5ldyBMTE1DaGFpbih7IGxsbTogcmV2aWV3TExNLCBwcm9tcHQ6IHJldmlld1Byb21wdFRlbXBsYXRlIH0pO1xuICpcbiAqIGNvbnN0IG92ZXJhbGxDaGFpbiA9IG5ldyBTaW1wbGVTZXF1ZW50aWFsQ2hhaW4oe2NoYWluczogW3N5bm9wc2lzQ2hhaW4sIHJldmlld0NoYWluXSwgdmVyYm9zZTp0cnVlfSlcbiAqIGNvbnN0IHJldmlldyA9IGF3YWl0IG92ZXJhbGxDaGFpbi5ydW4oXCJUcmFnZWR5IGF0IHN1bnNldCBvbiB0aGUgYmVhY2hcIilcbiAqIC8vIHRoZSB2YXJpYWJsZSByZXZpZXcgY29udGFpbnMgcmVzdWx0aW5nIHBsYXkgcmV2aWV3LlxuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBTaW1wbGVTZXF1ZW50aWFsQ2hhaW4gZXh0ZW5kcyBCYXNlQ2hhaW4ge1xuICAgIHN0YXRpYyBsY19uYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJTaW1wbGVTZXF1ZW50aWFsQ2hhaW5cIjtcbiAgICB9XG4gICAgZ2V0IGlucHV0S2V5cygpIHtcbiAgICAgICAgcmV0dXJuIFt0aGlzLmlucHV0S2V5XTtcbiAgICB9XG4gICAgZ2V0IG91dHB1dEtleXMoKSB7XG4gICAgICAgIHJldHVybiBbdGhpcy5vdXRwdXRLZXldO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihmaWVsZHMpIHtcbiAgICAgICAgc3VwZXIoZmllbGRzKTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiY2hhaW5zXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImlucHV0S2V5XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBcImlucHV0XCJcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm91dHB1dEtleVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogXCJvdXRwdXRcIlxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwidHJpbU91dHB1dHNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jaGFpbnMgPSBmaWVsZHMuY2hhaW5zO1xuICAgICAgICB0aGlzLnRyaW1PdXRwdXRzID0gZmllbGRzLnRyaW1PdXRwdXRzID8/IGZhbHNlO1xuICAgICAgICB0aGlzLl92YWxpZGF0ZUNoYWlucygpO1xuICAgIH1cbiAgICAvKiogQGlnbm9yZSAqL1xuICAgIF92YWxpZGF0ZUNoYWlucygpIHtcbiAgICAgICAgZm9yIChjb25zdCBjaGFpbiBvZiB0aGlzLmNoYWlucykge1xuICAgICAgICAgICAgaWYgKGNoYWluLmlucHV0S2V5cy5maWx0ZXIoKGspID0+ICFjaGFpbi5tZW1vcnk/Lm1lbW9yeUtleXMuaW5jbHVkZXMoaykgPz8gdHJ1ZSkubGVuZ3RoICE9PSAxKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDaGFpbnMgdXNlZCBpbiBTaW1wbGVTZXF1ZW50aWFsQ2hhaW4gc2hvdWxkIGFsbCBoYXZlIG9uZSBpbnB1dCwgZ290ICR7Y2hhaW4uaW5wdXRLZXlzLmxlbmd0aH0gZm9yICR7Y2hhaW4uX2NoYWluVHlwZSgpfS5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjaGFpbi5vdXRwdXRLZXlzLmxlbmd0aCAhPT0gMSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2hhaW5zIHVzZWQgaW4gU2ltcGxlU2VxdWVudGlhbENoYWluIHNob3VsZCBhbGwgaGF2ZSBvbmUgb3V0cHV0LCBnb3QgJHtjaGFpbi5vdXRwdXRLZXlzLmxlbmd0aH0gZm9yICR7Y2hhaW4uX2NoYWluVHlwZSgpfS5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKiogQGlnbm9yZSAqL1xuICAgIGFzeW5jIF9jYWxsKHZhbHVlcywgcnVuTWFuYWdlcikge1xuICAgICAgICBsZXQgaW5wdXQgPSB2YWx1ZXNbdGhpcy5pbnB1dEtleV07XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBjaGFpbiBvZiB0aGlzLmNoYWlucykge1xuICAgICAgICAgICAgaSArPSAxO1xuICAgICAgICAgICAgaW5wdXQgPSAoYXdhaXQgY2hhaW4uY2FsbCh7IFtjaGFpbi5pbnB1dEtleXNbMF1dOiBpbnB1dCwgc2lnbmFsOiB2YWx1ZXMuc2lnbmFsIH0sIHJ1bk1hbmFnZXI/LmdldENoaWxkKGBzdGVwXyR7aX1gKSkpW2NoYWluLm91dHB1dEtleXNbMF1dO1xuICAgICAgICAgICAgaWYgKHRoaXMudHJpbU91dHB1dHMpIHtcbiAgICAgICAgICAgICAgICBpbnB1dCA9IGlucHV0LnRyaW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHJ1bk1hbmFnZXI/LmhhbmRsZVRleHQoaW5wdXQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IFt0aGlzLm91dHB1dEtleV06IGlucHV0IH07XG4gICAgfVxuICAgIF9jaGFpblR5cGUoKSB7XG4gICAgICAgIHJldHVybiBcInNpbXBsZV9zZXF1ZW50aWFsX2NoYWluXCI7XG4gICAgfVxuICAgIHN0YXRpYyBhc3luYyBkZXNlcmlhbGl6ZShkYXRhKSB7XG4gICAgICAgIGNvbnN0IGNoYWlucyA9IFtdO1xuICAgICAgICBjb25zdCBzZXJpYWxpemVkQ2hhaW5zID0gZGF0YS5jaGFpbnM7XG4gICAgICAgIGZvciAoY29uc3Qgc2VyaWFsaXplZENoYWluIG9mIHNlcmlhbGl6ZWRDaGFpbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlc2VyaWFsaXplZENoYWluID0gYXdhaXQgQmFzZUNoYWluLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRDaGFpbik7XG4gICAgICAgICAgICBjaGFpbnMucHVzaChkZXNlcmlhbGl6ZWRDaGFpbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBTaW1wbGVTZXF1ZW50aWFsQ2hhaW4oeyBjaGFpbnMgfSk7XG4gICAgfVxuICAgIHNlcmlhbGl6ZSgpIHtcbiAgICAgICAgY29uc3QgY2hhaW5zID0gW107XG4gICAgICAgIGZvciAoY29uc3QgY2hhaW4gb2YgdGhpcy5jaGFpbnMpIHtcbiAgICAgICAgICAgIGNoYWlucy5wdXNoKGNoYWluLnNlcmlhbGl6ZSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgX3R5cGU6IHRoaXMuX2NoYWluVHlwZSgpLFxuICAgICAgICAgICAgY2hhaW5zLFxuICAgICAgICB9O1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/chains/sequential_chain.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/chains/vector_db_qa.js":
/*!************************************************************!*\
  !*** ./node_modules/langchain/dist/chains/vector_db_qa.js ***!
  \************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VectorDBQAChain: () => (/* binding */ VectorDBQAChain)\n/* harmony export */ });\n/* harmony import */ var _base_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base.js */ \"(rsc)/./node_modules/langchain/dist/chains/base.js\");\n/* harmony import */ var _question_answering_load_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./question_answering/load.js */ \"(rsc)/./node_modules/langchain/dist/chains/question_answering/load.js\");\n\n\n/**\n * Class that represents a VectorDBQAChain. It extends the `BaseChain`\n * class and implements the `VectorDBQAChainInput` interface. It performs\n * a similarity search using a vector store and combines the search\n * results using a specified combine documents chain.\n *\n * @deprecated\n * Switch to {@link https://js.langchain.com/docs/modules/chains/ | createRetrievalChain}\n * Will be removed in 0.2.0\n */\nclass VectorDBQAChain extends _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain {\n    static lc_name() {\n        return \"VectorDBQAChain\";\n    }\n    get inputKeys() {\n        return [this.inputKey];\n    }\n    get outputKeys() {\n        return this.combineDocumentsChain.outputKeys.concat(this.returnSourceDocuments ? [\"sourceDocuments\"] : []);\n    }\n    constructor(fields) {\n        super(fields);\n        Object.defineProperty(this, \"k\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 4\n        });\n        Object.defineProperty(this, \"inputKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"query\"\n        });\n        Object.defineProperty(this, \"vectorstore\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"combineDocumentsChain\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"returnSourceDocuments\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        this.vectorstore = fields.vectorstore;\n        this.combineDocumentsChain = fields.combineDocumentsChain;\n        this.inputKey = fields.inputKey ?? this.inputKey;\n        this.k = fields.k ?? this.k;\n        this.returnSourceDocuments =\n            fields.returnSourceDocuments ?? this.returnSourceDocuments;\n    }\n    /** @ignore */\n    async _call(values, runManager) {\n        if (!(this.inputKey in values)) {\n            throw new Error(`Question key ${this.inputKey} not found.`);\n        }\n        const question = values[this.inputKey];\n        const docs = await this.vectorstore.similaritySearch(question, this.k, values.filter, runManager?.getChild(\"vectorstore\"));\n        const inputs = { question, input_documents: docs };\n        const result = await this.combineDocumentsChain.call(inputs, runManager?.getChild(\"combine_documents\"));\n        if (this.returnSourceDocuments) {\n            return {\n                ...result,\n                sourceDocuments: docs,\n            };\n        }\n        return result;\n    }\n    _chainType() {\n        return \"vector_db_qa\";\n    }\n    static async deserialize(data, values) {\n        if (!(\"vectorstore\" in values)) {\n            throw new Error(`Need to pass in a vectorstore to deserialize VectorDBQAChain`);\n        }\n        const { vectorstore } = values;\n        if (!data.combine_documents_chain) {\n            throw new Error(`VectorDBQAChain must have combine_documents_chain in serialized data`);\n        }\n        return new VectorDBQAChain({\n            combineDocumentsChain: await _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain.deserialize(data.combine_documents_chain),\n            k: data.k,\n            vectorstore,\n        });\n    }\n    serialize() {\n        return {\n            _type: this._chainType(),\n            combine_documents_chain: this.combineDocumentsChain.serialize(),\n            k: this.k,\n        };\n    }\n    /**\n     * Static method that creates a VectorDBQAChain instance from a\n     * BaseLanguageModel and a vector store. It also accepts optional options\n     * to customize the chain.\n     * @param llm The BaseLanguageModel instance.\n     * @param vectorstore The vector store used for similarity search.\n     * @param options Optional options to customize the chain.\n     * @returns A new instance of VectorDBQAChain.\n     */\n    static fromLLM(llm, vectorstore, options) {\n        const qaChain = (0,_question_answering_load_js__WEBPACK_IMPORTED_MODULE_1__.loadQAStuffChain)(llm);\n        return new this({\n            vectorstore,\n            combineDocumentsChain: qaChain,\n            ...options,\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL3ZlY3Rvcl9kYl9xYS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBc0M7QUFDMEI7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNPLDhCQUE4QiwrQ0FBUztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLGVBQWU7QUFDM0Q7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGNBQWM7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsK0NBQVM7QUFDbEQ7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkVBQWdCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1jb21wYW5pb24vLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL3ZlY3Rvcl9kYl9xYS5qcz8yZTg4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJhc2VDaGFpbiB9IGZyb20gXCIuL2Jhc2UuanNcIjtcbmltcG9ydCB7IGxvYWRRQVN0dWZmQ2hhaW4gfSBmcm9tIFwiLi9xdWVzdGlvbl9hbnN3ZXJpbmcvbG9hZC5qc1wiO1xuLyoqXG4gKiBDbGFzcyB0aGF0IHJlcHJlc2VudHMgYSBWZWN0b3JEQlFBQ2hhaW4uIEl0IGV4dGVuZHMgdGhlIGBCYXNlQ2hhaW5gXG4gKiBjbGFzcyBhbmQgaW1wbGVtZW50cyB0aGUgYFZlY3RvckRCUUFDaGFpbklucHV0YCBpbnRlcmZhY2UuIEl0IHBlcmZvcm1zXG4gKiBhIHNpbWlsYXJpdHkgc2VhcmNoIHVzaW5nIGEgdmVjdG9yIHN0b3JlIGFuZCBjb21iaW5lcyB0aGUgc2VhcmNoXG4gKiByZXN1bHRzIHVzaW5nIGEgc3BlY2lmaWVkIGNvbWJpbmUgZG9jdW1lbnRzIGNoYWluLlxuICpcbiAqIEBkZXByZWNhdGVkXG4gKiBTd2l0Y2ggdG8ge0BsaW5rIGh0dHBzOi8vanMubGFuZ2NoYWluLmNvbS9kb2NzL21vZHVsZXMvY2hhaW5zLyB8IGNyZWF0ZVJldHJpZXZhbENoYWlufVxuICogV2lsbCBiZSByZW1vdmVkIGluIDAuMi4wXG4gKi9cbmV4cG9ydCBjbGFzcyBWZWN0b3JEQlFBQ2hhaW4gZXh0ZW5kcyBCYXNlQ2hhaW4ge1xuICAgIHN0YXRpYyBsY19uYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJWZWN0b3JEQlFBQ2hhaW5cIjtcbiAgICB9XG4gICAgZ2V0IGlucHV0S2V5cygpIHtcbiAgICAgICAgcmV0dXJuIFt0aGlzLmlucHV0S2V5XTtcbiAgICB9XG4gICAgZ2V0IG91dHB1dEtleXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbWJpbmVEb2N1bWVudHNDaGFpbi5vdXRwdXRLZXlzLmNvbmNhdCh0aGlzLnJldHVyblNvdXJjZURvY3VtZW50cyA/IFtcInNvdXJjZURvY3VtZW50c1wiXSA6IFtdKTtcbiAgICB9XG4gICAgY29uc3RydWN0b3IoZmllbGRzKSB7XG4gICAgICAgIHN1cGVyKGZpZWxkcyk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImtcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IDRcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImlucHV0S2V5XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBcInF1ZXJ5XCJcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInZlY3RvcnN0b3JlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNvbWJpbmVEb2N1bWVudHNDaGFpblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJyZXR1cm5Tb3VyY2VEb2N1bWVudHNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnZlY3RvcnN0b3JlID0gZmllbGRzLnZlY3RvcnN0b3JlO1xuICAgICAgICB0aGlzLmNvbWJpbmVEb2N1bWVudHNDaGFpbiA9IGZpZWxkcy5jb21iaW5lRG9jdW1lbnRzQ2hhaW47XG4gICAgICAgIHRoaXMuaW5wdXRLZXkgPSBmaWVsZHMuaW5wdXRLZXkgPz8gdGhpcy5pbnB1dEtleTtcbiAgICAgICAgdGhpcy5rID0gZmllbGRzLmsgPz8gdGhpcy5rO1xuICAgICAgICB0aGlzLnJldHVyblNvdXJjZURvY3VtZW50cyA9XG4gICAgICAgICAgICBmaWVsZHMucmV0dXJuU291cmNlRG9jdW1lbnRzID8/IHRoaXMucmV0dXJuU291cmNlRG9jdW1lbnRzO1xuICAgIH1cbiAgICAvKiogQGlnbm9yZSAqL1xuICAgIGFzeW5jIF9jYWxsKHZhbHVlcywgcnVuTWFuYWdlcikge1xuICAgICAgICBpZiAoISh0aGlzLmlucHV0S2V5IGluIHZhbHVlcykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgUXVlc3Rpb24ga2V5ICR7dGhpcy5pbnB1dEtleX0gbm90IGZvdW5kLmApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHF1ZXN0aW9uID0gdmFsdWVzW3RoaXMuaW5wdXRLZXldO1xuICAgICAgICBjb25zdCBkb2NzID0gYXdhaXQgdGhpcy52ZWN0b3JzdG9yZS5zaW1pbGFyaXR5U2VhcmNoKHF1ZXN0aW9uLCB0aGlzLmssIHZhbHVlcy5maWx0ZXIsIHJ1bk1hbmFnZXI/LmdldENoaWxkKFwidmVjdG9yc3RvcmVcIikpO1xuICAgICAgICBjb25zdCBpbnB1dHMgPSB7IHF1ZXN0aW9uLCBpbnB1dF9kb2N1bWVudHM6IGRvY3MgfTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jb21iaW5lRG9jdW1lbnRzQ2hhaW4uY2FsbChpbnB1dHMsIHJ1bk1hbmFnZXI/LmdldENoaWxkKFwiY29tYmluZV9kb2N1bWVudHNcIikpO1xuICAgICAgICBpZiAodGhpcy5yZXR1cm5Tb3VyY2VEb2N1bWVudHMpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgLi4ucmVzdWx0LFxuICAgICAgICAgICAgICAgIHNvdXJjZURvY3VtZW50czogZG9jcyxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgX2NoYWluVHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIFwidmVjdG9yX2RiX3FhXCI7XG4gICAgfVxuICAgIHN0YXRpYyBhc3luYyBkZXNlcmlhbGl6ZShkYXRhLCB2YWx1ZXMpIHtcbiAgICAgICAgaWYgKCEoXCJ2ZWN0b3JzdG9yZVwiIGluIHZhbHVlcykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTmVlZCB0byBwYXNzIGluIGEgdmVjdG9yc3RvcmUgdG8gZGVzZXJpYWxpemUgVmVjdG9yREJRQUNoYWluYCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyB2ZWN0b3JzdG9yZSB9ID0gdmFsdWVzO1xuICAgICAgICBpZiAoIWRhdGEuY29tYmluZV9kb2N1bWVudHNfY2hhaW4pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVmVjdG9yREJRQUNoYWluIG11c3QgaGF2ZSBjb21iaW5lX2RvY3VtZW50c19jaGFpbiBpbiBzZXJpYWxpemVkIGRhdGFgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFZlY3RvckRCUUFDaGFpbih7XG4gICAgICAgICAgICBjb21iaW5lRG9jdW1lbnRzQ2hhaW46IGF3YWl0IEJhc2VDaGFpbi5kZXNlcmlhbGl6ZShkYXRhLmNvbWJpbmVfZG9jdW1lbnRzX2NoYWluKSxcbiAgICAgICAgICAgIGs6IGRhdGEuayxcbiAgICAgICAgICAgIHZlY3RvcnN0b3JlLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VyaWFsaXplKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgX3R5cGU6IHRoaXMuX2NoYWluVHlwZSgpLFxuICAgICAgICAgICAgY29tYmluZV9kb2N1bWVudHNfY2hhaW46IHRoaXMuY29tYmluZURvY3VtZW50c0NoYWluLnNlcmlhbGl6ZSgpLFxuICAgICAgICAgICAgazogdGhpcy5rLFxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGF0aWMgbWV0aG9kIHRoYXQgY3JlYXRlcyBhIFZlY3RvckRCUUFDaGFpbiBpbnN0YW5jZSBmcm9tIGFcbiAgICAgKiBCYXNlTGFuZ3VhZ2VNb2RlbCBhbmQgYSB2ZWN0b3Igc3RvcmUuIEl0IGFsc28gYWNjZXB0cyBvcHRpb25hbCBvcHRpb25zXG4gICAgICogdG8gY3VzdG9taXplIHRoZSBjaGFpbi5cbiAgICAgKiBAcGFyYW0gbGxtIFRoZSBCYXNlTGFuZ3VhZ2VNb2RlbCBpbnN0YW5jZS5cbiAgICAgKiBAcGFyYW0gdmVjdG9yc3RvcmUgVGhlIHZlY3RvciBzdG9yZSB1c2VkIGZvciBzaW1pbGFyaXR5IHNlYXJjaC5cbiAgICAgKiBAcGFyYW0gb3B0aW9ucyBPcHRpb25hbCBvcHRpb25zIHRvIGN1c3RvbWl6ZSB0aGUgY2hhaW4uXG4gICAgICogQHJldHVybnMgQSBuZXcgaW5zdGFuY2Ugb2YgVmVjdG9yREJRQUNoYWluLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tTExNKGxsbSwgdmVjdG9yc3RvcmUsIG9wdGlvbnMpIHtcbiAgICAgICAgY29uc3QgcWFDaGFpbiA9IGxvYWRRQVN0dWZmQ2hhaW4obGxtKTtcbiAgICAgICAgcmV0dXJuIG5ldyB0aGlzKHtcbiAgICAgICAgICAgIHZlY3RvcnN0b3JlLFxuICAgICAgICAgICAgY29tYmluZURvY3VtZW50c0NoYWluOiBxYUNoYWluLFxuICAgICAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/chains/vector_db_qa.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/experimental/generative_agents/generative_agent.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/langchain/dist/experimental/generative_agents/generative_agent.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GenerativeAgent: () => (/* binding */ GenerativeAgent)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/prompts */ \"(rsc)/./node_modules/@langchain/core/prompts.js\");\n/* harmony import */ var _chains_llm_chain_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../chains/llm_chain.js */ \"(rsc)/./node_modules/langchain/dist/chains/llm_chain.js\");\n/* harmony import */ var _chains_base_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../chains/base.js */ \"(rsc)/./node_modules/langchain/dist/chains/base.js\");\n\n\n\n/**\n * Implementation of a generative agent that can learn and form new memories over\n * time. It extends the BaseChain class, which is a generic\n * sequence of calls to components, including other chains.\n * @example\n * ```typescript\n * const tommie: GenerativeAgent = new GenerativeAgent(\n *   new OpenAI({ temperature: 0.9, maxTokens: 1500 }),\n *   new GenerativeAgentMemory(\n *     new ChatOpenAI(),\n *     new TimeWeightedVectorStoreRetriever({\n *       vectorStore: new MemoryVectorStore(new OpenAIEmbeddings()),\n *       otherScoreKeys: [\"importance\"],\n *       k: 15,\n *     }),\n *     { reflectionThreshold: 8 },\n *   ),\n *   {\n *     name: \"Tommie\",\n *     age: 25,\n *     traits: \"anxious, likes design, talkative\",\n *     status: \"looking for a job\",\n *   },\n * );\n *\n * await tommie.addMemory(\n *   \"Tommie remembers his dog, Bruno, from when he was a kid\",\n *   new Date(),\n * );\n * const summary = await tommie.getSummary({ forceRefresh: true });\n * const response = await tommie.generateDialogueResponse(\n *   \"USER says Hello Tommie, how are you today?\",\n * );\n * ```\n */\nclass GenerativeAgent extends _chains_base_js__WEBPACK_IMPORTED_MODULE_2__.BaseChain {\n    static lc_name() {\n        return \"GenerativeAgent\";\n    }\n    // TODO: Add support for daily summaries\n    // private dailySummaries: string[] = []; // summary of the events in the plan that the agent took.\n    _chainType() {\n        return \"generative_agent_executor\";\n    }\n    get inputKeys() {\n        return [\"observation\", \"suffix\", \"now\"];\n    }\n    get outputKeys() {\n        return [\"output\", \"continue_dialogue\"];\n    }\n    constructor(llm, longTermMemory, config) {\n        super();\n        // a character with memory and innate characterisitics\n        Object.defineProperty(this, \"name\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        }); // the character's name\n        Object.defineProperty(this, \"age\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        }); // the optional age of the character\n        Object.defineProperty(this, \"traits\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        }); // permanent traits to ascribe to the character\n        Object.defineProperty(this, \"status\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        }); // the traits of the character you wish not to change\n        Object.defineProperty(this, \"longTermMemory\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"llm\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        }); // the underlying language model\n        Object.defineProperty(this, \"verbose\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        }); // false\n        Object.defineProperty(this, \"summary\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        }); // stateful self-summary generated via reflection on the character's memory.\n        Object.defineProperty(this, \"summaryRefreshSeconds\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 3600\n        });\n        Object.defineProperty(this, \"lastRefreshed\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        }); // the last time the character's summary was regenerated\n        this.llm = llm;\n        this.longTermMemory = longTermMemory;\n        this.name = config.name;\n        this.age = config.age;\n        this.traits = config.traits;\n        this.status = config.status;\n        this.verbose = config.verbose ?? this.verbose;\n        this.summary = \"\";\n        this.summaryRefreshSeconds =\n            config.summaryRefreshSeconds ?? this.summaryRefreshSeconds;\n        this.lastRefreshed = new Date();\n        // this.dailySummaries = config.dailySummaries ?? this.dailySummaries;\n    }\n    // LLM methods\n    /**\n     * Parses a newline-separated string into a list of strings.\n     * @param text The string to parse.\n     * @returns An array of strings parsed from the input text.\n     */\n    parseList(text) {\n        // parse a newline-seperated string into a list of strings\n        const lines = text.trim().split(\"\\n\");\n        const result = lines.map((line) => line.replace(/^\\s*\\d+\\.\\s*/, \"\").trim());\n        return result;\n    }\n    /**\n     * Creates a new LLMChain with the given prompt and the agent's language\n     * model, verbosity, output key, and memory.\n     * @param prompt The prompt to use for the LLMChain.\n     * @returns A new LLMChain instance.\n     */\n    chain(prompt) {\n        const chain = new _chains_llm_chain_js__WEBPACK_IMPORTED_MODULE_1__.LLMChain({\n            llm: this.llm,\n            prompt,\n            verbose: this.verbose,\n            outputKey: \"output\",\n            memory: this.longTermMemory,\n        });\n        return chain;\n    }\n    /**\n     * Extracts the observed entity from the given observation.\n     * @param observation The observation to extract the entity from.\n     * @param runManager Optional CallbackManagerForChainRun instance.\n     * @returns The extracted entity as a string.\n     */\n    async getEntityFromObservations(observation, runManager) {\n        const prompt = _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate.fromTemplate(\"What is the observed entity in the following observation? {observation}\" +\n            \"\\nEntity=\");\n        const result = await this.chain(prompt).call({\n            observation,\n        }, runManager?.getChild(\"entity_extractor\"));\n        return result.output;\n    }\n    /**\n     * Extracts the action of the given entity from the given observation.\n     * @param observation The observation to extract the action from.\n     * @param entityName The name of the entity to extract the action for.\n     * @param runManager Optional CallbackManagerForChainRun instance.\n     * @returns The extracted action as a string.\n     */\n    async getEntityAction(observation, entityName, runManager) {\n        const prompt = _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate.fromTemplate(\"What is the {entity} doing in the following observation? {observation}\" +\n            \"\\nThe {entity} is\");\n        const result = await this.chain(prompt).call({\n            entity: entityName,\n            observation,\n        }, runManager?.getChild(\"entity_action_extractor\"));\n        const trimmedResult = result.output.trim();\n        return trimmedResult;\n    }\n    /**\n     * Summarizes memories that are most relevant to an observation.\n     * @param observation The observation to summarize related memories for.\n     * @param runManager Optional CallbackManagerForChainRun instance.\n     * @returns The summarized memories as a string.\n     */\n    async summarizeRelatedMemories(observation, runManager) {\n        // summarize memories that are most relevant to an observation\n        const prompt = _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate.fromTemplate(`\n{q1}?\nContext from memory:\n{relevant_memories}\nRelevant context:`);\n        const entityName = await this.getEntityFromObservations(observation, runManager);\n        const entityAction = await this.getEntityAction(observation, entityName, runManager);\n        const q1 = `What is the relationship between ${this.name} and ${entityName}`;\n        const q2 = `${entityName} is ${entityAction}`;\n        const response = await this.chain(prompt).call({\n            q1,\n            queries: [q1, q2],\n        }, runManager?.getChild(\"entity_relationships\"));\n        return response.output.trim(); // added output\n    }\n    async _call(values, runManager) {\n        const { observation, suffix, now } = values;\n        // react to a given observation or dialogue act\n        const prompt = _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate.fromTemplate(`{agent_summary_description}` +\n            `\\nIt is {current_time}.` +\n            `\\n{agent_name}'s status: {agent_status}` +\n            `\\nSummary of relevant context from {agent_name}'s memory:` +\n            \"\\n{relevant_memories}\" +\n            `\\nMost recent observations: {most_recent_memories}` +\n            `\\nObservation: {observation}` +\n            `\\n\\n${suffix}`);\n        const agentSummaryDescription = await this.getSummary({}, runManager); // now = now in param\n        const relevantMemoriesStr = await this.summarizeRelatedMemories(observation, runManager);\n        const currentTime = (now || new Date()).toLocaleString(\"en-US\", {\n            month: \"long\",\n            day: \"numeric\",\n            year: \"numeric\",\n            hour: \"numeric\",\n            minute: \"numeric\",\n            hour12: true,\n        });\n        const chainInputs = {\n            agent_summary_description: agentSummaryDescription,\n            current_time: currentTime,\n            agent_name: this.name,\n            observation,\n            agent_status: this.status,\n            most_recent_memories: \"\",\n        };\n        chainInputs[this.longTermMemory.getRelevantMemoriesKey()] =\n            relevantMemoriesStr;\n        const consumedTokens = await this.llm.getNumTokens(await prompt.format({ ...chainInputs }));\n        chainInputs[this.longTermMemory.getMostRecentMemoriesTokenKey()] =\n            consumedTokens;\n        const response = await this.chain(prompt).call(chainInputs, runManager?.getChild(\"reaction_from_summary\"));\n        const rawOutput = response.output;\n        let output = rawOutput;\n        let continue_dialogue = false;\n        if (rawOutput.includes(\"REACT:\")) {\n            const reaction = this._cleanResponse(rawOutput.split(\"REACT:\").pop());\n            await this.addMemory(`${this.name} observed ${observation} and reacted by ${reaction}`, now, {}, runManager?.getChild(\"memory\"));\n            output = `${reaction}`;\n            continue_dialogue = false;\n        }\n        else if (rawOutput.includes(\"SAY:\")) {\n            const saidValue = this._cleanResponse(rawOutput.split(\"SAY:\").pop());\n            await this.addMemory(`${this.name} observed ${observation} and said ${saidValue}`, now, {}, runManager?.getChild(\"memory\"));\n            output = `${this.name} said ${saidValue}`;\n            continue_dialogue = true;\n        }\n        else if (rawOutput.includes(\"GOODBYE:\")) {\n            const farewell = this._cleanResponse(rawOutput.split(\"GOODBYE:\").pop() ?? \"\");\n            await this.addMemory(`${this.name} observed ${observation} and said ${farewell}`, now, {}, runManager?.getChild(\"memory\"));\n            output = `${this.name} said ${farewell}`;\n            continue_dialogue = false;\n        }\n        return { output, continue_dialogue };\n    }\n    _cleanResponse(text) {\n        if (text === undefined) {\n            return \"\";\n        }\n        const regex = new RegExp(`^${this.name} `);\n        return text.replace(regex, \"\").trim();\n    }\n    /**\n     * Generates a reaction to the given observation.\n     * @param observation The observation to generate a reaction for.\n     * @param now Optional current date.\n     * @returns A boolean indicating whether to continue the dialogue and the output string.\n     */\n    async generateReaction(observation, now) {\n        const callToActionTemplate = `Should {agent_name} react to the observation, and if so,` +\n            ` what would be an appropriate reaction? Respond in one line.` +\n            ` If the action is to engage in dialogue, write:\\nSAY: \"what to say\"` +\n            ` \\notherwise, write:\\nREACT: {agent_name}'s reaction (if anything).` +\n            ` \\nEither do nothing, react, or say something but not both.\\n\\n`;\n        const { output, continue_dialogue } = await this.call({\n            observation,\n            suffix: callToActionTemplate,\n            now,\n        });\n        return [continue_dialogue, output];\n    }\n    /**\n     * Generates a dialogue response to the given observation.\n     * @param observation The observation to generate a dialogue response for.\n     * @param now Optional current date.\n     * @returns A boolean indicating whether to continue the dialogue and the output string.\n     */\n    async generateDialogueResponse(observation, now) {\n        const callToActionTemplate = `What would ${this.name} say? To end the conversation, write: GOODBYE: \"what to say\". Otherwise to continue the conversation, write: SAY: \"what to say next\"\\n\\n`;\n        const { output, continue_dialogue } = await this.call({\n            observation,\n            suffix: callToActionTemplate,\n            now,\n        });\n        return [continue_dialogue, output];\n    }\n    // Agent stateful' summary methods\n    // Each dialog or response prompt includes a header\n    // summarizing the agent's self-description. This is\n    // updated periodically through probing it's memories\n    /**\n     * Gets the agent's summary, which includes the agent's name, age, traits,\n     * and a summary of the agent's core characteristics. The summary is\n     * updated periodically through probing the agent's memories.\n     * @param config Optional configuration object with current date and a boolean to force refresh.\n     * @param runManager Optional CallbackManagerForChainRun instance.\n     * @returns The agent's summary as a string.\n     */\n    async getSummary(config, runManager) {\n        const { now = new Date(), forceRefresh = false } = config ?? {};\n        const sinceRefresh = Math.floor((now.getTime() - this.lastRefreshed.getTime()) / 1000);\n        if (!this.summary ||\n            sinceRefresh >= this.summaryRefreshSeconds ||\n            forceRefresh) {\n            this.summary = await this.computeAgentSummary(runManager);\n            this.lastRefreshed = now;\n        }\n        let age;\n        if (this.age) {\n            age = this.age;\n        }\n        else {\n            age = \"N/A\";\n        }\n        return `Name: ${this.name} (age: ${age})\nInnate traits: ${this.traits}\n${this.summary}`;\n    }\n    /**\n     * Computes the agent's summary by summarizing the agent's core\n     * characteristics given the agent's relevant memories.\n     * @param runManager Optional CallbackManagerForChainRun instance.\n     * @returns The computed summary as a string.\n     */\n    async computeAgentSummary(runManager) {\n        const prompt = _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate.fromTemplate(\"How would you summarize {name}'s core characteristics given the following statements:\\n\" +\n            \"----------\" +\n            \"{relevant_memories}\" +\n            \"----------\" +\n            \"Do not embellish.\" +\n            \"\\n\\nSummary: \");\n        // the agent seeks to think about their core characterisitics\n        const result = await this.chain(prompt).call({\n            name: this.name,\n            queries: [`${this.name}'s core characteristics`],\n        }, runManager?.getChild(\"compute_agent_summary\"));\n        return result.output.trim();\n    }\n    /**\n     * Returns a full header of the agent's status, summary, and current time.\n     * @param config Optional configuration object with current date and a boolean to force refresh.\n     * @returns The full header as a string.\n     */\n    getFullHeader(config = {}) {\n        const { now = new Date(), forceRefresh = false } = config;\n        // return a full header of the agent's status, summary, and current time.\n        const summary = this.getSummary({ now, forceRefresh });\n        const currentTimeString = now.toLocaleString(\"en-US\", {\n            month: \"long\",\n            day: \"numeric\",\n            year: \"numeric\",\n            hour: \"numeric\",\n            minute: \"numeric\",\n            hour12: true,\n        });\n        return `${summary}\\nIt is ${currentTimeString}.\\n${this.name}'s status: ${this.status}`;\n    }\n    /**\n     * Adds a memory to the agent's long-term memory.\n     * @param memoryContent The content of the memory to add.\n     * @param now Optional current date.\n     * @param metadata Optional metadata for the memory.\n     * @param callbacks Optional Callbacks instance.\n     * @returns The result of adding the memory to the agent's long-term memory.\n     */\n    async addMemory(memoryContent, now, metadata, callbacks) {\n        return this.longTermMemory.addMemory(memoryContent, now, metadata, callbacks);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvZXhwZXJpbWVudGFsL2dlbmVyYXRpdmVfYWdlbnRzL2dlbmVyYXRpdmVfYWdlbnQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUF5RDtBQUNKO0FBQ0o7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsbUNBQW1DO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUixTQUFTLHdCQUF3QjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLG9CQUFvQjtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sOEJBQThCLHNEQUFTO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLEdBQUc7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxHQUFHO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsR0FBRztBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLEdBQUc7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLEdBQUc7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxHQUFHO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsR0FBRztBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsR0FBRztBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMERBQVE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsbUVBQWMsMEVBQTBFLFlBQVk7QUFDM0g7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLG1FQUFjLDRCQUE0QixRQUFRLHFDQUFxQyxZQUFZO0FBQzFILG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLG1FQUFjO0FBQ3JDLENBQUMsR0FBRztBQUNKO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCxXQUFXLE1BQU0sV0FBVztBQUNuRixzQkFBc0IsWUFBWSxLQUFLLGFBQWE7QUFDcEQ7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULHVDQUF1QztBQUN2QztBQUNBO0FBQ0EsZ0JBQWdCLDJCQUEyQjtBQUMzQztBQUNBLHVCQUF1QixtRUFBYyxnQkFBZ0IsMEJBQTBCO0FBQy9FLHNCQUFzQixhQUFhO0FBQ25DLGdCQUFnQixXQUFXLFlBQVksYUFBYTtBQUNwRCxpREFBaUQsV0FBVztBQUM1RCxnQkFBZ0Isa0JBQWtCO0FBQ2xDLDBDQUEwQyxxQkFBcUI7QUFDL0QsNkJBQTZCLFlBQVk7QUFDekMsbUJBQW1CLE9BQU87QUFDMUIsZ0VBQWdFLGVBQWU7QUFDL0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlGQUFpRixnQkFBZ0I7QUFDakc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxXQUFXLFdBQVcsYUFBYSxpQkFBaUIsU0FBUyxVQUFVO0FBQzNHLHdCQUF3QixTQUFTO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLFdBQVcsV0FBVyxhQUFhLFdBQVcsVUFBVSxVQUFVO0FBQ3RHLHdCQUF3QixXQUFXLE9BQU8sVUFBVTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxXQUFXLFdBQVcsYUFBYSxXQUFXLFNBQVMsVUFBVTtBQUNyRyx3QkFBd0IsV0FBVyxPQUFPLFNBQVM7QUFDbkQ7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLFdBQVc7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLFlBQVk7QUFDMUQ7QUFDQTtBQUNBLDJDQUEyQyxXQUFXO0FBQ3REO0FBQ0EsZ0JBQWdCLDRCQUE0QjtBQUM1QztBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELFdBQVc7QUFDOUQsZ0JBQWdCLDRCQUE0QjtBQUM1QztBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHlDQUF5QztBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFdBQVcsUUFBUSxJQUFJO0FBQy9DLGlCQUFpQjtBQUNqQixFQUFFLGFBQWE7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLG1FQUFjLHdDQUF3QyxLQUFLO0FBQ2xGO0FBQ0EsY0FBYyxrQkFBa0I7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLFVBQVU7QUFDbkMsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCLGdCQUFnQix5Q0FBeUM7QUFDekQ7QUFDQSwwQ0FBMEMsbUJBQW1CO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULGtCQUFrQixRQUFRLFVBQVUsa0JBQWtCLEtBQUssVUFBVSxhQUFhLFlBQVk7QUFDOUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1jb21wYW5pb24vLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvZXhwZXJpbWVudGFsL2dlbmVyYXRpdmVfYWdlbnRzL2dlbmVyYXRpdmVfYWdlbnQuanM/NWQzYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcm9tcHRUZW1wbGF0ZSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvcHJvbXB0c1wiO1xuaW1wb3J0IHsgTExNQ2hhaW4gfSBmcm9tIFwiLi4vLi4vY2hhaW5zL2xsbV9jaGFpbi5qc1wiO1xuaW1wb3J0IHsgQmFzZUNoYWluIH0gZnJvbSBcIi4uLy4uL2NoYWlucy9iYXNlLmpzXCI7XG4vKipcbiAqIEltcGxlbWVudGF0aW9uIG9mIGEgZ2VuZXJhdGl2ZSBhZ2VudCB0aGF0IGNhbiBsZWFybiBhbmQgZm9ybSBuZXcgbWVtb3JpZXMgb3ZlclxuICogdGltZS4gSXQgZXh0ZW5kcyB0aGUgQmFzZUNoYWluIGNsYXNzLCB3aGljaCBpcyBhIGdlbmVyaWNcbiAqIHNlcXVlbmNlIG9mIGNhbGxzIHRvIGNvbXBvbmVudHMsIGluY2x1ZGluZyBvdGhlciBjaGFpbnMuXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgdG9tbWllOiBHZW5lcmF0aXZlQWdlbnQgPSBuZXcgR2VuZXJhdGl2ZUFnZW50KFxuICogICBuZXcgT3BlbkFJKHsgdGVtcGVyYXR1cmU6IDAuOSwgbWF4VG9rZW5zOiAxNTAwIH0pLFxuICogICBuZXcgR2VuZXJhdGl2ZUFnZW50TWVtb3J5KFxuICogICAgIG5ldyBDaGF0T3BlbkFJKCksXG4gKiAgICAgbmV3IFRpbWVXZWlnaHRlZFZlY3RvclN0b3JlUmV0cmlldmVyKHtcbiAqICAgICAgIHZlY3RvclN0b3JlOiBuZXcgTWVtb3J5VmVjdG9yU3RvcmUobmV3IE9wZW5BSUVtYmVkZGluZ3MoKSksXG4gKiAgICAgICBvdGhlclNjb3JlS2V5czogW1wiaW1wb3J0YW5jZVwiXSxcbiAqICAgICAgIGs6IDE1LFxuICogICAgIH0pLFxuICogICAgIHsgcmVmbGVjdGlvblRocmVzaG9sZDogOCB9LFxuICogICApLFxuICogICB7XG4gKiAgICAgbmFtZTogXCJUb21taWVcIixcbiAqICAgICBhZ2U6IDI1LFxuICogICAgIHRyYWl0czogXCJhbnhpb3VzLCBsaWtlcyBkZXNpZ24sIHRhbGthdGl2ZVwiLFxuICogICAgIHN0YXR1czogXCJsb29raW5nIGZvciBhIGpvYlwiLFxuICogICB9LFxuICogKTtcbiAqXG4gKiBhd2FpdCB0b21taWUuYWRkTWVtb3J5KFxuICogICBcIlRvbW1pZSByZW1lbWJlcnMgaGlzIGRvZywgQnJ1bm8sIGZyb20gd2hlbiBoZSB3YXMgYSBraWRcIixcbiAqICAgbmV3IERhdGUoKSxcbiAqICk7XG4gKiBjb25zdCBzdW1tYXJ5ID0gYXdhaXQgdG9tbWllLmdldFN1bW1hcnkoeyBmb3JjZVJlZnJlc2g6IHRydWUgfSk7XG4gKiBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRvbW1pZS5nZW5lcmF0ZURpYWxvZ3VlUmVzcG9uc2UoXG4gKiAgIFwiVVNFUiBzYXlzIEhlbGxvIFRvbW1pZSwgaG93IGFyZSB5b3UgdG9kYXk/XCIsXG4gKiApO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBHZW5lcmF0aXZlQWdlbnQgZXh0ZW5kcyBCYXNlQ2hhaW4ge1xuICAgIHN0YXRpYyBsY19uYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJHZW5lcmF0aXZlQWdlbnRcIjtcbiAgICB9XG4gICAgLy8gVE9ETzogQWRkIHN1cHBvcnQgZm9yIGRhaWx5IHN1bW1hcmllc1xuICAgIC8vIHByaXZhdGUgZGFpbHlTdW1tYXJpZXM6IHN0cmluZ1tdID0gW107IC8vIHN1bW1hcnkgb2YgdGhlIGV2ZW50cyBpbiB0aGUgcGxhbiB0aGF0IHRoZSBhZ2VudCB0b29rLlxuICAgIF9jaGFpblR5cGUoKSB7XG4gICAgICAgIHJldHVybiBcImdlbmVyYXRpdmVfYWdlbnRfZXhlY3V0b3JcIjtcbiAgICB9XG4gICAgZ2V0IGlucHV0S2V5cygpIHtcbiAgICAgICAgcmV0dXJuIFtcIm9ic2VydmF0aW9uXCIsIFwic3VmZml4XCIsIFwibm93XCJdO1xuICAgIH1cbiAgICBnZXQgb3V0cHV0S2V5cygpIHtcbiAgICAgICAgcmV0dXJuIFtcIm91dHB1dFwiLCBcImNvbnRpbnVlX2RpYWxvZ3VlXCJdO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihsbG0sIGxvbmdUZXJtTWVtb3J5LCBjb25maWcpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgLy8gYSBjaGFyYWN0ZXIgd2l0aCBtZW1vcnkgYW5kIGlubmF0ZSBjaGFyYWN0ZXJpc2l0aWNzXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm5hbWVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTsgLy8gdGhlIGNoYXJhY3RlcidzIG5hbWVcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiYWdlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7IC8vIHRoZSBvcHRpb25hbCBhZ2Ugb2YgdGhlIGNoYXJhY3RlclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ0cmFpdHNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTsgLy8gcGVybWFuZW50IHRyYWl0cyB0byBhc2NyaWJlIHRvIHRoZSBjaGFyYWN0ZXJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwic3RhdHVzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7IC8vIHRoZSB0cmFpdHMgb2YgdGhlIGNoYXJhY3RlciB5b3Ugd2lzaCBub3QgdG8gY2hhbmdlXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImxvbmdUZXJtTWVtb3J5XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImxsbVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pOyAvLyB0aGUgdW5kZXJseWluZyBsYW5ndWFnZSBtb2RlbFxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ2ZXJib3NlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7IC8vIGZhbHNlXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInN1bW1hcnlcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTsgLy8gc3RhdGVmdWwgc2VsZi1zdW1tYXJ5IGdlbmVyYXRlZCB2aWEgcmVmbGVjdGlvbiBvbiB0aGUgY2hhcmFjdGVyJ3MgbWVtb3J5LlxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJzdW1tYXJ5UmVmcmVzaFNlY29uZHNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IDM2MDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImxhc3RSZWZyZXNoZWRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTsgLy8gdGhlIGxhc3QgdGltZSB0aGUgY2hhcmFjdGVyJ3Mgc3VtbWFyeSB3YXMgcmVnZW5lcmF0ZWRcbiAgICAgICAgdGhpcy5sbG0gPSBsbG07XG4gICAgICAgIHRoaXMubG9uZ1Rlcm1NZW1vcnkgPSBsb25nVGVybU1lbW9yeTtcbiAgICAgICAgdGhpcy5uYW1lID0gY29uZmlnLm5hbWU7XG4gICAgICAgIHRoaXMuYWdlID0gY29uZmlnLmFnZTtcbiAgICAgICAgdGhpcy50cmFpdHMgPSBjb25maWcudHJhaXRzO1xuICAgICAgICB0aGlzLnN0YXR1cyA9IGNvbmZpZy5zdGF0dXM7XG4gICAgICAgIHRoaXMudmVyYm9zZSA9IGNvbmZpZy52ZXJib3NlID8/IHRoaXMudmVyYm9zZTtcbiAgICAgICAgdGhpcy5zdW1tYXJ5ID0gXCJcIjtcbiAgICAgICAgdGhpcy5zdW1tYXJ5UmVmcmVzaFNlY29uZHMgPVxuICAgICAgICAgICAgY29uZmlnLnN1bW1hcnlSZWZyZXNoU2Vjb25kcyA/PyB0aGlzLnN1bW1hcnlSZWZyZXNoU2Vjb25kcztcbiAgICAgICAgdGhpcy5sYXN0UmVmcmVzaGVkID0gbmV3IERhdGUoKTtcbiAgICAgICAgLy8gdGhpcy5kYWlseVN1bW1hcmllcyA9IGNvbmZpZy5kYWlseVN1bW1hcmllcyA/PyB0aGlzLmRhaWx5U3VtbWFyaWVzO1xuICAgIH1cbiAgICAvLyBMTE0gbWV0aG9kc1xuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIG5ld2xpbmUtc2VwYXJhdGVkIHN0cmluZyBpbnRvIGEgbGlzdCBvZiBzdHJpbmdzLlxuICAgICAqIEBwYXJhbSB0ZXh0IFRoZSBzdHJpbmcgdG8gcGFyc2UuXG4gICAgICogQHJldHVybnMgQW4gYXJyYXkgb2Ygc3RyaW5ncyBwYXJzZWQgZnJvbSB0aGUgaW5wdXQgdGV4dC5cbiAgICAgKi9cbiAgICBwYXJzZUxpc3QodGV4dCkge1xuICAgICAgICAvLyBwYXJzZSBhIG5ld2xpbmUtc2VwZXJhdGVkIHN0cmluZyBpbnRvIGEgbGlzdCBvZiBzdHJpbmdzXG4gICAgICAgIGNvbnN0IGxpbmVzID0gdGV4dC50cmltKCkuc3BsaXQoXCJcXG5cIik7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGxpbmVzLm1hcCgobGluZSkgPT4gbGluZS5yZXBsYWNlKC9eXFxzKlxcZCtcXC5cXHMqLywgXCJcIikudHJpbSgpKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBMTE1DaGFpbiB3aXRoIHRoZSBnaXZlbiBwcm9tcHQgYW5kIHRoZSBhZ2VudCdzIGxhbmd1YWdlXG4gICAgICogbW9kZWwsIHZlcmJvc2l0eSwgb3V0cHV0IGtleSwgYW5kIG1lbW9yeS5cbiAgICAgKiBAcGFyYW0gcHJvbXB0IFRoZSBwcm9tcHQgdG8gdXNlIGZvciB0aGUgTExNQ2hhaW4uXG4gICAgICogQHJldHVybnMgQSBuZXcgTExNQ2hhaW4gaW5zdGFuY2UuXG4gICAgICovXG4gICAgY2hhaW4ocHJvbXB0KSB7XG4gICAgICAgIGNvbnN0IGNoYWluID0gbmV3IExMTUNoYWluKHtcbiAgICAgICAgICAgIGxsbTogdGhpcy5sbG0sXG4gICAgICAgICAgICBwcm9tcHQsXG4gICAgICAgICAgICB2ZXJib3NlOiB0aGlzLnZlcmJvc2UsXG4gICAgICAgICAgICBvdXRwdXRLZXk6IFwib3V0cHV0XCIsXG4gICAgICAgICAgICBtZW1vcnk6IHRoaXMubG9uZ1Rlcm1NZW1vcnksXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2hhaW47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV4dHJhY3RzIHRoZSBvYnNlcnZlZCBlbnRpdHkgZnJvbSB0aGUgZ2l2ZW4gb2JzZXJ2YXRpb24uXG4gICAgICogQHBhcmFtIG9ic2VydmF0aW9uIFRoZSBvYnNlcnZhdGlvbiB0byBleHRyYWN0IHRoZSBlbnRpdHkgZnJvbS5cbiAgICAgKiBAcGFyYW0gcnVuTWFuYWdlciBPcHRpb25hbCBDYWxsYmFja01hbmFnZXJGb3JDaGFpblJ1biBpbnN0YW5jZS5cbiAgICAgKiBAcmV0dXJucyBUaGUgZXh0cmFjdGVkIGVudGl0eSBhcyBhIHN0cmluZy5cbiAgICAgKi9cbiAgICBhc3luYyBnZXRFbnRpdHlGcm9tT2JzZXJ2YXRpb25zKG9ic2VydmF0aW9uLCBydW5NYW5hZ2VyKSB7XG4gICAgICAgIGNvbnN0IHByb21wdCA9IFByb21wdFRlbXBsYXRlLmZyb21UZW1wbGF0ZShcIldoYXQgaXMgdGhlIG9ic2VydmVkIGVudGl0eSBpbiB0aGUgZm9sbG93aW5nIG9ic2VydmF0aW9uPyB7b2JzZXJ2YXRpb259XCIgK1xuICAgICAgICAgICAgXCJcXG5FbnRpdHk9XCIpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmNoYWluKHByb21wdCkuY2FsbCh7XG4gICAgICAgICAgICBvYnNlcnZhdGlvbixcbiAgICAgICAgfSwgcnVuTWFuYWdlcj8uZ2V0Q2hpbGQoXCJlbnRpdHlfZXh0cmFjdG9yXCIpKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdC5vdXRwdXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV4dHJhY3RzIHRoZSBhY3Rpb24gb2YgdGhlIGdpdmVuIGVudGl0eSBmcm9tIHRoZSBnaXZlbiBvYnNlcnZhdGlvbi5cbiAgICAgKiBAcGFyYW0gb2JzZXJ2YXRpb24gVGhlIG9ic2VydmF0aW9uIHRvIGV4dHJhY3QgdGhlIGFjdGlvbiBmcm9tLlxuICAgICAqIEBwYXJhbSBlbnRpdHlOYW1lIFRoZSBuYW1lIG9mIHRoZSBlbnRpdHkgdG8gZXh0cmFjdCB0aGUgYWN0aW9uIGZvci5cbiAgICAgKiBAcGFyYW0gcnVuTWFuYWdlciBPcHRpb25hbCBDYWxsYmFja01hbmFnZXJGb3JDaGFpblJ1biBpbnN0YW5jZS5cbiAgICAgKiBAcmV0dXJucyBUaGUgZXh0cmFjdGVkIGFjdGlvbiBhcyBhIHN0cmluZy5cbiAgICAgKi9cbiAgICBhc3luYyBnZXRFbnRpdHlBY3Rpb24ob2JzZXJ2YXRpb24sIGVudGl0eU5hbWUsIHJ1bk1hbmFnZXIpIHtcbiAgICAgICAgY29uc3QgcHJvbXB0ID0gUHJvbXB0VGVtcGxhdGUuZnJvbVRlbXBsYXRlKFwiV2hhdCBpcyB0aGUge2VudGl0eX0gZG9pbmcgaW4gdGhlIGZvbGxvd2luZyBvYnNlcnZhdGlvbj8ge29ic2VydmF0aW9ufVwiICtcbiAgICAgICAgICAgIFwiXFxuVGhlIHtlbnRpdHl9IGlzXCIpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmNoYWluKHByb21wdCkuY2FsbCh7XG4gICAgICAgICAgICBlbnRpdHk6IGVudGl0eU5hbWUsXG4gICAgICAgICAgICBvYnNlcnZhdGlvbixcbiAgICAgICAgfSwgcnVuTWFuYWdlcj8uZ2V0Q2hpbGQoXCJlbnRpdHlfYWN0aW9uX2V4dHJhY3RvclwiKSk7XG4gICAgICAgIGNvbnN0IHRyaW1tZWRSZXN1bHQgPSByZXN1bHQub3V0cHV0LnRyaW0oKTtcbiAgICAgICAgcmV0dXJuIHRyaW1tZWRSZXN1bHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN1bW1hcml6ZXMgbWVtb3JpZXMgdGhhdCBhcmUgbW9zdCByZWxldmFudCB0byBhbiBvYnNlcnZhdGlvbi5cbiAgICAgKiBAcGFyYW0gb2JzZXJ2YXRpb24gVGhlIG9ic2VydmF0aW9uIHRvIHN1bW1hcml6ZSByZWxhdGVkIG1lbW9yaWVzIGZvci5cbiAgICAgKiBAcGFyYW0gcnVuTWFuYWdlciBPcHRpb25hbCBDYWxsYmFja01hbmFnZXJGb3JDaGFpblJ1biBpbnN0YW5jZS5cbiAgICAgKiBAcmV0dXJucyBUaGUgc3VtbWFyaXplZCBtZW1vcmllcyBhcyBhIHN0cmluZy5cbiAgICAgKi9cbiAgICBhc3luYyBzdW1tYXJpemVSZWxhdGVkTWVtb3JpZXMob2JzZXJ2YXRpb24sIHJ1bk1hbmFnZXIpIHtcbiAgICAgICAgLy8gc3VtbWFyaXplIG1lbW9yaWVzIHRoYXQgYXJlIG1vc3QgcmVsZXZhbnQgdG8gYW4gb2JzZXJ2YXRpb25cbiAgICAgICAgY29uc3QgcHJvbXB0ID0gUHJvbXB0VGVtcGxhdGUuZnJvbVRlbXBsYXRlKGBcbntxMX0/XG5Db250ZXh0IGZyb20gbWVtb3J5Olxue3JlbGV2YW50X21lbW9yaWVzfVxuUmVsZXZhbnQgY29udGV4dDpgKTtcbiAgICAgICAgY29uc3QgZW50aXR5TmFtZSA9IGF3YWl0IHRoaXMuZ2V0RW50aXR5RnJvbU9ic2VydmF0aW9ucyhvYnNlcnZhdGlvbiwgcnVuTWFuYWdlcik7XG4gICAgICAgIGNvbnN0IGVudGl0eUFjdGlvbiA9IGF3YWl0IHRoaXMuZ2V0RW50aXR5QWN0aW9uKG9ic2VydmF0aW9uLCBlbnRpdHlOYW1lLCBydW5NYW5hZ2VyKTtcbiAgICAgICAgY29uc3QgcTEgPSBgV2hhdCBpcyB0aGUgcmVsYXRpb25zaGlwIGJldHdlZW4gJHt0aGlzLm5hbWV9IGFuZCAke2VudGl0eU5hbWV9YDtcbiAgICAgICAgY29uc3QgcTIgPSBgJHtlbnRpdHlOYW1lfSBpcyAke2VudGl0eUFjdGlvbn1gO1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuY2hhaW4ocHJvbXB0KS5jYWxsKHtcbiAgICAgICAgICAgIHExLFxuICAgICAgICAgICAgcXVlcmllczogW3ExLCBxMl0sXG4gICAgICAgIH0sIHJ1bk1hbmFnZXI/LmdldENoaWxkKFwiZW50aXR5X3JlbGF0aW9uc2hpcHNcIikpO1xuICAgICAgICByZXR1cm4gcmVzcG9uc2Uub3V0cHV0LnRyaW0oKTsgLy8gYWRkZWQgb3V0cHV0XG4gICAgfVxuICAgIGFzeW5jIF9jYWxsKHZhbHVlcywgcnVuTWFuYWdlcikge1xuICAgICAgICBjb25zdCB7IG9ic2VydmF0aW9uLCBzdWZmaXgsIG5vdyB9ID0gdmFsdWVzO1xuICAgICAgICAvLyByZWFjdCB0byBhIGdpdmVuIG9ic2VydmF0aW9uIG9yIGRpYWxvZ3VlIGFjdFxuICAgICAgICBjb25zdCBwcm9tcHQgPSBQcm9tcHRUZW1wbGF0ZS5mcm9tVGVtcGxhdGUoYHthZ2VudF9zdW1tYXJ5X2Rlc2NyaXB0aW9ufWAgK1xuICAgICAgICAgICAgYFxcbkl0IGlzIHtjdXJyZW50X3RpbWV9LmAgK1xuICAgICAgICAgICAgYFxcbnthZ2VudF9uYW1lfSdzIHN0YXR1czoge2FnZW50X3N0YXR1c31gICtcbiAgICAgICAgICAgIGBcXG5TdW1tYXJ5IG9mIHJlbGV2YW50IGNvbnRleHQgZnJvbSB7YWdlbnRfbmFtZX0ncyBtZW1vcnk6YCArXG4gICAgICAgICAgICBcIlxcbntyZWxldmFudF9tZW1vcmllc31cIiArXG4gICAgICAgICAgICBgXFxuTW9zdCByZWNlbnQgb2JzZXJ2YXRpb25zOiB7bW9zdF9yZWNlbnRfbWVtb3JpZXN9YCArXG4gICAgICAgICAgICBgXFxuT2JzZXJ2YXRpb246IHtvYnNlcnZhdGlvbn1gICtcbiAgICAgICAgICAgIGBcXG5cXG4ke3N1ZmZpeH1gKTtcbiAgICAgICAgY29uc3QgYWdlbnRTdW1tYXJ5RGVzY3JpcHRpb24gPSBhd2FpdCB0aGlzLmdldFN1bW1hcnkoe30sIHJ1bk1hbmFnZXIpOyAvLyBub3cgPSBub3cgaW4gcGFyYW1cbiAgICAgICAgY29uc3QgcmVsZXZhbnRNZW1vcmllc1N0ciA9IGF3YWl0IHRoaXMuc3VtbWFyaXplUmVsYXRlZE1lbW9yaWVzKG9ic2VydmF0aW9uLCBydW5NYW5hZ2VyKTtcbiAgICAgICAgY29uc3QgY3VycmVudFRpbWUgPSAobm93IHx8IG5ldyBEYXRlKCkpLnRvTG9jYWxlU3RyaW5nKFwiZW4tVVNcIiwge1xuICAgICAgICAgICAgbW9udGg6IFwibG9uZ1wiLFxuICAgICAgICAgICAgZGF5OiBcIm51bWVyaWNcIixcbiAgICAgICAgICAgIHllYXI6IFwibnVtZXJpY1wiLFxuICAgICAgICAgICAgaG91cjogXCJudW1lcmljXCIsXG4gICAgICAgICAgICBtaW51dGU6IFwibnVtZXJpY1wiLFxuICAgICAgICAgICAgaG91cjEyOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgY2hhaW5JbnB1dHMgPSB7XG4gICAgICAgICAgICBhZ2VudF9zdW1tYXJ5X2Rlc2NyaXB0aW9uOiBhZ2VudFN1bW1hcnlEZXNjcmlwdGlvbixcbiAgICAgICAgICAgIGN1cnJlbnRfdGltZTogY3VycmVudFRpbWUsXG4gICAgICAgICAgICBhZ2VudF9uYW1lOiB0aGlzLm5hbWUsXG4gICAgICAgICAgICBvYnNlcnZhdGlvbixcbiAgICAgICAgICAgIGFnZW50X3N0YXR1czogdGhpcy5zdGF0dXMsXG4gICAgICAgICAgICBtb3N0X3JlY2VudF9tZW1vcmllczogXCJcIixcbiAgICAgICAgfTtcbiAgICAgICAgY2hhaW5JbnB1dHNbdGhpcy5sb25nVGVybU1lbW9yeS5nZXRSZWxldmFudE1lbW9yaWVzS2V5KCldID1cbiAgICAgICAgICAgIHJlbGV2YW50TWVtb3JpZXNTdHI7XG4gICAgICAgIGNvbnN0IGNvbnN1bWVkVG9rZW5zID0gYXdhaXQgdGhpcy5sbG0uZ2V0TnVtVG9rZW5zKGF3YWl0IHByb21wdC5mb3JtYXQoeyAuLi5jaGFpbklucHV0cyB9KSk7XG4gICAgICAgIGNoYWluSW5wdXRzW3RoaXMubG9uZ1Rlcm1NZW1vcnkuZ2V0TW9zdFJlY2VudE1lbW9yaWVzVG9rZW5LZXkoKV0gPVxuICAgICAgICAgICAgY29uc3VtZWRUb2tlbnM7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jaGFpbihwcm9tcHQpLmNhbGwoY2hhaW5JbnB1dHMsIHJ1bk1hbmFnZXI/LmdldENoaWxkKFwicmVhY3Rpb25fZnJvbV9zdW1tYXJ5XCIpKTtcbiAgICAgICAgY29uc3QgcmF3T3V0cHV0ID0gcmVzcG9uc2Uub3V0cHV0O1xuICAgICAgICBsZXQgb3V0cHV0ID0gcmF3T3V0cHV0O1xuICAgICAgICBsZXQgY29udGludWVfZGlhbG9ndWUgPSBmYWxzZTtcbiAgICAgICAgaWYgKHJhd091dHB1dC5pbmNsdWRlcyhcIlJFQUNUOlwiKSkge1xuICAgICAgICAgICAgY29uc3QgcmVhY3Rpb24gPSB0aGlzLl9jbGVhblJlc3BvbnNlKHJhd091dHB1dC5zcGxpdChcIlJFQUNUOlwiKS5wb3AoKSk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFkZE1lbW9yeShgJHt0aGlzLm5hbWV9IG9ic2VydmVkICR7b2JzZXJ2YXRpb259IGFuZCByZWFjdGVkIGJ5ICR7cmVhY3Rpb259YCwgbm93LCB7fSwgcnVuTWFuYWdlcj8uZ2V0Q2hpbGQoXCJtZW1vcnlcIikpO1xuICAgICAgICAgICAgb3V0cHV0ID0gYCR7cmVhY3Rpb259YDtcbiAgICAgICAgICAgIGNvbnRpbnVlX2RpYWxvZ3VlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocmF3T3V0cHV0LmluY2x1ZGVzKFwiU0FZOlwiKSkge1xuICAgICAgICAgICAgY29uc3Qgc2FpZFZhbHVlID0gdGhpcy5fY2xlYW5SZXNwb25zZShyYXdPdXRwdXQuc3BsaXQoXCJTQVk6XCIpLnBvcCgpKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYWRkTWVtb3J5KGAke3RoaXMubmFtZX0gb2JzZXJ2ZWQgJHtvYnNlcnZhdGlvbn0gYW5kIHNhaWQgJHtzYWlkVmFsdWV9YCwgbm93LCB7fSwgcnVuTWFuYWdlcj8uZ2V0Q2hpbGQoXCJtZW1vcnlcIikpO1xuICAgICAgICAgICAgb3V0cHV0ID0gYCR7dGhpcy5uYW1lfSBzYWlkICR7c2FpZFZhbHVlfWA7XG4gICAgICAgICAgICBjb250aW51ZV9kaWFsb2d1ZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocmF3T3V0cHV0LmluY2x1ZGVzKFwiR09PREJZRTpcIikpIHtcbiAgICAgICAgICAgIGNvbnN0IGZhcmV3ZWxsID0gdGhpcy5fY2xlYW5SZXNwb25zZShyYXdPdXRwdXQuc3BsaXQoXCJHT09EQllFOlwiKS5wb3AoKSA/PyBcIlwiKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYWRkTWVtb3J5KGAke3RoaXMubmFtZX0gb2JzZXJ2ZWQgJHtvYnNlcnZhdGlvbn0gYW5kIHNhaWQgJHtmYXJld2VsbH1gLCBub3csIHt9LCBydW5NYW5hZ2VyPy5nZXRDaGlsZChcIm1lbW9yeVwiKSk7XG4gICAgICAgICAgICBvdXRwdXQgPSBgJHt0aGlzLm5hbWV9IHNhaWQgJHtmYXJld2VsbH1gO1xuICAgICAgICAgICAgY29udGludWVfZGlhbG9ndWUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBvdXRwdXQsIGNvbnRpbnVlX2RpYWxvZ3VlIH07XG4gICAgfVxuICAgIF9jbGVhblJlc3BvbnNlKHRleHQpIHtcbiAgICAgICAgaWYgKHRleHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBeJHt0aGlzLm5hbWV9IGApO1xuICAgICAgICByZXR1cm4gdGV4dC5yZXBsYWNlKHJlZ2V4LCBcIlwiKS50cmltKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlcyBhIHJlYWN0aW9uIHRvIHRoZSBnaXZlbiBvYnNlcnZhdGlvbi5cbiAgICAgKiBAcGFyYW0gb2JzZXJ2YXRpb24gVGhlIG9ic2VydmF0aW9uIHRvIGdlbmVyYXRlIGEgcmVhY3Rpb24gZm9yLlxuICAgICAqIEBwYXJhbSBub3cgT3B0aW9uYWwgY3VycmVudCBkYXRlLlxuICAgICAqIEByZXR1cm5zIEEgYm9vbGVhbiBpbmRpY2F0aW5nIHdoZXRoZXIgdG8gY29udGludWUgdGhlIGRpYWxvZ3VlIGFuZCB0aGUgb3V0cHV0IHN0cmluZy5cbiAgICAgKi9cbiAgICBhc3luYyBnZW5lcmF0ZVJlYWN0aW9uKG9ic2VydmF0aW9uLCBub3cpIHtcbiAgICAgICAgY29uc3QgY2FsbFRvQWN0aW9uVGVtcGxhdGUgPSBgU2hvdWxkIHthZ2VudF9uYW1lfSByZWFjdCB0byB0aGUgb2JzZXJ2YXRpb24sIGFuZCBpZiBzbyxgICtcbiAgICAgICAgICAgIGAgd2hhdCB3b3VsZCBiZSBhbiBhcHByb3ByaWF0ZSByZWFjdGlvbj8gUmVzcG9uZCBpbiBvbmUgbGluZS5gICtcbiAgICAgICAgICAgIGAgSWYgdGhlIGFjdGlvbiBpcyB0byBlbmdhZ2UgaW4gZGlhbG9ndWUsIHdyaXRlOlxcblNBWTogXCJ3aGF0IHRvIHNheVwiYCArXG4gICAgICAgICAgICBgIFxcbm90aGVyd2lzZSwgd3JpdGU6XFxuUkVBQ1Q6IHthZ2VudF9uYW1lfSdzIHJlYWN0aW9uIChpZiBhbnl0aGluZykuYCArXG4gICAgICAgICAgICBgIFxcbkVpdGhlciBkbyBub3RoaW5nLCByZWFjdCwgb3Igc2F5IHNvbWV0aGluZyBidXQgbm90IGJvdGguXFxuXFxuYDtcbiAgICAgICAgY29uc3QgeyBvdXRwdXQsIGNvbnRpbnVlX2RpYWxvZ3VlIH0gPSBhd2FpdCB0aGlzLmNhbGwoe1xuICAgICAgICAgICAgb2JzZXJ2YXRpb24sXG4gICAgICAgICAgICBzdWZmaXg6IGNhbGxUb0FjdGlvblRlbXBsYXRlLFxuICAgICAgICAgICAgbm93LFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIFtjb250aW51ZV9kaWFsb2d1ZSwgb3V0cHV0XTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2VuZXJhdGVzIGEgZGlhbG9ndWUgcmVzcG9uc2UgdG8gdGhlIGdpdmVuIG9ic2VydmF0aW9uLlxuICAgICAqIEBwYXJhbSBvYnNlcnZhdGlvbiBUaGUgb2JzZXJ2YXRpb24gdG8gZ2VuZXJhdGUgYSBkaWFsb2d1ZSByZXNwb25zZSBmb3IuXG4gICAgICogQHBhcmFtIG5vdyBPcHRpb25hbCBjdXJyZW50IGRhdGUuXG4gICAgICogQHJldHVybnMgQSBib29sZWFuIGluZGljYXRpbmcgd2hldGhlciB0byBjb250aW51ZSB0aGUgZGlhbG9ndWUgYW5kIHRoZSBvdXRwdXQgc3RyaW5nLlxuICAgICAqL1xuICAgIGFzeW5jIGdlbmVyYXRlRGlhbG9ndWVSZXNwb25zZShvYnNlcnZhdGlvbiwgbm93KSB7XG4gICAgICAgIGNvbnN0IGNhbGxUb0FjdGlvblRlbXBsYXRlID0gYFdoYXQgd291bGQgJHt0aGlzLm5hbWV9IHNheT8gVG8gZW5kIHRoZSBjb252ZXJzYXRpb24sIHdyaXRlOiBHT09EQllFOiBcIndoYXQgdG8gc2F5XCIuIE90aGVyd2lzZSB0byBjb250aW51ZSB0aGUgY29udmVyc2F0aW9uLCB3cml0ZTogU0FZOiBcIndoYXQgdG8gc2F5IG5leHRcIlxcblxcbmA7XG4gICAgICAgIGNvbnN0IHsgb3V0cHV0LCBjb250aW51ZV9kaWFsb2d1ZSB9ID0gYXdhaXQgdGhpcy5jYWxsKHtcbiAgICAgICAgICAgIG9ic2VydmF0aW9uLFxuICAgICAgICAgICAgc3VmZml4OiBjYWxsVG9BY3Rpb25UZW1wbGF0ZSxcbiAgICAgICAgICAgIG5vdyxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBbY29udGludWVfZGlhbG9ndWUsIG91dHB1dF07XG4gICAgfVxuICAgIC8vIEFnZW50IHN0YXRlZnVsJyBzdW1tYXJ5IG1ldGhvZHNcbiAgICAvLyBFYWNoIGRpYWxvZyBvciByZXNwb25zZSBwcm9tcHQgaW5jbHVkZXMgYSBoZWFkZXJcbiAgICAvLyBzdW1tYXJpemluZyB0aGUgYWdlbnQncyBzZWxmLWRlc2NyaXB0aW9uLiBUaGlzIGlzXG4gICAgLy8gdXBkYXRlZCBwZXJpb2RpY2FsbHkgdGhyb3VnaCBwcm9iaW5nIGl0J3MgbWVtb3JpZXNcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBhZ2VudCdzIHN1bW1hcnksIHdoaWNoIGluY2x1ZGVzIHRoZSBhZ2VudCdzIG5hbWUsIGFnZSwgdHJhaXRzLFxuICAgICAqIGFuZCBhIHN1bW1hcnkgb2YgdGhlIGFnZW50J3MgY29yZSBjaGFyYWN0ZXJpc3RpY3MuIFRoZSBzdW1tYXJ5IGlzXG4gICAgICogdXBkYXRlZCBwZXJpb2RpY2FsbHkgdGhyb3VnaCBwcm9iaW5nIHRoZSBhZ2VudCdzIG1lbW9yaWVzLlxuICAgICAqIEBwYXJhbSBjb25maWcgT3B0aW9uYWwgY29uZmlndXJhdGlvbiBvYmplY3Qgd2l0aCBjdXJyZW50IGRhdGUgYW5kIGEgYm9vbGVhbiB0byBmb3JjZSByZWZyZXNoLlxuICAgICAqIEBwYXJhbSBydW5NYW5hZ2VyIE9wdGlvbmFsIENhbGxiYWNrTWFuYWdlckZvckNoYWluUnVuIGluc3RhbmNlLlxuICAgICAqIEByZXR1cm5zIFRoZSBhZ2VudCdzIHN1bW1hcnkgYXMgYSBzdHJpbmcuXG4gICAgICovXG4gICAgYXN5bmMgZ2V0U3VtbWFyeShjb25maWcsIHJ1bk1hbmFnZXIpIHtcbiAgICAgICAgY29uc3QgeyBub3cgPSBuZXcgRGF0ZSgpLCBmb3JjZVJlZnJlc2ggPSBmYWxzZSB9ID0gY29uZmlnID8/IHt9O1xuICAgICAgICBjb25zdCBzaW5jZVJlZnJlc2ggPSBNYXRoLmZsb29yKChub3cuZ2V0VGltZSgpIC0gdGhpcy5sYXN0UmVmcmVzaGVkLmdldFRpbWUoKSkgLyAxMDAwKTtcbiAgICAgICAgaWYgKCF0aGlzLnN1bW1hcnkgfHxcbiAgICAgICAgICAgIHNpbmNlUmVmcmVzaCA+PSB0aGlzLnN1bW1hcnlSZWZyZXNoU2Vjb25kcyB8fFxuICAgICAgICAgICAgZm9yY2VSZWZyZXNoKSB7XG4gICAgICAgICAgICB0aGlzLnN1bW1hcnkgPSBhd2FpdCB0aGlzLmNvbXB1dGVBZ2VudFN1bW1hcnkocnVuTWFuYWdlcik7XG4gICAgICAgICAgICB0aGlzLmxhc3RSZWZyZXNoZWQgPSBub3c7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGFnZTtcbiAgICAgICAgaWYgKHRoaXMuYWdlKSB7XG4gICAgICAgICAgICBhZ2UgPSB0aGlzLmFnZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGFnZSA9IFwiTi9BXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGBOYW1lOiAke3RoaXMubmFtZX0gKGFnZTogJHthZ2V9KVxuSW5uYXRlIHRyYWl0czogJHt0aGlzLnRyYWl0c31cbiR7dGhpcy5zdW1tYXJ5fWA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbXB1dGVzIHRoZSBhZ2VudCdzIHN1bW1hcnkgYnkgc3VtbWFyaXppbmcgdGhlIGFnZW50J3MgY29yZVxuICAgICAqIGNoYXJhY3RlcmlzdGljcyBnaXZlbiB0aGUgYWdlbnQncyByZWxldmFudCBtZW1vcmllcy5cbiAgICAgKiBAcGFyYW0gcnVuTWFuYWdlciBPcHRpb25hbCBDYWxsYmFja01hbmFnZXJGb3JDaGFpblJ1biBpbnN0YW5jZS5cbiAgICAgKiBAcmV0dXJucyBUaGUgY29tcHV0ZWQgc3VtbWFyeSBhcyBhIHN0cmluZy5cbiAgICAgKi9cbiAgICBhc3luYyBjb21wdXRlQWdlbnRTdW1tYXJ5KHJ1bk1hbmFnZXIpIHtcbiAgICAgICAgY29uc3QgcHJvbXB0ID0gUHJvbXB0VGVtcGxhdGUuZnJvbVRlbXBsYXRlKFwiSG93IHdvdWxkIHlvdSBzdW1tYXJpemUge25hbWV9J3MgY29yZSBjaGFyYWN0ZXJpc3RpY3MgZ2l2ZW4gdGhlIGZvbGxvd2luZyBzdGF0ZW1lbnRzOlxcblwiICtcbiAgICAgICAgICAgIFwiLS0tLS0tLS0tLVwiICtcbiAgICAgICAgICAgIFwie3JlbGV2YW50X21lbW9yaWVzfVwiICtcbiAgICAgICAgICAgIFwiLS0tLS0tLS0tLVwiICtcbiAgICAgICAgICAgIFwiRG8gbm90IGVtYmVsbGlzaC5cIiArXG4gICAgICAgICAgICBcIlxcblxcblN1bW1hcnk6IFwiKTtcbiAgICAgICAgLy8gdGhlIGFnZW50IHNlZWtzIHRvIHRoaW5rIGFib3V0IHRoZWlyIGNvcmUgY2hhcmFjdGVyaXNpdGljc1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmNoYWluKHByb21wdCkuY2FsbCh7XG4gICAgICAgICAgICBuYW1lOiB0aGlzLm5hbWUsXG4gICAgICAgICAgICBxdWVyaWVzOiBbYCR7dGhpcy5uYW1lfSdzIGNvcmUgY2hhcmFjdGVyaXN0aWNzYF0sXG4gICAgICAgIH0sIHJ1bk1hbmFnZXI/LmdldENoaWxkKFwiY29tcHV0ZV9hZ2VudF9zdW1tYXJ5XCIpKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdC5vdXRwdXQudHJpbSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgZnVsbCBoZWFkZXIgb2YgdGhlIGFnZW50J3Mgc3RhdHVzLCBzdW1tYXJ5LCBhbmQgY3VycmVudCB0aW1lLlxuICAgICAqIEBwYXJhbSBjb25maWcgT3B0aW9uYWwgY29uZmlndXJhdGlvbiBvYmplY3Qgd2l0aCBjdXJyZW50IGRhdGUgYW5kIGEgYm9vbGVhbiB0byBmb3JjZSByZWZyZXNoLlxuICAgICAqIEByZXR1cm5zIFRoZSBmdWxsIGhlYWRlciBhcyBhIHN0cmluZy5cbiAgICAgKi9cbiAgICBnZXRGdWxsSGVhZGVyKGNvbmZpZyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IHsgbm93ID0gbmV3IERhdGUoKSwgZm9yY2VSZWZyZXNoID0gZmFsc2UgfSA9IGNvbmZpZztcbiAgICAgICAgLy8gcmV0dXJuIGEgZnVsbCBoZWFkZXIgb2YgdGhlIGFnZW50J3Mgc3RhdHVzLCBzdW1tYXJ5LCBhbmQgY3VycmVudCB0aW1lLlxuICAgICAgICBjb25zdCBzdW1tYXJ5ID0gdGhpcy5nZXRTdW1tYXJ5KHsgbm93LCBmb3JjZVJlZnJlc2ggfSk7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRUaW1lU3RyaW5nID0gbm93LnRvTG9jYWxlU3RyaW5nKFwiZW4tVVNcIiwge1xuICAgICAgICAgICAgbW9udGg6IFwibG9uZ1wiLFxuICAgICAgICAgICAgZGF5OiBcIm51bWVyaWNcIixcbiAgICAgICAgICAgIHllYXI6IFwibnVtZXJpY1wiLFxuICAgICAgICAgICAgaG91cjogXCJudW1lcmljXCIsXG4gICAgICAgICAgICBtaW51dGU6IFwibnVtZXJpY1wiLFxuICAgICAgICAgICAgaG91cjEyOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGAke3N1bW1hcnl9XFxuSXQgaXMgJHtjdXJyZW50VGltZVN0cmluZ30uXFxuJHt0aGlzLm5hbWV9J3Mgc3RhdHVzOiAke3RoaXMuc3RhdHVzfWA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBtZW1vcnkgdG8gdGhlIGFnZW50J3MgbG9uZy10ZXJtIG1lbW9yeS5cbiAgICAgKiBAcGFyYW0gbWVtb3J5Q29udGVudCBUaGUgY29udGVudCBvZiB0aGUgbWVtb3J5IHRvIGFkZC5cbiAgICAgKiBAcGFyYW0gbm93IE9wdGlvbmFsIGN1cnJlbnQgZGF0ZS5cbiAgICAgKiBAcGFyYW0gbWV0YWRhdGEgT3B0aW9uYWwgbWV0YWRhdGEgZm9yIHRoZSBtZW1vcnkuXG4gICAgICogQHBhcmFtIGNhbGxiYWNrcyBPcHRpb25hbCBDYWxsYmFja3MgaW5zdGFuY2UuXG4gICAgICogQHJldHVybnMgVGhlIHJlc3VsdCBvZiBhZGRpbmcgdGhlIG1lbW9yeSB0byB0aGUgYWdlbnQncyBsb25nLXRlcm0gbWVtb3J5LlxuICAgICAqL1xuICAgIGFzeW5jIGFkZE1lbW9yeShtZW1vcnlDb250ZW50LCBub3csIG1ldGFkYXRhLCBjYWxsYmFja3MpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9uZ1Rlcm1NZW1vcnkuYWRkTWVtb3J5KG1lbW9yeUNvbnRlbnQsIG5vdywgbWV0YWRhdGEsIGNhbGxiYWNrcyk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/experimental/generative_agents/generative_agent.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/experimental/generative_agents/generative_agent_memory.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/langchain/dist/experimental/generative_agents/generative_agent_memory.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GenerativeAgentMemory: () => (/* binding */ GenerativeAgentMemory)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/prompts */ \"(rsc)/./node_modules/@langchain/core/prompts.js\");\n/* harmony import */ var _langchain_core_documents__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/documents */ \"(rsc)/./node_modules/@langchain/core/documents.js\");\n/* harmony import */ var _langchain_core_memory__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/core/memory */ \"(rsc)/./node_modules/@langchain/core/memory.js\");\n/* harmony import */ var _chains_base_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../chains/base.js */ \"(rsc)/./node_modules/langchain/dist/chains/base.js\");\n/* harmony import */ var _chains_llm_chain_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../chains/llm_chain.js */ \"(rsc)/./node_modules/langchain/dist/chains/llm_chain.js\");\n\n\n\n\n\n/**\n * Class that manages the memory of a generative agent in LangChain. It\n * extends the `BaseChain` class and has methods for adding observations\n * or memories to the agent's memory, scoring the importance of a memory,\n * reflecting on recent events to add synthesized memories, and generating\n * insights on a topic of reflection based on pertinent memories.\n */\nclass GenerativeAgentMemoryChain extends _chains_base_js__WEBPACK_IMPORTED_MODULE_3__.BaseChain {\n    static lc_name() {\n        return \"GenerativeAgentMemoryChain\";\n    }\n    constructor(llm, memoryRetriever, config) {\n        super();\n        Object.defineProperty(this, \"reflecting\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"reflectionThreshold\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"importanceWeight\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0.15\n        });\n        Object.defineProperty(this, \"memoryRetriever\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"llm\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"verbose\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"aggregateImportance\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0.0\n        });\n        this.llm = llm;\n        this.memoryRetriever = memoryRetriever;\n        this.reflectionThreshold = config.reflectionThreshold;\n        this.importanceWeight = config.importanceWeight ?? this.importanceWeight;\n        this.verbose = config.verbose ?? this.verbose;\n    }\n    _chainType() {\n        return \"generative_agent_memory\";\n    }\n    get inputKeys() {\n        return [\"memory_content\", \"now\", \"memory_metadata\"];\n    }\n    get outputKeys() {\n        return [\"output\"];\n    }\n    /**\n     * Method that creates a new LLMChain with the given prompt.\n     * @param prompt The PromptTemplate to use for the new LLMChain.\n     * @returns A new LLMChain instance.\n     */\n    chain(prompt) {\n        const chain = new _chains_llm_chain_js__WEBPACK_IMPORTED_MODULE_4__.LLMChain({\n            llm: this.llm,\n            prompt,\n            verbose: this.verbose,\n            outputKey: \"output\",\n        });\n        return chain;\n    }\n    async _call(values, runManager) {\n        const { memory_content: memoryContent, now } = values;\n        // add an observation or memory to the agent's memory\n        const importanceScore = await this.scoreMemoryImportance(memoryContent, runManager);\n        this.aggregateImportance += importanceScore;\n        const document = new _langchain_core_documents__WEBPACK_IMPORTED_MODULE_1__.Document({\n            pageContent: memoryContent,\n            metadata: {\n                importance: importanceScore,\n                ...values.memory_metadata,\n            },\n        });\n        await this.memoryRetriever.addDocuments([document]);\n        // after an agent has processed a certain amount of memories (as measured by aggregate importance),\n        // it is time to pause and reflect on recent events to add more synthesized memories to the agent's\n        // memory stream.\n        if (this.reflectionThreshold !== undefined &&\n            this.aggregateImportance > this.reflectionThreshold &&\n            !this.reflecting) {\n            console.log(\"Reflecting on current memories...\");\n            this.reflecting = true;\n            await this.pauseToReflect(now, runManager);\n            this.aggregateImportance = 0.0;\n            this.reflecting = false;\n        }\n        return { output: importanceScore };\n    }\n    /**\n     * Method that pauses the agent to reflect on recent events and generate\n     * new insights.\n     * @param now The current date.\n     * @param runManager The CallbackManagerForChainRun to use for the reflection.\n     * @returns An array of new insights as strings.\n     */\n    async pauseToReflect(now, runManager) {\n        if (this.verbose) {\n            console.log(\"Pausing to reflect...\");\n        }\n        const newInsights = [];\n        const topics = await this.getTopicsOfReflection(50, runManager);\n        for (const topic of topics) {\n            const insights = await this.getInsightsOnTopic(topic, now, runManager);\n            for (const insight of insights) {\n                // add memory\n                await this.call({\n                    memory_content: insight,\n                    now,\n                    memory_metadata: {\n                        source: \"reflection_insight\",\n                    },\n                }, runManager?.getChild(\"reflection_insight_memory\"));\n            }\n            newInsights.push(...insights);\n        }\n        return newInsights;\n    }\n    /**\n     * Method that scores the importance of a given memory.\n     * @param memoryContent The content of the memory to score.\n     * @param runManager The CallbackManagerForChainRun to use for scoring.\n     * @returns The importance score of the memory as a number.\n     */\n    async scoreMemoryImportance(memoryContent, runManager) {\n        // score the absolute importance of a given memory\n        const prompt = _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate.fromTemplate(\"On the scale of 1 to 10, where 1 is purely mundane\" +\n            \" (e.g., brushing teeth, making bed) and 10 is\" +\n            \" extremely poignant (e.g., a break up, college\" +\n            \" acceptance), rate the likely poignancy of the\" +\n            \" following piece of memory. Respond with a single integer.\" +\n            \"\\nMemory: {memory_content}\" +\n            \"\\nRating: \");\n        const score = await this.chain(prompt).run(memoryContent, runManager?.getChild(\"determine_importance\"));\n        const strippedScore = score.trim();\n        if (this.verbose) {\n            console.log(\"Importance score:\", strippedScore);\n        }\n        const match = strippedScore.match(/^\\D*(\\d+)/);\n        if (match) {\n            const capturedNumber = parseFloat(match[1]);\n            const result = (capturedNumber / 10) * this.importanceWeight;\n            return result;\n        }\n        else {\n            return 0.0;\n        }\n    }\n    /**\n     * Method that retrieves the topics of reflection based on the last K\n     * memories.\n     * @param lastK The number of most recent memories to consider for generating topics.\n     * @param runManager The CallbackManagerForChainRun to use for retrieving topics.\n     * @returns An array of topics of reflection as strings.\n     */\n    async getTopicsOfReflection(lastK, runManager) {\n        const prompt = _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate.fromTemplate(\"{observations}\\n\\n\" +\n            \"Given only the information above, what are the 3 most salient\" +\n            \" high-level questions we can answer about the subjects in\" +\n            \" the statements? Provide each question on a new line.\\n\\n\");\n        const observations = this.memoryRetriever.getMemoryStream().slice(-lastK);\n        const observationStr = observations\n            .map((o) => o.pageContent)\n            .join(\"\\n\");\n        const result = await this.chain(prompt).run(observationStr, runManager?.getChild(\"reflection_topics\"));\n        return GenerativeAgentMemoryChain.parseList(result);\n    }\n    /**\n     * Method that generates insights on a given topic of reflection based on\n     * pertinent memories.\n     * @param topic The topic of reflection.\n     * @param now The current date.\n     * @param runManager The CallbackManagerForChainRun to use for generating insights.\n     * @returns An array of insights as strings.\n     */\n    async getInsightsOnTopic(topic, now, runManager) {\n        // generate insights on a topic of reflection, based on pertinent memories\n        const prompt = _langchain_core_prompts__WEBPACK_IMPORTED_MODULE_0__.PromptTemplate.fromTemplate(\"Statements about {topic}\\n\" +\n            \"{related_statements}\\n\\n\" +\n            \"What 5 high-level insights can you infer from the above statements?\" +\n            \" (example format: insight (because of 1, 5, 3))\");\n        const relatedMemories = await this.fetchMemories(topic, now, runManager);\n        const relatedStatements = relatedMemories\n            .map((memory, index) => `${index + 1}. ${memory.pageContent}`)\n            .join(\"\\n\");\n        const result = await this.chain(prompt).call({\n            topic,\n            related_statements: relatedStatements,\n        }, runManager?.getChild(\"reflection_insights\"));\n        return GenerativeAgentMemoryChain.parseList(result.output); // added output\n    }\n    /**\n     * Method that parses a newline-separated string into a list of strings.\n     * @param text The newline-separated string to parse.\n     * @returns An array of strings.\n     */\n    static parseList(text) {\n        // parse a newine seperates string into a list of strings\n        return text.split(\"\\n\").map((s) => s.trim());\n    }\n    // TODO: Mock \"now\" to simulate different times\n    /**\n     * Method that fetches memories related to a given observation.\n     * @param observation The observation to fetch memories for.\n     * @param _now The current date.\n     * @param runManager The CallbackManagerForChainRun to use for fetching memories.\n     * @returns An array of Document instances representing the fetched memories.\n     */\n    async fetchMemories(observation, _now, runManager) {\n        return this.memoryRetriever.getRelevantDocuments(observation, runManager?.getChild(\"memory_retriever\"));\n    }\n}\n/**\n * Class that manages the memory of a generative agent in LangChain. It\n * extends the `BaseMemory` class and has methods for adding a memory,\n * formatting memories, getting memories until a token limit is reached,\n * loading memory variables, saving the context of a model run to memory,\n * and clearing memory contents.\n * @example\n * ```typescript\n * const createNewMemoryRetriever = async () => {\n *   const vectorStore = new MemoryVectorStore(new OpenAIEmbeddings());\n *   const retriever = new TimeWeightedVectorStoreRetriever({\n *     vectorStore,\n *     otherScoreKeys: [\"importance\"],\n *     k: 15,\n *   });\n *   return retriever;\n * };\n * const tommiesMemory = new GenerativeAgentMemory(\n *   llm,\n *   await createNewMemoryRetriever(),\n *   { reflectionThreshold: 8 },\n * );\n * const summary = await tommiesMemory.getSummary();\n * ```\n */\nclass GenerativeAgentMemory extends _langchain_core_memory__WEBPACK_IMPORTED_MODULE_2__.BaseMemory {\n    constructor(llm, memoryRetriever, config) {\n        super();\n        Object.defineProperty(this, \"llm\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"memoryRetriever\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"verbose\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"reflectionThreshold\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"maxTokensLimit\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 1200\n        });\n        Object.defineProperty(this, \"queriesKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"queries\"\n        });\n        Object.defineProperty(this, \"mostRecentMemoriesTokenKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"recent_memories_token\"\n        });\n        Object.defineProperty(this, \"addMemoryKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"addMemory\"\n        });\n        Object.defineProperty(this, \"relevantMemoriesKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"relevant_memories\"\n        });\n        Object.defineProperty(this, \"relevantMemoriesSimpleKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"relevant_memories_simple\"\n        });\n        Object.defineProperty(this, \"mostRecentMemoriesKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"most_recent_memories\"\n        });\n        Object.defineProperty(this, \"nowKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"now\"\n        });\n        Object.defineProperty(this, \"memoryChain\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.llm = llm;\n        this.memoryRetriever = memoryRetriever;\n        this.verbose = config?.verbose ?? this.verbose;\n        this.reflectionThreshold =\n            config?.reflectionThreshold ?? this.reflectionThreshold;\n        this.maxTokensLimit = config?.maxTokensLimit ?? this.maxTokensLimit;\n        this.memoryChain = new GenerativeAgentMemoryChain(llm, memoryRetriever, {\n            reflectionThreshold: config?.reflectionThreshold,\n            importanceWeight: config?.importanceWeight,\n        });\n    }\n    /**\n     * Method that returns the key for relevant memories.\n     * @returns The key for relevant memories as a string.\n     */\n    getRelevantMemoriesKey() {\n        return this.relevantMemoriesKey;\n    }\n    /**\n     * Method that returns the key for the most recent memories token.\n     * @returns The key for the most recent memories token as a string.\n     */\n    getMostRecentMemoriesTokenKey() {\n        return this.mostRecentMemoriesTokenKey;\n    }\n    /**\n     * Method that returns the key for adding a memory.\n     * @returns The key for adding a memory as a string.\n     */\n    getAddMemoryKey() {\n        return this.addMemoryKey;\n    }\n    /**\n     * Method that returns the key for the current time.\n     * @returns The key for the current time as a string.\n     */\n    getCurrentTimeKey() {\n        return this.nowKey;\n    }\n    get memoryKeys() {\n        // Return an array of memory keys\n        return [this.relevantMemoriesKey, this.mostRecentMemoriesKey];\n    }\n    /**\n     * Method that adds a memory to the agent's memory.\n     * @param memoryContent The content of the memory to add.\n     * @param now The current date.\n     * @param metadata The metadata for the memory.\n     * @param callbacks The Callbacks to use for adding the memory.\n     * @returns The result of the memory addition.\n     */\n    async addMemory(memoryContent, now, metadata, callbacks) {\n        return this.memoryChain.call({ memory_content: memoryContent, now, memory_metadata: metadata }, callbacks);\n    }\n    /**\n     * Method that formats the given relevant memories in detail.\n     * @param relevantMemories The relevant memories to format.\n     * @returns The formatted memories as a string.\n     */\n    formatMemoriesDetail(relevantMemories) {\n        if (!relevantMemories.length) {\n            return \"No relevant information.\";\n        }\n        const contentStrings = new Set();\n        const content = [];\n        for (const memory of relevantMemories) {\n            if (memory.pageContent in contentStrings) {\n                continue;\n            }\n            contentStrings.add(memory.pageContent);\n            const createdTime = memory.metadata.created_at.toLocaleString(\"en-US\", {\n                month: \"long\",\n                day: \"numeric\",\n                year: \"numeric\",\n                hour: \"numeric\",\n                minute: \"numeric\",\n                hour12: true,\n            });\n            content.push(`${createdTime}: ${memory.pageContent.trim()}`);\n        }\n        const joinedContent = content.map((mem) => `${mem}`).join(\"\\n\");\n        return joinedContent;\n    }\n    /**\n     * Method that formats the given relevant memories in a simple manner.\n     * @param relevantMemories The relevant memories to format.\n     * @returns The formatted memories as a string.\n     */\n    formatMemoriesSimple(relevantMemories) {\n        const joinedContent = relevantMemories\n            .map((mem) => `${mem.pageContent}`)\n            .join(\"; \");\n        return joinedContent;\n    }\n    /**\n     * Method that retrieves memories until a token limit is reached.\n     * @param consumedTokens The number of tokens consumed so far.\n     * @returns The memories as a string.\n     */\n    async getMemoriesUntilLimit(consumedTokens) {\n        // reduce the number of tokens in the documents\n        const result = [];\n        for (const doc of this.memoryRetriever\n            .getMemoryStream()\n            .slice()\n            .reverse()) {\n            if (consumedTokens >= this.maxTokensLimit) {\n                if (this.verbose) {\n                    console.log(\"Exceeding max tokens for LLM, filtering memories\");\n                }\n                break;\n            }\n            // eslint-disable-next-line no-param-reassign\n            consumedTokens += await this.llm.getNumTokens(doc.pageContent);\n            if (consumedTokens < this.maxTokensLimit) {\n                result.push(doc);\n            }\n        }\n        return this.formatMemoriesSimple(result);\n    }\n    get memoryVariables() {\n        // input keys this memory class will load dynamically\n        return [];\n    }\n    /**\n     * Method that loads memory variables based on the given inputs.\n     * @param inputs The inputs to use for loading memory variables.\n     * @returns An object containing the loaded memory variables.\n     */\n    async loadMemoryVariables(inputs) {\n        const queries = inputs[this.queriesKey];\n        const now = inputs[this.nowKey];\n        if (queries !== undefined) {\n            const relevantMemories = (await Promise.all(queries.map((query) => this.memoryChain.fetchMemories(query, now)))).flat();\n            return {\n                [this.relevantMemoriesKey]: this.formatMemoriesDetail(relevantMemories),\n                [this.relevantMemoriesSimpleKey]: this.formatMemoriesSimple(relevantMemories),\n            };\n        }\n        const mostRecentMemoriesToken = inputs[this.mostRecentMemoriesTokenKey];\n        if (mostRecentMemoriesToken !== undefined) {\n            return {\n                [this.mostRecentMemoriesKey]: await this.getMemoriesUntilLimit(mostRecentMemoriesToken),\n            };\n        }\n        return {};\n    }\n    /**\n     * Method that saves the context of a model run to memory.\n     * @param _inputs The inputs of the model run.\n     * @param outputs The outputs of the model run.\n     * @returns Nothing.\n     */\n    async saveContext(_inputs, outputs) {\n        // save the context of this model run to memory\n        const mem = outputs[this.addMemoryKey];\n        const now = outputs[this.nowKey];\n        if (mem) {\n            await this.addMemory(mem, now, {});\n        }\n    }\n    /**\n     * Method that clears the memory contents.\n     * @returns Nothing.\n     */\n    clear() {\n        // TODO: clear memory contents\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvZXhwZXJpbWVudGFsL2dlbmVyYXRpdmVfYWdlbnRzL2dlbmVyYXRpdmVfYWdlbnRfbWVtb3J5LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUF5RDtBQUNKO0FBQ0Q7QUFDSDtBQUNJO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLHNEQUFTO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiwwREFBUTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IscUNBQXFDO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QiwrREFBUTtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsbUVBQWM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZUFBZTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsbUVBQWMsZ0JBQWdCLGFBQWE7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixtRUFBYyxpQ0FBaUMsTUFBTTtBQUM1RSxjQUFjLG1CQUFtQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QyxVQUFVLElBQUksbUJBQW1CO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULG9FQUFvRTtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sd0JBQXdCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ08sb0NBQW9DLDhEQUFVO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsK0RBQStEO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYiw0QkFBNEIsWUFBWSxJQUFJLDBCQUEwQjtBQUN0RTtBQUNBLHNEQUFzRCxJQUFJO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixnQkFBZ0I7QUFDN0MscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvbXBhbmlvbi8uL25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9leHBlcmltZW50YWwvZ2VuZXJhdGl2ZV9hZ2VudHMvZ2VuZXJhdGl2ZV9hZ2VudF9tZW1vcnkuanM/MzAyMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcm9tcHRUZW1wbGF0ZSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvcHJvbXB0c1wiO1xuaW1wb3J0IHsgRG9jdW1lbnQgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL2RvY3VtZW50c1wiO1xuaW1wb3J0IHsgQmFzZU1lbW9yeSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvbWVtb3J5XCI7XG5pbXBvcnQgeyBCYXNlQ2hhaW4gfSBmcm9tIFwiLi4vLi4vY2hhaW5zL2Jhc2UuanNcIjtcbmltcG9ydCB7IExMTUNoYWluIH0gZnJvbSBcIi4uLy4uL2NoYWlucy9sbG1fY2hhaW4uanNcIjtcbi8qKlxuICogQ2xhc3MgdGhhdCBtYW5hZ2VzIHRoZSBtZW1vcnkgb2YgYSBnZW5lcmF0aXZlIGFnZW50IGluIExhbmdDaGFpbi4gSXRcbiAqIGV4dGVuZHMgdGhlIGBCYXNlQ2hhaW5gIGNsYXNzIGFuZCBoYXMgbWV0aG9kcyBmb3IgYWRkaW5nIG9ic2VydmF0aW9uc1xuICogb3IgbWVtb3JpZXMgdG8gdGhlIGFnZW50J3MgbWVtb3J5LCBzY29yaW5nIHRoZSBpbXBvcnRhbmNlIG9mIGEgbWVtb3J5LFxuICogcmVmbGVjdGluZyBvbiByZWNlbnQgZXZlbnRzIHRvIGFkZCBzeW50aGVzaXplZCBtZW1vcmllcywgYW5kIGdlbmVyYXRpbmdcbiAqIGluc2lnaHRzIG9uIGEgdG9waWMgb2YgcmVmbGVjdGlvbiBiYXNlZCBvbiBwZXJ0aW5lbnQgbWVtb3JpZXMuXG4gKi9cbmNsYXNzIEdlbmVyYXRpdmVBZ2VudE1lbW9yeUNoYWluIGV4dGVuZHMgQmFzZUNoYWluIHtcbiAgICBzdGF0aWMgbGNfbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiR2VuZXJhdGl2ZUFnZW50TWVtb3J5Q2hhaW5cIjtcbiAgICB9XG4gICAgY29uc3RydWN0b3IobGxtLCBtZW1vcnlSZXRyaWV2ZXIsIGNvbmZpZykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJyZWZsZWN0aW5nXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwicmVmbGVjdGlvblRocmVzaG9sZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJpbXBvcnRhbmNlV2VpZ2h0XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiAwLjE1XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJtZW1vcnlSZXRyaWV2ZXJcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibGxtXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInZlcmJvc2VcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJhZ2dyZWdhdGVJbXBvcnRhbmNlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiAwLjBcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubGxtID0gbGxtO1xuICAgICAgICB0aGlzLm1lbW9yeVJldHJpZXZlciA9IG1lbW9yeVJldHJpZXZlcjtcbiAgICAgICAgdGhpcy5yZWZsZWN0aW9uVGhyZXNob2xkID0gY29uZmlnLnJlZmxlY3Rpb25UaHJlc2hvbGQ7XG4gICAgICAgIHRoaXMuaW1wb3J0YW5jZVdlaWdodCA9IGNvbmZpZy5pbXBvcnRhbmNlV2VpZ2h0ID8/IHRoaXMuaW1wb3J0YW5jZVdlaWdodDtcbiAgICAgICAgdGhpcy52ZXJib3NlID0gY29uZmlnLnZlcmJvc2UgPz8gdGhpcy52ZXJib3NlO1xuICAgIH1cbiAgICBfY2hhaW5UeXBlKCkge1xuICAgICAgICByZXR1cm4gXCJnZW5lcmF0aXZlX2FnZW50X21lbW9yeVwiO1xuICAgIH1cbiAgICBnZXQgaW5wdXRLZXlzKCkge1xuICAgICAgICByZXR1cm4gW1wibWVtb3J5X2NvbnRlbnRcIiwgXCJub3dcIiwgXCJtZW1vcnlfbWV0YWRhdGFcIl07XG4gICAgfVxuICAgIGdldCBvdXRwdXRLZXlzKCkge1xuICAgICAgICByZXR1cm4gW1wib3V0cHV0XCJdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNZXRob2QgdGhhdCBjcmVhdGVzIGEgbmV3IExMTUNoYWluIHdpdGggdGhlIGdpdmVuIHByb21wdC5cbiAgICAgKiBAcGFyYW0gcHJvbXB0IFRoZSBQcm9tcHRUZW1wbGF0ZSB0byB1c2UgZm9yIHRoZSBuZXcgTExNQ2hhaW4uXG4gICAgICogQHJldHVybnMgQSBuZXcgTExNQ2hhaW4gaW5zdGFuY2UuXG4gICAgICovXG4gICAgY2hhaW4ocHJvbXB0KSB7XG4gICAgICAgIGNvbnN0IGNoYWluID0gbmV3IExMTUNoYWluKHtcbiAgICAgICAgICAgIGxsbTogdGhpcy5sbG0sXG4gICAgICAgICAgICBwcm9tcHQsXG4gICAgICAgICAgICB2ZXJib3NlOiB0aGlzLnZlcmJvc2UsXG4gICAgICAgICAgICBvdXRwdXRLZXk6IFwib3V0cHV0XCIsXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2hhaW47XG4gICAgfVxuICAgIGFzeW5jIF9jYWxsKHZhbHVlcywgcnVuTWFuYWdlcikge1xuICAgICAgICBjb25zdCB7IG1lbW9yeV9jb250ZW50OiBtZW1vcnlDb250ZW50LCBub3cgfSA9IHZhbHVlcztcbiAgICAgICAgLy8gYWRkIGFuIG9ic2VydmF0aW9uIG9yIG1lbW9yeSB0byB0aGUgYWdlbnQncyBtZW1vcnlcbiAgICAgICAgY29uc3QgaW1wb3J0YW5jZVNjb3JlID0gYXdhaXQgdGhpcy5zY29yZU1lbW9yeUltcG9ydGFuY2UobWVtb3J5Q29udGVudCwgcnVuTWFuYWdlcik7XG4gICAgICAgIHRoaXMuYWdncmVnYXRlSW1wb3J0YW5jZSArPSBpbXBvcnRhbmNlU2NvcmU7XG4gICAgICAgIGNvbnN0IGRvY3VtZW50ID0gbmV3IERvY3VtZW50KHtcbiAgICAgICAgICAgIHBhZ2VDb250ZW50OiBtZW1vcnlDb250ZW50LFxuICAgICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgICAgICBpbXBvcnRhbmNlOiBpbXBvcnRhbmNlU2NvcmUsXG4gICAgICAgICAgICAgICAgLi4udmFsdWVzLm1lbW9yeV9tZXRhZGF0YSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCB0aGlzLm1lbW9yeVJldHJpZXZlci5hZGREb2N1bWVudHMoW2RvY3VtZW50XSk7XG4gICAgICAgIC8vIGFmdGVyIGFuIGFnZW50IGhhcyBwcm9jZXNzZWQgYSBjZXJ0YWluIGFtb3VudCBvZiBtZW1vcmllcyAoYXMgbWVhc3VyZWQgYnkgYWdncmVnYXRlIGltcG9ydGFuY2UpLFxuICAgICAgICAvLyBpdCBpcyB0aW1lIHRvIHBhdXNlIGFuZCByZWZsZWN0IG9uIHJlY2VudCBldmVudHMgdG8gYWRkIG1vcmUgc3ludGhlc2l6ZWQgbWVtb3JpZXMgdG8gdGhlIGFnZW50J3NcbiAgICAgICAgLy8gbWVtb3J5IHN0cmVhbS5cbiAgICAgICAgaWYgKHRoaXMucmVmbGVjdGlvblRocmVzaG9sZCAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICB0aGlzLmFnZ3JlZ2F0ZUltcG9ydGFuY2UgPiB0aGlzLnJlZmxlY3Rpb25UaHJlc2hvbGQgJiZcbiAgICAgICAgICAgICF0aGlzLnJlZmxlY3RpbmcpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVmbGVjdGluZyBvbiBjdXJyZW50IG1lbW9yaWVzLi4uXCIpO1xuICAgICAgICAgICAgdGhpcy5yZWZsZWN0aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGF1c2VUb1JlZmxlY3Qobm93LCBydW5NYW5hZ2VyKTtcbiAgICAgICAgICAgIHRoaXMuYWdncmVnYXRlSW1wb3J0YW5jZSA9IDAuMDtcbiAgICAgICAgICAgIHRoaXMucmVmbGVjdGluZyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IG91dHB1dDogaW1wb3J0YW5jZVNjb3JlIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1ldGhvZCB0aGF0IHBhdXNlcyB0aGUgYWdlbnQgdG8gcmVmbGVjdCBvbiByZWNlbnQgZXZlbnRzIGFuZCBnZW5lcmF0ZVxuICAgICAqIG5ldyBpbnNpZ2h0cy5cbiAgICAgKiBAcGFyYW0gbm93IFRoZSBjdXJyZW50IGRhdGUuXG4gICAgICogQHBhcmFtIHJ1bk1hbmFnZXIgVGhlIENhbGxiYWNrTWFuYWdlckZvckNoYWluUnVuIHRvIHVzZSBmb3IgdGhlIHJlZmxlY3Rpb24uXG4gICAgICogQHJldHVybnMgQW4gYXJyYXkgb2YgbmV3IGluc2lnaHRzIGFzIHN0cmluZ3MuXG4gICAgICovXG4gICAgYXN5bmMgcGF1c2VUb1JlZmxlY3Qobm93LCBydW5NYW5hZ2VyKSB7XG4gICAgICAgIGlmICh0aGlzLnZlcmJvc2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUGF1c2luZyB0byByZWZsZWN0Li4uXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5ld0luc2lnaHRzID0gW107XG4gICAgICAgIGNvbnN0IHRvcGljcyA9IGF3YWl0IHRoaXMuZ2V0VG9waWNzT2ZSZWZsZWN0aW9uKDUwLCBydW5NYW5hZ2VyKTtcbiAgICAgICAgZm9yIChjb25zdCB0b3BpYyBvZiB0b3BpY3MpIHtcbiAgICAgICAgICAgIGNvbnN0IGluc2lnaHRzID0gYXdhaXQgdGhpcy5nZXRJbnNpZ2h0c09uVG9waWModG9waWMsIG5vdywgcnVuTWFuYWdlcik7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGluc2lnaHQgb2YgaW5zaWdodHMpIHtcbiAgICAgICAgICAgICAgICAvLyBhZGQgbWVtb3J5XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5jYWxsKHtcbiAgICAgICAgICAgICAgICAgICAgbWVtb3J5X2NvbnRlbnQ6IGluc2lnaHQsXG4gICAgICAgICAgICAgICAgICAgIG5vdyxcbiAgICAgICAgICAgICAgICAgICAgbWVtb3J5X21ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IFwicmVmbGVjdGlvbl9pbnNpZ2h0XCIsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSwgcnVuTWFuYWdlcj8uZ2V0Q2hpbGQoXCJyZWZsZWN0aW9uX2luc2lnaHRfbWVtb3J5XCIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld0luc2lnaHRzLnB1c2goLi4uaW5zaWdodHMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdJbnNpZ2h0cztcbiAgICB9XG4gICAgLyoqXG4gICAgICogTWV0aG9kIHRoYXQgc2NvcmVzIHRoZSBpbXBvcnRhbmNlIG9mIGEgZ2l2ZW4gbWVtb3J5LlxuICAgICAqIEBwYXJhbSBtZW1vcnlDb250ZW50IFRoZSBjb250ZW50IG9mIHRoZSBtZW1vcnkgdG8gc2NvcmUuXG4gICAgICogQHBhcmFtIHJ1bk1hbmFnZXIgVGhlIENhbGxiYWNrTWFuYWdlckZvckNoYWluUnVuIHRvIHVzZSBmb3Igc2NvcmluZy5cbiAgICAgKiBAcmV0dXJucyBUaGUgaW1wb3J0YW5jZSBzY29yZSBvZiB0aGUgbWVtb3J5IGFzIGEgbnVtYmVyLlxuICAgICAqL1xuICAgIGFzeW5jIHNjb3JlTWVtb3J5SW1wb3J0YW5jZShtZW1vcnlDb250ZW50LCBydW5NYW5hZ2VyKSB7XG4gICAgICAgIC8vIHNjb3JlIHRoZSBhYnNvbHV0ZSBpbXBvcnRhbmNlIG9mIGEgZ2l2ZW4gbWVtb3J5XG4gICAgICAgIGNvbnN0IHByb21wdCA9IFByb21wdFRlbXBsYXRlLmZyb21UZW1wbGF0ZShcIk9uIHRoZSBzY2FsZSBvZiAxIHRvIDEwLCB3aGVyZSAxIGlzIHB1cmVseSBtdW5kYW5lXCIgK1xuICAgICAgICAgICAgXCIgKGUuZy4sIGJydXNoaW5nIHRlZXRoLCBtYWtpbmcgYmVkKSBhbmQgMTAgaXNcIiArXG4gICAgICAgICAgICBcIiBleHRyZW1lbHkgcG9pZ25hbnQgKGUuZy4sIGEgYnJlYWsgdXAsIGNvbGxlZ2VcIiArXG4gICAgICAgICAgICBcIiBhY2NlcHRhbmNlKSwgcmF0ZSB0aGUgbGlrZWx5IHBvaWduYW5jeSBvZiB0aGVcIiArXG4gICAgICAgICAgICBcIiBmb2xsb3dpbmcgcGllY2Ugb2YgbWVtb3J5LiBSZXNwb25kIHdpdGggYSBzaW5nbGUgaW50ZWdlci5cIiArXG4gICAgICAgICAgICBcIlxcbk1lbW9yeToge21lbW9yeV9jb250ZW50fVwiICtcbiAgICAgICAgICAgIFwiXFxuUmF0aW5nOiBcIik7XG4gICAgICAgIGNvbnN0IHNjb3JlID0gYXdhaXQgdGhpcy5jaGFpbihwcm9tcHQpLnJ1bihtZW1vcnlDb250ZW50LCBydW5NYW5hZ2VyPy5nZXRDaGlsZChcImRldGVybWluZV9pbXBvcnRhbmNlXCIpKTtcbiAgICAgICAgY29uc3Qgc3RyaXBwZWRTY29yZSA9IHNjb3JlLnRyaW0oKTtcbiAgICAgICAgaWYgKHRoaXMudmVyYm9zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJJbXBvcnRhbmNlIHNjb3JlOlwiLCBzdHJpcHBlZFNjb3JlKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBtYXRjaCA9IHN0cmlwcGVkU2NvcmUubWF0Y2goL15cXEQqKFxcZCspLyk7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgY29uc3QgY2FwdHVyZWROdW1iZXIgPSBwYXJzZUZsb2F0KG1hdGNoWzFdKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IChjYXB0dXJlZE51bWJlciAvIDEwKSAqIHRoaXMuaW1wb3J0YW5jZVdlaWdodDtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gMC4wO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1ldGhvZCB0aGF0IHJldHJpZXZlcyB0aGUgdG9waWNzIG9mIHJlZmxlY3Rpb24gYmFzZWQgb24gdGhlIGxhc3QgS1xuICAgICAqIG1lbW9yaWVzLlxuICAgICAqIEBwYXJhbSBsYXN0SyBUaGUgbnVtYmVyIG9mIG1vc3QgcmVjZW50IG1lbW9yaWVzIHRvIGNvbnNpZGVyIGZvciBnZW5lcmF0aW5nIHRvcGljcy5cbiAgICAgKiBAcGFyYW0gcnVuTWFuYWdlciBUaGUgQ2FsbGJhY2tNYW5hZ2VyRm9yQ2hhaW5SdW4gdG8gdXNlIGZvciByZXRyaWV2aW5nIHRvcGljcy5cbiAgICAgKiBAcmV0dXJucyBBbiBhcnJheSBvZiB0b3BpY3Mgb2YgcmVmbGVjdGlvbiBhcyBzdHJpbmdzLlxuICAgICAqL1xuICAgIGFzeW5jIGdldFRvcGljc09mUmVmbGVjdGlvbihsYXN0SywgcnVuTWFuYWdlcikge1xuICAgICAgICBjb25zdCBwcm9tcHQgPSBQcm9tcHRUZW1wbGF0ZS5mcm9tVGVtcGxhdGUoXCJ7b2JzZXJ2YXRpb25zfVxcblxcblwiICtcbiAgICAgICAgICAgIFwiR2l2ZW4gb25seSB0aGUgaW5mb3JtYXRpb24gYWJvdmUsIHdoYXQgYXJlIHRoZSAzIG1vc3Qgc2FsaWVudFwiICtcbiAgICAgICAgICAgIFwiIGhpZ2gtbGV2ZWwgcXVlc3Rpb25zIHdlIGNhbiBhbnN3ZXIgYWJvdXQgdGhlIHN1YmplY3RzIGluXCIgK1xuICAgICAgICAgICAgXCIgdGhlIHN0YXRlbWVudHM/IFByb3ZpZGUgZWFjaCBxdWVzdGlvbiBvbiBhIG5ldyBsaW5lLlxcblxcblwiKTtcbiAgICAgICAgY29uc3Qgb2JzZXJ2YXRpb25zID0gdGhpcy5tZW1vcnlSZXRyaWV2ZXIuZ2V0TWVtb3J5U3RyZWFtKCkuc2xpY2UoLWxhc3RLKTtcbiAgICAgICAgY29uc3Qgb2JzZXJ2YXRpb25TdHIgPSBvYnNlcnZhdGlvbnNcbiAgICAgICAgICAgIC5tYXAoKG8pID0+IG8ucGFnZUNvbnRlbnQpXG4gICAgICAgICAgICAuam9pbihcIlxcblwiKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jaGFpbihwcm9tcHQpLnJ1bihvYnNlcnZhdGlvblN0ciwgcnVuTWFuYWdlcj8uZ2V0Q2hpbGQoXCJyZWZsZWN0aW9uX3RvcGljc1wiKSk7XG4gICAgICAgIHJldHVybiBHZW5lcmF0aXZlQWdlbnRNZW1vcnlDaGFpbi5wYXJzZUxpc3QocmVzdWx0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTWV0aG9kIHRoYXQgZ2VuZXJhdGVzIGluc2lnaHRzIG9uIGEgZ2l2ZW4gdG9waWMgb2YgcmVmbGVjdGlvbiBiYXNlZCBvblxuICAgICAqIHBlcnRpbmVudCBtZW1vcmllcy5cbiAgICAgKiBAcGFyYW0gdG9waWMgVGhlIHRvcGljIG9mIHJlZmxlY3Rpb24uXG4gICAgICogQHBhcmFtIG5vdyBUaGUgY3VycmVudCBkYXRlLlxuICAgICAqIEBwYXJhbSBydW5NYW5hZ2VyIFRoZSBDYWxsYmFja01hbmFnZXJGb3JDaGFpblJ1biB0byB1c2UgZm9yIGdlbmVyYXRpbmcgaW5zaWdodHMuXG4gICAgICogQHJldHVybnMgQW4gYXJyYXkgb2YgaW5zaWdodHMgYXMgc3RyaW5ncy5cbiAgICAgKi9cbiAgICBhc3luYyBnZXRJbnNpZ2h0c09uVG9waWModG9waWMsIG5vdywgcnVuTWFuYWdlcikge1xuICAgICAgICAvLyBnZW5lcmF0ZSBpbnNpZ2h0cyBvbiBhIHRvcGljIG9mIHJlZmxlY3Rpb24sIGJhc2VkIG9uIHBlcnRpbmVudCBtZW1vcmllc1xuICAgICAgICBjb25zdCBwcm9tcHQgPSBQcm9tcHRUZW1wbGF0ZS5mcm9tVGVtcGxhdGUoXCJTdGF0ZW1lbnRzIGFib3V0IHt0b3BpY31cXG5cIiArXG4gICAgICAgICAgICBcIntyZWxhdGVkX3N0YXRlbWVudHN9XFxuXFxuXCIgK1xuICAgICAgICAgICAgXCJXaGF0IDUgaGlnaC1sZXZlbCBpbnNpZ2h0cyBjYW4geW91IGluZmVyIGZyb20gdGhlIGFib3ZlIHN0YXRlbWVudHM/XCIgK1xuICAgICAgICAgICAgXCIgKGV4YW1wbGUgZm9ybWF0OiBpbnNpZ2h0IChiZWNhdXNlIG9mIDEsIDUsIDMpKVwiKTtcbiAgICAgICAgY29uc3QgcmVsYXRlZE1lbW9yaWVzID0gYXdhaXQgdGhpcy5mZXRjaE1lbW9yaWVzKHRvcGljLCBub3csIHJ1bk1hbmFnZXIpO1xuICAgICAgICBjb25zdCByZWxhdGVkU3RhdGVtZW50cyA9IHJlbGF0ZWRNZW1vcmllc1xuICAgICAgICAgICAgLm1hcCgobWVtb3J5LCBpbmRleCkgPT4gYCR7aW5kZXggKyAxfS4gJHttZW1vcnkucGFnZUNvbnRlbnR9YClcbiAgICAgICAgICAgIC5qb2luKFwiXFxuXCIpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmNoYWluKHByb21wdCkuY2FsbCh7XG4gICAgICAgICAgICB0b3BpYyxcbiAgICAgICAgICAgIHJlbGF0ZWRfc3RhdGVtZW50czogcmVsYXRlZFN0YXRlbWVudHMsXG4gICAgICAgIH0sIHJ1bk1hbmFnZXI/LmdldENoaWxkKFwicmVmbGVjdGlvbl9pbnNpZ2h0c1wiKSk7XG4gICAgICAgIHJldHVybiBHZW5lcmF0aXZlQWdlbnRNZW1vcnlDaGFpbi5wYXJzZUxpc3QocmVzdWx0Lm91dHB1dCk7IC8vIGFkZGVkIG91dHB1dFxuICAgIH1cbiAgICAvKipcbiAgICAgKiBNZXRob2QgdGhhdCBwYXJzZXMgYSBuZXdsaW5lLXNlcGFyYXRlZCBzdHJpbmcgaW50byBhIGxpc3Qgb2Ygc3RyaW5ncy5cbiAgICAgKiBAcGFyYW0gdGV4dCBUaGUgbmV3bGluZS1zZXBhcmF0ZWQgc3RyaW5nIHRvIHBhcnNlLlxuICAgICAqIEByZXR1cm5zIEFuIGFycmF5IG9mIHN0cmluZ3MuXG4gICAgICovXG4gICAgc3RhdGljIHBhcnNlTGlzdCh0ZXh0KSB7XG4gICAgICAgIC8vIHBhcnNlIGEgbmV3aW5lIHNlcGVyYXRlcyBzdHJpbmcgaW50byBhIGxpc3Qgb2Ygc3RyaW5nc1xuICAgICAgICByZXR1cm4gdGV4dC5zcGxpdChcIlxcblwiKS5tYXAoKHMpID0+IHMudHJpbSgpKTtcbiAgICB9XG4gICAgLy8gVE9ETzogTW9jayBcIm5vd1wiIHRvIHNpbXVsYXRlIGRpZmZlcmVudCB0aW1lc1xuICAgIC8qKlxuICAgICAqIE1ldGhvZCB0aGF0IGZldGNoZXMgbWVtb3JpZXMgcmVsYXRlZCB0byBhIGdpdmVuIG9ic2VydmF0aW9uLlxuICAgICAqIEBwYXJhbSBvYnNlcnZhdGlvbiBUaGUgb2JzZXJ2YXRpb24gdG8gZmV0Y2ggbWVtb3JpZXMgZm9yLlxuICAgICAqIEBwYXJhbSBfbm93IFRoZSBjdXJyZW50IGRhdGUuXG4gICAgICogQHBhcmFtIHJ1bk1hbmFnZXIgVGhlIENhbGxiYWNrTWFuYWdlckZvckNoYWluUnVuIHRvIHVzZSBmb3IgZmV0Y2hpbmcgbWVtb3JpZXMuXG4gICAgICogQHJldHVybnMgQW4gYXJyYXkgb2YgRG9jdW1lbnQgaW5zdGFuY2VzIHJlcHJlc2VudGluZyB0aGUgZmV0Y2hlZCBtZW1vcmllcy5cbiAgICAgKi9cbiAgICBhc3luYyBmZXRjaE1lbW9yaWVzKG9ic2VydmF0aW9uLCBfbm93LCBydW5NYW5hZ2VyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1lbW9yeVJldHJpZXZlci5nZXRSZWxldmFudERvY3VtZW50cyhvYnNlcnZhdGlvbiwgcnVuTWFuYWdlcj8uZ2V0Q2hpbGQoXCJtZW1vcnlfcmV0cmlldmVyXCIpKTtcbiAgICB9XG59XG4vKipcbiAqIENsYXNzIHRoYXQgbWFuYWdlcyB0aGUgbWVtb3J5IG9mIGEgZ2VuZXJhdGl2ZSBhZ2VudCBpbiBMYW5nQ2hhaW4uIEl0XG4gKiBleHRlbmRzIHRoZSBgQmFzZU1lbW9yeWAgY2xhc3MgYW5kIGhhcyBtZXRob2RzIGZvciBhZGRpbmcgYSBtZW1vcnksXG4gKiBmb3JtYXR0aW5nIG1lbW9yaWVzLCBnZXR0aW5nIG1lbW9yaWVzIHVudGlsIGEgdG9rZW4gbGltaXQgaXMgcmVhY2hlZCxcbiAqIGxvYWRpbmcgbWVtb3J5IHZhcmlhYmxlcywgc2F2aW5nIHRoZSBjb250ZXh0IG9mIGEgbW9kZWwgcnVuIHRvIG1lbW9yeSxcbiAqIGFuZCBjbGVhcmluZyBtZW1vcnkgY29udGVudHMuXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgY3JlYXRlTmV3TWVtb3J5UmV0cmlldmVyID0gYXN5bmMgKCkgPT4ge1xuICogICBjb25zdCB2ZWN0b3JTdG9yZSA9IG5ldyBNZW1vcnlWZWN0b3JTdG9yZShuZXcgT3BlbkFJRW1iZWRkaW5ncygpKTtcbiAqICAgY29uc3QgcmV0cmlldmVyID0gbmV3IFRpbWVXZWlnaHRlZFZlY3RvclN0b3JlUmV0cmlldmVyKHtcbiAqICAgICB2ZWN0b3JTdG9yZSxcbiAqICAgICBvdGhlclNjb3JlS2V5czogW1wiaW1wb3J0YW5jZVwiXSxcbiAqICAgICBrOiAxNSxcbiAqICAgfSk7XG4gKiAgIHJldHVybiByZXRyaWV2ZXI7XG4gKiB9O1xuICogY29uc3QgdG9tbWllc01lbW9yeSA9IG5ldyBHZW5lcmF0aXZlQWdlbnRNZW1vcnkoXG4gKiAgIGxsbSxcbiAqICAgYXdhaXQgY3JlYXRlTmV3TWVtb3J5UmV0cmlldmVyKCksXG4gKiAgIHsgcmVmbGVjdGlvblRocmVzaG9sZDogOCB9LFxuICogKTtcbiAqIGNvbnN0IHN1bW1hcnkgPSBhd2FpdCB0b21taWVzTWVtb3J5LmdldFN1bW1hcnkoKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgR2VuZXJhdGl2ZUFnZW50TWVtb3J5IGV4dGVuZHMgQmFzZU1lbW9yeSB7XG4gICAgY29uc3RydWN0b3IobGxtLCBtZW1vcnlSZXRyaWV2ZXIsIGNvbmZpZykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJsbG1cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibWVtb3J5UmV0cmlldmVyXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInZlcmJvc2VcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwicmVmbGVjdGlvblRocmVzaG9sZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJtYXhUb2tlbnNMaW1pdFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogMTIwMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwicXVlcmllc0tleVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogXCJxdWVyaWVzXCJcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1vc3RSZWNlbnRNZW1vcmllc1Rva2VuS2V5XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBcInJlY2VudF9tZW1vcmllc190b2tlblwiXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJhZGRNZW1vcnlLZXlcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IFwiYWRkTWVtb3J5XCJcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInJlbGV2YW50TWVtb3JpZXNLZXlcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IFwicmVsZXZhbnRfbWVtb3JpZXNcIlxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwicmVsZXZhbnRNZW1vcmllc1NpbXBsZUtleVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogXCJyZWxldmFudF9tZW1vcmllc19zaW1wbGVcIlxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibW9zdFJlY2VudE1lbW9yaWVzS2V5XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBcIm1vc3RfcmVjZW50X21lbW9yaWVzXCJcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm5vd0tleVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogXCJub3dcIlxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibWVtb3J5Q2hhaW5cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5sbG0gPSBsbG07XG4gICAgICAgIHRoaXMubWVtb3J5UmV0cmlldmVyID0gbWVtb3J5UmV0cmlldmVyO1xuICAgICAgICB0aGlzLnZlcmJvc2UgPSBjb25maWc/LnZlcmJvc2UgPz8gdGhpcy52ZXJib3NlO1xuICAgICAgICB0aGlzLnJlZmxlY3Rpb25UaHJlc2hvbGQgPVxuICAgICAgICAgICAgY29uZmlnPy5yZWZsZWN0aW9uVGhyZXNob2xkID8/IHRoaXMucmVmbGVjdGlvblRocmVzaG9sZDtcbiAgICAgICAgdGhpcy5tYXhUb2tlbnNMaW1pdCA9IGNvbmZpZz8ubWF4VG9rZW5zTGltaXQgPz8gdGhpcy5tYXhUb2tlbnNMaW1pdDtcbiAgICAgICAgdGhpcy5tZW1vcnlDaGFpbiA9IG5ldyBHZW5lcmF0aXZlQWdlbnRNZW1vcnlDaGFpbihsbG0sIG1lbW9yeVJldHJpZXZlciwge1xuICAgICAgICAgICAgcmVmbGVjdGlvblRocmVzaG9sZDogY29uZmlnPy5yZWZsZWN0aW9uVGhyZXNob2xkLFxuICAgICAgICAgICAgaW1wb3J0YW5jZVdlaWdodDogY29uZmlnPy5pbXBvcnRhbmNlV2VpZ2h0LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTWV0aG9kIHRoYXQgcmV0dXJucyB0aGUga2V5IGZvciByZWxldmFudCBtZW1vcmllcy5cbiAgICAgKiBAcmV0dXJucyBUaGUga2V5IGZvciByZWxldmFudCBtZW1vcmllcyBhcyBhIHN0cmluZy5cbiAgICAgKi9cbiAgICBnZXRSZWxldmFudE1lbW9yaWVzS2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZWxldmFudE1lbW9yaWVzS2V5O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNZXRob2QgdGhhdCByZXR1cm5zIHRoZSBrZXkgZm9yIHRoZSBtb3N0IHJlY2VudCBtZW1vcmllcyB0b2tlbi5cbiAgICAgKiBAcmV0dXJucyBUaGUga2V5IGZvciB0aGUgbW9zdCByZWNlbnQgbWVtb3JpZXMgdG9rZW4gYXMgYSBzdHJpbmcuXG4gICAgICovXG4gICAgZ2V0TW9zdFJlY2VudE1lbW9yaWVzVG9rZW5LZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1vc3RSZWNlbnRNZW1vcmllc1Rva2VuS2V5O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNZXRob2QgdGhhdCByZXR1cm5zIHRoZSBrZXkgZm9yIGFkZGluZyBhIG1lbW9yeS5cbiAgICAgKiBAcmV0dXJucyBUaGUga2V5IGZvciBhZGRpbmcgYSBtZW1vcnkgYXMgYSBzdHJpbmcuXG4gICAgICovXG4gICAgZ2V0QWRkTWVtb3J5S2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZGRNZW1vcnlLZXk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1ldGhvZCB0aGF0IHJldHVybnMgdGhlIGtleSBmb3IgdGhlIGN1cnJlbnQgdGltZS5cbiAgICAgKiBAcmV0dXJucyBUaGUga2V5IGZvciB0aGUgY3VycmVudCB0aW1lIGFzIGEgc3RyaW5nLlxuICAgICAqL1xuICAgIGdldEN1cnJlbnRUaW1lS2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ub3dLZXk7XG4gICAgfVxuICAgIGdldCBtZW1vcnlLZXlzKCkge1xuICAgICAgICAvLyBSZXR1cm4gYW4gYXJyYXkgb2YgbWVtb3J5IGtleXNcbiAgICAgICAgcmV0dXJuIFt0aGlzLnJlbGV2YW50TWVtb3JpZXNLZXksIHRoaXMubW9zdFJlY2VudE1lbW9yaWVzS2V5XTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTWV0aG9kIHRoYXQgYWRkcyBhIG1lbW9yeSB0byB0aGUgYWdlbnQncyBtZW1vcnkuXG4gICAgICogQHBhcmFtIG1lbW9yeUNvbnRlbnQgVGhlIGNvbnRlbnQgb2YgdGhlIG1lbW9yeSB0byBhZGQuXG4gICAgICogQHBhcmFtIG5vdyBUaGUgY3VycmVudCBkYXRlLlxuICAgICAqIEBwYXJhbSBtZXRhZGF0YSBUaGUgbWV0YWRhdGEgZm9yIHRoZSBtZW1vcnkuXG4gICAgICogQHBhcmFtIGNhbGxiYWNrcyBUaGUgQ2FsbGJhY2tzIHRvIHVzZSBmb3IgYWRkaW5nIHRoZSBtZW1vcnkuXG4gICAgICogQHJldHVybnMgVGhlIHJlc3VsdCBvZiB0aGUgbWVtb3J5IGFkZGl0aW9uLlxuICAgICAqL1xuICAgIGFzeW5jIGFkZE1lbW9yeShtZW1vcnlDb250ZW50LCBub3csIG1ldGFkYXRhLCBjYWxsYmFja3MpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWVtb3J5Q2hhaW4uY2FsbCh7IG1lbW9yeV9jb250ZW50OiBtZW1vcnlDb250ZW50LCBub3csIG1lbW9yeV9tZXRhZGF0YTogbWV0YWRhdGEgfSwgY2FsbGJhY2tzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTWV0aG9kIHRoYXQgZm9ybWF0cyB0aGUgZ2l2ZW4gcmVsZXZhbnQgbWVtb3JpZXMgaW4gZGV0YWlsLlxuICAgICAqIEBwYXJhbSByZWxldmFudE1lbW9yaWVzIFRoZSByZWxldmFudCBtZW1vcmllcyB0byBmb3JtYXQuXG4gICAgICogQHJldHVybnMgVGhlIGZvcm1hdHRlZCBtZW1vcmllcyBhcyBhIHN0cmluZy5cbiAgICAgKi9cbiAgICBmb3JtYXRNZW1vcmllc0RldGFpbChyZWxldmFudE1lbW9yaWVzKSB7XG4gICAgICAgIGlmICghcmVsZXZhbnRNZW1vcmllcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBcIk5vIHJlbGV2YW50IGluZm9ybWF0aW9uLlwiO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNvbnRlbnRTdHJpbmdzID0gbmV3IFNldCgpO1xuICAgICAgICBjb25zdCBjb250ZW50ID0gW107XG4gICAgICAgIGZvciAoY29uc3QgbWVtb3J5IG9mIHJlbGV2YW50TWVtb3JpZXMpIHtcbiAgICAgICAgICAgIGlmIChtZW1vcnkucGFnZUNvbnRlbnQgaW4gY29udGVudFN0cmluZ3MpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRlbnRTdHJpbmdzLmFkZChtZW1vcnkucGFnZUNvbnRlbnQpO1xuICAgICAgICAgICAgY29uc3QgY3JlYXRlZFRpbWUgPSBtZW1vcnkubWV0YWRhdGEuY3JlYXRlZF9hdC50b0xvY2FsZVN0cmluZyhcImVuLVVTXCIsIHtcbiAgICAgICAgICAgICAgICBtb250aDogXCJsb25nXCIsXG4gICAgICAgICAgICAgICAgZGF5OiBcIm51bWVyaWNcIixcbiAgICAgICAgICAgICAgICB5ZWFyOiBcIm51bWVyaWNcIixcbiAgICAgICAgICAgICAgICBob3VyOiBcIm51bWVyaWNcIixcbiAgICAgICAgICAgICAgICBtaW51dGU6IFwibnVtZXJpY1wiLFxuICAgICAgICAgICAgICAgIGhvdXIxMjogdHJ1ZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29udGVudC5wdXNoKGAke2NyZWF0ZWRUaW1lfTogJHttZW1vcnkucGFnZUNvbnRlbnQudHJpbSgpfWApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGpvaW5lZENvbnRlbnQgPSBjb250ZW50Lm1hcCgobWVtKSA9PiBgJHttZW19YCkuam9pbihcIlxcblwiKTtcbiAgICAgICAgcmV0dXJuIGpvaW5lZENvbnRlbnQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1ldGhvZCB0aGF0IGZvcm1hdHMgdGhlIGdpdmVuIHJlbGV2YW50IG1lbW9yaWVzIGluIGEgc2ltcGxlIG1hbm5lci5cbiAgICAgKiBAcGFyYW0gcmVsZXZhbnRNZW1vcmllcyBUaGUgcmVsZXZhbnQgbWVtb3JpZXMgdG8gZm9ybWF0LlxuICAgICAqIEByZXR1cm5zIFRoZSBmb3JtYXR0ZWQgbWVtb3JpZXMgYXMgYSBzdHJpbmcuXG4gICAgICovXG4gICAgZm9ybWF0TWVtb3JpZXNTaW1wbGUocmVsZXZhbnRNZW1vcmllcykge1xuICAgICAgICBjb25zdCBqb2luZWRDb250ZW50ID0gcmVsZXZhbnRNZW1vcmllc1xuICAgICAgICAgICAgLm1hcCgobWVtKSA9PiBgJHttZW0ucGFnZUNvbnRlbnR9YClcbiAgICAgICAgICAgIC5qb2luKFwiOyBcIik7XG4gICAgICAgIHJldHVybiBqb2luZWRDb250ZW50O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNZXRob2QgdGhhdCByZXRyaWV2ZXMgbWVtb3JpZXMgdW50aWwgYSB0b2tlbiBsaW1pdCBpcyByZWFjaGVkLlxuICAgICAqIEBwYXJhbSBjb25zdW1lZFRva2VucyBUaGUgbnVtYmVyIG9mIHRva2VucyBjb25zdW1lZCBzbyBmYXIuXG4gICAgICogQHJldHVybnMgVGhlIG1lbW9yaWVzIGFzIGEgc3RyaW5nLlxuICAgICAqL1xuICAgIGFzeW5jIGdldE1lbW9yaWVzVW50aWxMaW1pdChjb25zdW1lZFRva2Vucykge1xuICAgICAgICAvLyByZWR1Y2UgdGhlIG51bWJlciBvZiB0b2tlbnMgaW4gdGhlIGRvY3VtZW50c1xuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBkb2Mgb2YgdGhpcy5tZW1vcnlSZXRyaWV2ZXJcbiAgICAgICAgICAgIC5nZXRNZW1vcnlTdHJlYW0oKVxuICAgICAgICAgICAgLnNsaWNlKClcbiAgICAgICAgICAgIC5yZXZlcnNlKCkpIHtcbiAgICAgICAgICAgIGlmIChjb25zdW1lZFRva2VucyA+PSB0aGlzLm1heFRva2Vuc0xpbWl0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmVyYm9zZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkV4Y2VlZGluZyBtYXggdG9rZW5zIGZvciBMTE0sIGZpbHRlcmluZyBtZW1vcmllc1wiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgICAgICAgIGNvbnN1bWVkVG9rZW5zICs9IGF3YWl0IHRoaXMubGxtLmdldE51bVRva2Vucyhkb2MucGFnZUNvbnRlbnQpO1xuICAgICAgICAgICAgaWYgKGNvbnN1bWVkVG9rZW5zIDwgdGhpcy5tYXhUb2tlbnNMaW1pdCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGRvYyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0TWVtb3JpZXNTaW1wbGUocmVzdWx0KTtcbiAgICB9XG4gICAgZ2V0IG1lbW9yeVZhcmlhYmxlcygpIHtcbiAgICAgICAgLy8gaW5wdXQga2V5cyB0aGlzIG1lbW9yeSBjbGFzcyB3aWxsIGxvYWQgZHluYW1pY2FsbHlcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNZXRob2QgdGhhdCBsb2FkcyBtZW1vcnkgdmFyaWFibGVzIGJhc2VkIG9uIHRoZSBnaXZlbiBpbnB1dHMuXG4gICAgICogQHBhcmFtIGlucHV0cyBUaGUgaW5wdXRzIHRvIHVzZSBmb3IgbG9hZGluZyBtZW1vcnkgdmFyaWFibGVzLlxuICAgICAqIEByZXR1cm5zIEFuIG9iamVjdCBjb250YWluaW5nIHRoZSBsb2FkZWQgbWVtb3J5IHZhcmlhYmxlcy5cbiAgICAgKi9cbiAgICBhc3luYyBsb2FkTWVtb3J5VmFyaWFibGVzKGlucHV0cykge1xuICAgICAgICBjb25zdCBxdWVyaWVzID0gaW5wdXRzW3RoaXMucXVlcmllc0tleV07XG4gICAgICAgIGNvbnN0IG5vdyA9IGlucHV0c1t0aGlzLm5vd0tleV07XG4gICAgICAgIGlmIChxdWVyaWVzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlbGV2YW50TWVtb3JpZXMgPSAoYXdhaXQgUHJvbWlzZS5hbGwocXVlcmllcy5tYXAoKHF1ZXJ5KSA9PiB0aGlzLm1lbW9yeUNoYWluLmZldGNoTWVtb3JpZXMocXVlcnksIG5vdykpKSkuZmxhdCgpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBbdGhpcy5yZWxldmFudE1lbW9yaWVzS2V5XTogdGhpcy5mb3JtYXRNZW1vcmllc0RldGFpbChyZWxldmFudE1lbW9yaWVzKSxcbiAgICAgICAgICAgICAgICBbdGhpcy5yZWxldmFudE1lbW9yaWVzU2ltcGxlS2V5XTogdGhpcy5mb3JtYXRNZW1vcmllc1NpbXBsZShyZWxldmFudE1lbW9yaWVzKSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbW9zdFJlY2VudE1lbW9yaWVzVG9rZW4gPSBpbnB1dHNbdGhpcy5tb3N0UmVjZW50TWVtb3JpZXNUb2tlbktleV07XG4gICAgICAgIGlmIChtb3N0UmVjZW50TWVtb3JpZXNUb2tlbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIFt0aGlzLm1vc3RSZWNlbnRNZW1vcmllc0tleV06IGF3YWl0IHRoaXMuZ2V0TWVtb3JpZXNVbnRpbExpbWl0KG1vc3RSZWNlbnRNZW1vcmllc1Rva2VuKSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNZXRob2QgdGhhdCBzYXZlcyB0aGUgY29udGV4dCBvZiBhIG1vZGVsIHJ1biB0byBtZW1vcnkuXG4gICAgICogQHBhcmFtIF9pbnB1dHMgVGhlIGlucHV0cyBvZiB0aGUgbW9kZWwgcnVuLlxuICAgICAqIEBwYXJhbSBvdXRwdXRzIFRoZSBvdXRwdXRzIG9mIHRoZSBtb2RlbCBydW4uXG4gICAgICogQHJldHVybnMgTm90aGluZy5cbiAgICAgKi9cbiAgICBhc3luYyBzYXZlQ29udGV4dChfaW5wdXRzLCBvdXRwdXRzKSB7XG4gICAgICAgIC8vIHNhdmUgdGhlIGNvbnRleHQgb2YgdGhpcyBtb2RlbCBydW4gdG8gbWVtb3J5XG4gICAgICAgIGNvbnN0IG1lbSA9IG91dHB1dHNbdGhpcy5hZGRNZW1vcnlLZXldO1xuICAgICAgICBjb25zdCBub3cgPSBvdXRwdXRzW3RoaXMubm93S2V5XTtcbiAgICAgICAgaWYgKG1lbSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5hZGRNZW1vcnkobWVtLCBub3csIHt9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBNZXRob2QgdGhhdCBjbGVhcnMgdGhlIG1lbW9yeSBjb250ZW50cy5cbiAgICAgKiBAcmV0dXJucyBOb3RoaW5nLlxuICAgICAqL1xuICAgIGNsZWFyKCkge1xuICAgICAgICAvLyBUT0RPOiBjbGVhciBtZW1vcnkgY29udGVudHNcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/experimental/generative_agents/generative_agent_memory.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/experimental/generative_agents/index.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/langchain/dist/experimental/generative_agents/index.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GenerativeAgent: () => (/* reexport safe */ _generative_agent_js__WEBPACK_IMPORTED_MODULE_1__.GenerativeAgent),\n/* harmony export */   GenerativeAgentMemory: () => (/* reexport safe */ _generative_agent_memory_js__WEBPACK_IMPORTED_MODULE_0__.GenerativeAgentMemory)\n/* harmony export */ });\n/* harmony import */ var _generative_agent_memory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./generative_agent_memory.js */ \"(rsc)/./node_modules/langchain/dist/experimental/generative_agents/generative_agent_memory.js\");\n/* harmony import */ var _generative_agent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./generative_agent.js */ \"(rsc)/./node_modules/langchain/dist/experimental/generative_agents/generative_agent.js\");\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvZXhwZXJpbWVudGFsL2dlbmVyYXRpdmVfYWdlbnRzL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBcUU7QUFDYiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvbXBhbmlvbi8uL25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9leHBlcmltZW50YWwvZ2VuZXJhdGl2ZV9hZ2VudHMvaW5kZXguanM/NTUyNiJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgeyBHZW5lcmF0aXZlQWdlbnRNZW1vcnkgfSBmcm9tIFwiLi9nZW5lcmF0aXZlX2FnZW50X21lbW9yeS5qc1wiO1xuZXhwb3J0IHsgR2VuZXJhdGl2ZUFnZW50IH0gZnJvbSBcIi4vZ2VuZXJhdGl2ZV9hZ2VudC5qc1wiO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/experimental/generative_agents/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/output_parsers/noop.js":
/*!************************************************************!*\
  !*** ./node_modules/langchain/dist/output_parsers/noop.js ***!
  \************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NoOpOutputParser: () => (/* binding */ NoOpOutputParser)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_output_parsers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/output_parsers */ \"(rsc)/./node_modules/@langchain/core/output_parsers.js\");\n\n/**\n * The NoOpOutputParser class is a type of output parser that does not\n * perform any operations on the output. It extends the BaseOutputParser\n * class and is part of the LangChain's output parsers module. This class\n * is useful in scenarios where the raw output of the Large Language\n * Models (LLMs) is required.\n */\nclass NoOpOutputParser extends _langchain_core_output_parsers__WEBPACK_IMPORTED_MODULE_0__.BaseOutputParser {\n    constructor() {\n        super(...arguments);\n        Object.defineProperty(this, \"lc_namespace\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: [\"langchain\", \"output_parsers\", \"default\"]\n        });\n        Object.defineProperty(this, \"lc_serializable\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: true\n        });\n    }\n    static lc_name() {\n        return \"NoOpOutputParser\";\n    }\n    /**\n     * This method takes a string as input and returns the same string as\n     * output. It does not perform any operations on the input string.\n     * @param text The input string to be parsed.\n     * @returns The same input string without any operations performed on it.\n     */\n    parse(text) {\n        return Promise.resolve(text);\n    }\n    /**\n     * This method returns an empty string. It does not provide any formatting\n     * instructions.\n     * @returns An empty string, indicating no formatting instructions.\n     */\n    getFormatInstructions() {\n        return \"\";\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3Qvb3V0cHV0X3BhcnNlcnMvbm9vcC5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFrRTtBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLCtCQUErQiw0RUFBZ0I7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvbXBhbmlvbi8uL25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9vdXRwdXRfcGFyc2Vycy9ub29wLmpzPzVhN2QiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQmFzZU91dHB1dFBhcnNlciB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvb3V0cHV0X3BhcnNlcnNcIjtcbi8qKlxuICogVGhlIE5vT3BPdXRwdXRQYXJzZXIgY2xhc3MgaXMgYSB0eXBlIG9mIG91dHB1dCBwYXJzZXIgdGhhdCBkb2VzIG5vdFxuICogcGVyZm9ybSBhbnkgb3BlcmF0aW9ucyBvbiB0aGUgb3V0cHV0LiBJdCBleHRlbmRzIHRoZSBCYXNlT3V0cHV0UGFyc2VyXG4gKiBjbGFzcyBhbmQgaXMgcGFydCBvZiB0aGUgTGFuZ0NoYWluJ3Mgb3V0cHV0IHBhcnNlcnMgbW9kdWxlLiBUaGlzIGNsYXNzXG4gKiBpcyB1c2VmdWwgaW4gc2NlbmFyaW9zIHdoZXJlIHRoZSByYXcgb3V0cHV0IG9mIHRoZSBMYXJnZSBMYW5ndWFnZVxuICogTW9kZWxzIChMTE1zKSBpcyByZXF1aXJlZC5cbiAqL1xuZXhwb3J0IGNsYXNzIE5vT3BPdXRwdXRQYXJzZXIgZXh0ZW5kcyBCYXNlT3V0cHV0UGFyc2VyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibGNfbmFtZXNwYWNlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBbXCJsYW5nY2hhaW5cIiwgXCJvdXRwdXRfcGFyc2Vyc1wiLCBcImRlZmF1bHRcIl1cbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImxjX3NlcmlhbGl6YWJsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3RhdGljIGxjX25hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIk5vT3BPdXRwdXRQYXJzZXJcIjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgdGFrZXMgYSBzdHJpbmcgYXMgaW5wdXQgYW5kIHJldHVybnMgdGhlIHNhbWUgc3RyaW5nIGFzXG4gICAgICogb3V0cHV0LiBJdCBkb2VzIG5vdCBwZXJmb3JtIGFueSBvcGVyYXRpb25zIG9uIHRoZSBpbnB1dCBzdHJpbmcuXG4gICAgICogQHBhcmFtIHRleHQgVGhlIGlucHV0IHN0cmluZyB0byBiZSBwYXJzZWQuXG4gICAgICogQHJldHVybnMgVGhlIHNhbWUgaW5wdXQgc3RyaW5nIHdpdGhvdXQgYW55IG9wZXJhdGlvbnMgcGVyZm9ybWVkIG9uIGl0LlxuICAgICAqL1xuICAgIHBhcnNlKHRleHQpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0ZXh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgcmV0dXJucyBhbiBlbXB0eSBzdHJpbmcuIEl0IGRvZXMgbm90IHByb3ZpZGUgYW55IGZvcm1hdHRpbmdcbiAgICAgKiBpbnN0cnVjdGlvbnMuXG4gICAgICogQHJldHVybnMgQW4gZW1wdHkgc3RyaW5nLCBpbmRpY2F0aW5nIG5vIGZvcm1hdHRpbmcgaW5zdHJ1Y3Rpb25zLlxuICAgICAqL1xuICAgIGdldEZvcm1hdEluc3RydWN0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/output_parsers/noop.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/retrievers/time_weighted.js":
/*!*****************************************************************!*\
  !*** ./node_modules/langchain/dist/retrievers/time_weighted.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BUFFER_IDX: () => (/* binding */ BUFFER_IDX),\n/* harmony export */   LAST_ACCESSED_AT_KEY: () => (/* binding */ LAST_ACCESSED_AT_KEY),\n/* harmony export */   TimeWeightedVectorStoreRetriever: () => (/* binding */ TimeWeightedVectorStoreRetriever)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_retrievers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/retrievers */ \"(rsc)/./node_modules/@langchain/core/retrievers.js\");\n\nconst LAST_ACCESSED_AT_KEY = \"last_accessed_at\";\nconst BUFFER_IDX = \"buffer_idx\";\n/**\n * TimeWeightedVectorStoreRetriever retrieves documents based on their time-weighted relevance.\n * ref: https://github.com/langchain-ai/langchain/blob/master/libs/langchain/langchain/retrievers/time_weighted_retriever.py\n * @example\n * ```typescript\n * const retriever = new TimeWeightedVectorStoreRetriever({\n *   vectorStore: new MemoryVectorStore(new OpenAIEmbeddings()),\n *   memoryStream: [],\n *   searchKwargs: 2,\n * });\n * await retriever.addDocuments([\n *   { pageContent: \"My name is John.\", metadata: {} },\n *   { pageContent: \"My favourite food is pizza.\", metadata: {} },\n *\n * ]);\n * const results = await retriever.getRelevantDocuments(\n *   \"What is my favourite food?\",\n * );\n * ```\n */\nclass TimeWeightedVectorStoreRetriever extends _langchain_core_retrievers__WEBPACK_IMPORTED_MODULE_0__.BaseRetriever {\n    static lc_name() {\n        return \"TimeWeightedVectorStoreRetriever\";\n    }\n    get lc_namespace() {\n        return [\"langchain\", \"retrievers\", \"time_weighted\"];\n    }\n    /**\n     * Constructor to initialize the required fields\n     * @param fields - The fields required for initializing the TimeWeightedVectorStoreRetriever\n     */\n    constructor(fields) {\n        super(fields);\n        /**\n         * The vectorstore to store documents and determine salience.\n         */\n        Object.defineProperty(this, \"vectorStore\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        /**\n         * The number of top K most relevant documents to consider when searching.\n         */\n        Object.defineProperty(this, \"searchKwargs\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        /**\n         * The memory_stream of documents to search through.\n         */\n        Object.defineProperty(this, \"memoryStream\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        /**\n         * The exponential decay factor used as (1.0-decay_rate)**(hrs_passed).\n         */\n        Object.defineProperty(this, \"decayRate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        /**\n         * The maximum number of documents to retrieve in a given call.\n         */\n        Object.defineProperty(this, \"k\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        /**\n         * Other keys in the metadata to factor into the score, e.g. 'importance'.\n         */\n        Object.defineProperty(this, \"otherScoreKeys\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        /**\n         * The salience to assign memories not retrieved from the vector store.\n         */\n        Object.defineProperty(this, \"defaultSalience\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.vectorStore = fields.vectorStore;\n        this.searchKwargs = fields.searchKwargs ?? 100;\n        this.memoryStream = fields.memoryStream ?? [];\n        this.decayRate = fields.decayRate ?? 0.01;\n        this.k = fields.k ?? 4;\n        this.otherScoreKeys = fields.otherScoreKeys ?? [];\n        this.defaultSalience = fields.defaultSalience ?? null;\n    }\n    /**\n     * Get the memory stream of documents.\n     * @returns The memory stream of documents.\n     */\n    getMemoryStream() {\n        return this.memoryStream;\n    }\n    /**\n     * Set the memory stream of documents.\n     * @param memoryStream The new memory stream of documents.\n     */\n    setMemoryStream(memoryStream) {\n        this.memoryStream = memoryStream;\n    }\n    /**\n     * Get relevant documents based on time-weighted relevance\n     * @param query - The query to search for\n     * @returns The relevant documents\n     */\n    async _getRelevantDocuments(query, runManager) {\n        const now = Math.floor(Date.now() / 1000);\n        const memoryDocsAndScores = this.getMemoryDocsAndScores();\n        const salientDocsAndScores = await this.getSalientDocuments(query, runManager);\n        const docsAndScores = { ...memoryDocsAndScores, ...salientDocsAndScores };\n        return this.computeResults(docsAndScores, now);\n    }\n    /**\n     * NOTE: When adding documents to a vector store, use addDocuments\n     * via retriever instead of directly to the vector store.\n     * This is because it is necessary to process the document\n     * in prepareDocuments.\n     *\n     * @param docs - The documents to add to vector store in the retriever\n     */\n    async addDocuments(docs) {\n        const now = Math.floor(Date.now() / 1000);\n        const savedDocs = this.prepareDocuments(docs, now);\n        this.memoryStream.push(...savedDocs);\n        await this.vectorStore.addDocuments(savedDocs);\n    }\n    /**\n     * Get memory documents and their scores\n     * @returns An object containing memory documents and their scores\n     */\n    getMemoryDocsAndScores() {\n        const memoryDocsAndScores = {};\n        for (const doc of this.memoryStream.slice(-this.k)) {\n            const bufferIdx = doc.metadata[BUFFER_IDX];\n            if (bufferIdx === undefined) {\n                throw new Error(`Found a document in the vector store that is missing required metadata. This retriever only supports vector stores with documents that have been added through the \"addDocuments\" method on a TimeWeightedVectorStoreRetriever, not directly added or loaded into the backing vector store.`);\n            }\n            memoryDocsAndScores[bufferIdx] = {\n                doc,\n                score: this.defaultSalience ?? 0,\n            };\n        }\n        return memoryDocsAndScores;\n    }\n    /**\n     * Get salient documents and their scores based on the query\n     * @param query - The query to search for\n     * @returns An object containing salient documents and their scores\n     */\n    async getSalientDocuments(query, runManager) {\n        const docAndScores = await this.vectorStore.similaritySearchWithScore(query, this.searchKwargs, undefined, runManager?.getChild());\n        const results = {};\n        for (const [fetchedDoc, score] of docAndScores) {\n            const bufferIdx = fetchedDoc.metadata[BUFFER_IDX];\n            if (bufferIdx === undefined) {\n                throw new Error(`Found a document in the vector store that is missing required metadata. This retriever only supports vector stores with documents that have been added through the \"addDocuments\" method on a TimeWeightedVectorStoreRetriever, not directly added or loaded into the backing vector store.`);\n            }\n            const doc = this.memoryStream[bufferIdx];\n            results[bufferIdx] = { doc, score };\n        }\n        return results;\n    }\n    /**\n     * Compute the final result set of documents based on the combined scores\n     * @param docsAndScores - An object containing documents and their scores\n     * @param now - The current timestamp\n     * @returns The final set of documents\n     */\n    computeResults(docsAndScores, now) {\n        const recordedDocs = Object.values(docsAndScores)\n            .map(({ doc, score }) => ({\n            doc,\n            score: this.getCombinedScore(doc, score, now),\n        }))\n            .sort((a, b) => b.score - a.score);\n        const results = [];\n        for (const { doc } of recordedDocs) {\n            const bufferedDoc = this.memoryStream[doc.metadata[BUFFER_IDX]];\n            bufferedDoc.metadata[LAST_ACCESSED_AT_KEY] = now;\n            results.push(bufferedDoc);\n            if (results.length > this.k) {\n                break;\n            }\n        }\n        return results;\n    }\n    /**\n     * Prepare documents with necessary metadata before saving\n     * @param docs - The documents to prepare\n     * @param now - The current timestamp\n     * @returns The prepared documents\n     */\n    prepareDocuments(docs, now) {\n        return docs.map((doc, i) => ({\n            ...doc,\n            metadata: {\n                ...doc.metadata,\n                [LAST_ACCESSED_AT_KEY]: doc.metadata[LAST_ACCESSED_AT_KEY] ?? now,\n                created_at: doc.metadata.created_at ?? now,\n                [BUFFER_IDX]: this.memoryStream.length + i,\n            },\n        }));\n    }\n    /**\n     * Calculate the combined score based on vector relevance and other factors\n     * @param doc - The document to calculate the score for\n     * @param vectorRelevance - The relevance score from the vector store\n     * @param nowMsec - The current timestamp in milliseconds\n     * @returns The combined score for the document\n     */\n    getCombinedScore(doc, vectorRelevance, nowMsec) {\n        const hoursPassed = this.getHoursPassed(nowMsec, doc.metadata[LAST_ACCESSED_AT_KEY]);\n        let score = (1.0 - this.decayRate) ** hoursPassed;\n        for (const key of this.otherScoreKeys) {\n            score += doc.metadata[key];\n        }\n        if (vectorRelevance !== null) {\n            score += vectorRelevance;\n        }\n        return score;\n    }\n    /**\n     * Calculate the hours passed between two time points\n     * @param time - The current time in seconds\n     * @param refTime - The reference time in seconds\n     * @returns The number of hours passed between the two time points\n     */\n    getHoursPassed(time, refTime) {\n        return (time - refTime) / 3600;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvcmV0cmlldmVycy90aW1lX3dlaWdodGVkLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBMkQ7QUFDcEQ7QUFDQTtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLE9BQU8sK0NBQStDO0FBQ3RELE9BQU8sMERBQTBEO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sK0NBQStDLHFFQUFhO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsWUFBWTtBQUNoQztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxxQkFBcUIsTUFBTTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWktY29tcGFuaW9uLy4vbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L3JldHJpZXZlcnMvdGltZV93ZWlnaHRlZC5qcz9kZTlkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJhc2VSZXRyaWV2ZXIgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL3JldHJpZXZlcnNcIjtcbmV4cG9ydCBjb25zdCBMQVNUX0FDQ0VTU0VEX0FUX0tFWSA9IFwibGFzdF9hY2Nlc3NlZF9hdFwiO1xuZXhwb3J0IGNvbnN0IEJVRkZFUl9JRFggPSBcImJ1ZmZlcl9pZHhcIjtcbi8qKlxuICogVGltZVdlaWdodGVkVmVjdG9yU3RvcmVSZXRyaWV2ZXIgcmV0cmlldmVzIGRvY3VtZW50cyBiYXNlZCBvbiB0aGVpciB0aW1lLXdlaWdodGVkIHJlbGV2YW5jZS5cbiAqIHJlZjogaHR0cHM6Ly9naXRodWIuY29tL2xhbmdjaGFpbi1haS9sYW5nY2hhaW4vYmxvYi9tYXN0ZXIvbGlicy9sYW5nY2hhaW4vbGFuZ2NoYWluL3JldHJpZXZlcnMvdGltZV93ZWlnaHRlZF9yZXRyaWV2ZXIucHlcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCByZXRyaWV2ZXIgPSBuZXcgVGltZVdlaWdodGVkVmVjdG9yU3RvcmVSZXRyaWV2ZXIoe1xuICogICB2ZWN0b3JTdG9yZTogbmV3IE1lbW9yeVZlY3RvclN0b3JlKG5ldyBPcGVuQUlFbWJlZGRpbmdzKCkpLFxuICogICBtZW1vcnlTdHJlYW06IFtdLFxuICogICBzZWFyY2hLd2FyZ3M6IDIsXG4gKiB9KTtcbiAqIGF3YWl0IHJldHJpZXZlci5hZGREb2N1bWVudHMoW1xuICogICB7IHBhZ2VDb250ZW50OiBcIk15IG5hbWUgaXMgSm9obi5cIiwgbWV0YWRhdGE6IHt9IH0sXG4gKiAgIHsgcGFnZUNvbnRlbnQ6IFwiTXkgZmF2b3VyaXRlIGZvb2QgaXMgcGl6emEuXCIsIG1ldGFkYXRhOiB7fSB9LFxuICpcbiAqIF0pO1xuICogY29uc3QgcmVzdWx0cyA9IGF3YWl0IHJldHJpZXZlci5nZXRSZWxldmFudERvY3VtZW50cyhcbiAqICAgXCJXaGF0IGlzIG15IGZhdm91cml0ZSBmb29kP1wiLFxuICogKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVGltZVdlaWdodGVkVmVjdG9yU3RvcmVSZXRyaWV2ZXIgZXh0ZW5kcyBCYXNlUmV0cmlldmVyIHtcbiAgICBzdGF0aWMgbGNfbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiVGltZVdlaWdodGVkVmVjdG9yU3RvcmVSZXRyaWV2ZXJcIjtcbiAgICB9XG4gICAgZ2V0IGxjX25hbWVzcGFjZSgpIHtcbiAgICAgICAgcmV0dXJuIFtcImxhbmdjaGFpblwiLCBcInJldHJpZXZlcnNcIiwgXCJ0aW1lX3dlaWdodGVkXCJdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RvciB0byBpbml0aWFsaXplIHRoZSByZXF1aXJlZCBmaWVsZHNcbiAgICAgKiBAcGFyYW0gZmllbGRzIC0gVGhlIGZpZWxkcyByZXF1aXJlZCBmb3IgaW5pdGlhbGl6aW5nIHRoZSBUaW1lV2VpZ2h0ZWRWZWN0b3JTdG9yZVJldHJpZXZlclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGZpZWxkcykge1xuICAgICAgICBzdXBlcihmaWVsZHMpO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHZlY3RvcnN0b3JlIHRvIHN0b3JlIGRvY3VtZW50cyBhbmQgZGV0ZXJtaW5lIHNhbGllbmNlLlxuICAgICAgICAgKi9cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwidmVjdG9yU3RvcmVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBudW1iZXIgb2YgdG9wIEsgbW9zdCByZWxldmFudCBkb2N1bWVudHMgdG8gY29uc2lkZXIgd2hlbiBzZWFyY2hpbmcuXG4gICAgICAgICAqL1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJzZWFyY2hLd2FyZ3NcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBtZW1vcnlfc3RyZWFtIG9mIGRvY3VtZW50cyB0byBzZWFyY2ggdGhyb3VnaC5cbiAgICAgICAgICovXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1lbW9yeVN0cmVhbVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGV4cG9uZW50aWFsIGRlY2F5IGZhY3RvciB1c2VkIGFzICgxLjAtZGVjYXlfcmF0ZSkqKihocnNfcGFzc2VkKS5cbiAgICAgICAgICovXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImRlY2F5UmF0ZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIG1heGltdW0gbnVtYmVyIG9mIGRvY3VtZW50cyB0byByZXRyaWV2ZSBpbiBhIGdpdmVuIGNhbGwuXG4gICAgICAgICAqL1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJrXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBPdGhlciBrZXlzIGluIHRoZSBtZXRhZGF0YSB0byBmYWN0b3IgaW50byB0aGUgc2NvcmUsIGUuZy4gJ2ltcG9ydGFuY2UnLlxuICAgICAgICAgKi9cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwib3RoZXJTY29yZUtleXNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBzYWxpZW5jZSB0byBhc3NpZ24gbWVtb3JpZXMgbm90IHJldHJpZXZlZCBmcm9tIHRoZSB2ZWN0b3Igc3RvcmUuXG4gICAgICAgICAqL1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJkZWZhdWx0U2FsaWVuY2VcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy52ZWN0b3JTdG9yZSA9IGZpZWxkcy52ZWN0b3JTdG9yZTtcbiAgICAgICAgdGhpcy5zZWFyY2hLd2FyZ3MgPSBmaWVsZHMuc2VhcmNoS3dhcmdzID8/IDEwMDtcbiAgICAgICAgdGhpcy5tZW1vcnlTdHJlYW0gPSBmaWVsZHMubWVtb3J5U3RyZWFtID8/IFtdO1xuICAgICAgICB0aGlzLmRlY2F5UmF0ZSA9IGZpZWxkcy5kZWNheVJhdGUgPz8gMC4wMTtcbiAgICAgICAgdGhpcy5rID0gZmllbGRzLmsgPz8gNDtcbiAgICAgICAgdGhpcy5vdGhlclNjb3JlS2V5cyA9IGZpZWxkcy5vdGhlclNjb3JlS2V5cyA/PyBbXTtcbiAgICAgICAgdGhpcy5kZWZhdWx0U2FsaWVuY2UgPSBmaWVsZHMuZGVmYXVsdFNhbGllbmNlID8/IG51bGw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgbWVtb3J5IHN0cmVhbSBvZiBkb2N1bWVudHMuXG4gICAgICogQHJldHVybnMgVGhlIG1lbW9yeSBzdHJlYW0gb2YgZG9jdW1lbnRzLlxuICAgICAqL1xuICAgIGdldE1lbW9yeVN0cmVhbSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWVtb3J5U3RyZWFtO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIG1lbW9yeSBzdHJlYW0gb2YgZG9jdW1lbnRzLlxuICAgICAqIEBwYXJhbSBtZW1vcnlTdHJlYW0gVGhlIG5ldyBtZW1vcnkgc3RyZWFtIG9mIGRvY3VtZW50cy5cbiAgICAgKi9cbiAgICBzZXRNZW1vcnlTdHJlYW0obWVtb3J5U3RyZWFtKSB7XG4gICAgICAgIHRoaXMubWVtb3J5U3RyZWFtID0gbWVtb3J5U3RyZWFtO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgcmVsZXZhbnQgZG9jdW1lbnRzIGJhc2VkIG9uIHRpbWUtd2VpZ2h0ZWQgcmVsZXZhbmNlXG4gICAgICogQHBhcmFtIHF1ZXJ5IC0gVGhlIHF1ZXJ5IHRvIHNlYXJjaCBmb3JcbiAgICAgKiBAcmV0dXJucyBUaGUgcmVsZXZhbnQgZG9jdW1lbnRzXG4gICAgICovXG4gICAgYXN5bmMgX2dldFJlbGV2YW50RG9jdW1lbnRzKHF1ZXJ5LCBydW5NYW5hZ2VyKSB7XG4gICAgICAgIGNvbnN0IG5vdyA9IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApO1xuICAgICAgICBjb25zdCBtZW1vcnlEb2NzQW5kU2NvcmVzID0gdGhpcy5nZXRNZW1vcnlEb2NzQW5kU2NvcmVzKCk7XG4gICAgICAgIGNvbnN0IHNhbGllbnREb2NzQW5kU2NvcmVzID0gYXdhaXQgdGhpcy5nZXRTYWxpZW50RG9jdW1lbnRzKHF1ZXJ5LCBydW5NYW5hZ2VyKTtcbiAgICAgICAgY29uc3QgZG9jc0FuZFNjb3JlcyA9IHsgLi4ubWVtb3J5RG9jc0FuZFNjb3JlcywgLi4uc2FsaWVudERvY3NBbmRTY29yZXMgfTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tcHV0ZVJlc3VsdHMoZG9jc0FuZFNjb3Jlcywgbm93KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTk9URTogV2hlbiBhZGRpbmcgZG9jdW1lbnRzIHRvIGEgdmVjdG9yIHN0b3JlLCB1c2UgYWRkRG9jdW1lbnRzXG4gICAgICogdmlhIHJldHJpZXZlciBpbnN0ZWFkIG9mIGRpcmVjdGx5IHRvIHRoZSB2ZWN0b3Igc3RvcmUuXG4gICAgICogVGhpcyBpcyBiZWNhdXNlIGl0IGlzIG5lY2Vzc2FyeSB0byBwcm9jZXNzIHRoZSBkb2N1bWVudFxuICAgICAqIGluIHByZXBhcmVEb2N1bWVudHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jcyAtIFRoZSBkb2N1bWVudHMgdG8gYWRkIHRvIHZlY3RvciBzdG9yZSBpbiB0aGUgcmV0cmlldmVyXG4gICAgICovXG4gICAgYXN5bmMgYWRkRG9jdW1lbnRzKGRvY3MpIHtcbiAgICAgICAgY29uc3Qgbm93ID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCk7XG4gICAgICAgIGNvbnN0IHNhdmVkRG9jcyA9IHRoaXMucHJlcGFyZURvY3VtZW50cyhkb2NzLCBub3cpO1xuICAgICAgICB0aGlzLm1lbW9yeVN0cmVhbS5wdXNoKC4uLnNhdmVkRG9jcyk7XG4gICAgICAgIGF3YWl0IHRoaXMudmVjdG9yU3RvcmUuYWRkRG9jdW1lbnRzKHNhdmVkRG9jcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBtZW1vcnkgZG9jdW1lbnRzIGFuZCB0aGVpciBzY29yZXNcbiAgICAgKiBAcmV0dXJucyBBbiBvYmplY3QgY29udGFpbmluZyBtZW1vcnkgZG9jdW1lbnRzIGFuZCB0aGVpciBzY29yZXNcbiAgICAgKi9cbiAgICBnZXRNZW1vcnlEb2NzQW5kU2NvcmVzKCkge1xuICAgICAgICBjb25zdCBtZW1vcnlEb2NzQW5kU2NvcmVzID0ge307XG4gICAgICAgIGZvciAoY29uc3QgZG9jIG9mIHRoaXMubWVtb3J5U3RyZWFtLnNsaWNlKC10aGlzLmspKSB7XG4gICAgICAgICAgICBjb25zdCBidWZmZXJJZHggPSBkb2MubWV0YWRhdGFbQlVGRkVSX0lEWF07XG4gICAgICAgICAgICBpZiAoYnVmZmVySWR4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZvdW5kIGEgZG9jdW1lbnQgaW4gdGhlIHZlY3RvciBzdG9yZSB0aGF0IGlzIG1pc3NpbmcgcmVxdWlyZWQgbWV0YWRhdGEuIFRoaXMgcmV0cmlldmVyIG9ubHkgc3VwcG9ydHMgdmVjdG9yIHN0b3JlcyB3aXRoIGRvY3VtZW50cyB0aGF0IGhhdmUgYmVlbiBhZGRlZCB0aHJvdWdoIHRoZSBcImFkZERvY3VtZW50c1wiIG1ldGhvZCBvbiBhIFRpbWVXZWlnaHRlZFZlY3RvclN0b3JlUmV0cmlldmVyLCBub3QgZGlyZWN0bHkgYWRkZWQgb3IgbG9hZGVkIGludG8gdGhlIGJhY2tpbmcgdmVjdG9yIHN0b3JlLmApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWVtb3J5RG9jc0FuZFNjb3Jlc1tidWZmZXJJZHhdID0ge1xuICAgICAgICAgICAgICAgIGRvYyxcbiAgICAgICAgICAgICAgICBzY29yZTogdGhpcy5kZWZhdWx0U2FsaWVuY2UgPz8gMCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1lbW9yeURvY3NBbmRTY29yZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBzYWxpZW50IGRvY3VtZW50cyBhbmQgdGhlaXIgc2NvcmVzIGJhc2VkIG9uIHRoZSBxdWVyeVxuICAgICAqIEBwYXJhbSBxdWVyeSAtIFRoZSBxdWVyeSB0byBzZWFyY2ggZm9yXG4gICAgICogQHJldHVybnMgQW4gb2JqZWN0IGNvbnRhaW5pbmcgc2FsaWVudCBkb2N1bWVudHMgYW5kIHRoZWlyIHNjb3Jlc1xuICAgICAqL1xuICAgIGFzeW5jIGdldFNhbGllbnREb2N1bWVudHMocXVlcnksIHJ1bk1hbmFnZXIpIHtcbiAgICAgICAgY29uc3QgZG9jQW5kU2NvcmVzID0gYXdhaXQgdGhpcy52ZWN0b3JTdG9yZS5zaW1pbGFyaXR5U2VhcmNoV2l0aFNjb3JlKHF1ZXJ5LCB0aGlzLnNlYXJjaEt3YXJncywgdW5kZWZpbmVkLCBydW5NYW5hZ2VyPy5nZXRDaGlsZCgpKTtcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IHt9O1xuICAgICAgICBmb3IgKGNvbnN0IFtmZXRjaGVkRG9jLCBzY29yZV0gb2YgZG9jQW5kU2NvcmVzKSB7XG4gICAgICAgICAgICBjb25zdCBidWZmZXJJZHggPSBmZXRjaGVkRG9jLm1ldGFkYXRhW0JVRkZFUl9JRFhdO1xuICAgICAgICAgICAgaWYgKGJ1ZmZlcklkeCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGb3VuZCBhIGRvY3VtZW50IGluIHRoZSB2ZWN0b3Igc3RvcmUgdGhhdCBpcyBtaXNzaW5nIHJlcXVpcmVkIG1ldGFkYXRhLiBUaGlzIHJldHJpZXZlciBvbmx5IHN1cHBvcnRzIHZlY3RvciBzdG9yZXMgd2l0aCBkb2N1bWVudHMgdGhhdCBoYXZlIGJlZW4gYWRkZWQgdGhyb3VnaCB0aGUgXCJhZGREb2N1bWVudHNcIiBtZXRob2Qgb24gYSBUaW1lV2VpZ2h0ZWRWZWN0b3JTdG9yZVJldHJpZXZlciwgbm90IGRpcmVjdGx5IGFkZGVkIG9yIGxvYWRlZCBpbnRvIHRoZSBiYWNraW5nIHZlY3RvciBzdG9yZS5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGRvYyA9IHRoaXMubWVtb3J5U3RyZWFtW2J1ZmZlcklkeF07XG4gICAgICAgICAgICByZXN1bHRzW2J1ZmZlcklkeF0gPSB7IGRvYywgc2NvcmUgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tcHV0ZSB0aGUgZmluYWwgcmVzdWx0IHNldCBvZiBkb2N1bWVudHMgYmFzZWQgb24gdGhlIGNvbWJpbmVkIHNjb3Jlc1xuICAgICAqIEBwYXJhbSBkb2NzQW5kU2NvcmVzIC0gQW4gb2JqZWN0IGNvbnRhaW5pbmcgZG9jdW1lbnRzIGFuZCB0aGVpciBzY29yZXNcbiAgICAgKiBAcGFyYW0gbm93IC0gVGhlIGN1cnJlbnQgdGltZXN0YW1wXG4gICAgICogQHJldHVybnMgVGhlIGZpbmFsIHNldCBvZiBkb2N1bWVudHNcbiAgICAgKi9cbiAgICBjb21wdXRlUmVzdWx0cyhkb2NzQW5kU2NvcmVzLCBub3cpIHtcbiAgICAgICAgY29uc3QgcmVjb3JkZWREb2NzID0gT2JqZWN0LnZhbHVlcyhkb2NzQW5kU2NvcmVzKVxuICAgICAgICAgICAgLm1hcCgoeyBkb2MsIHNjb3JlIH0pID0+ICh7XG4gICAgICAgICAgICBkb2MsXG4gICAgICAgICAgICBzY29yZTogdGhpcy5nZXRDb21iaW5lZFNjb3JlKGRvYywgc2NvcmUsIG5vdyksXG4gICAgICAgIH0pKVxuICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IGIuc2NvcmUgLSBhLnNjb3JlKTtcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IHsgZG9jIH0gb2YgcmVjb3JkZWREb2NzKSB7XG4gICAgICAgICAgICBjb25zdCBidWZmZXJlZERvYyA9IHRoaXMubWVtb3J5U3RyZWFtW2RvYy5tZXRhZGF0YVtCVUZGRVJfSURYXV07XG4gICAgICAgICAgICBidWZmZXJlZERvYy5tZXRhZGF0YVtMQVNUX0FDQ0VTU0VEX0FUX0tFWV0gPSBub3c7XG4gICAgICAgICAgICByZXN1bHRzLnB1c2goYnVmZmVyZWREb2MpO1xuICAgICAgICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoID4gdGhpcy5rKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByZXBhcmUgZG9jdW1lbnRzIHdpdGggbmVjZXNzYXJ5IG1ldGFkYXRhIGJlZm9yZSBzYXZpbmdcbiAgICAgKiBAcGFyYW0gZG9jcyAtIFRoZSBkb2N1bWVudHMgdG8gcHJlcGFyZVxuICAgICAqIEBwYXJhbSBub3cgLSBUaGUgY3VycmVudCB0aW1lc3RhbXBcbiAgICAgKiBAcmV0dXJucyBUaGUgcHJlcGFyZWQgZG9jdW1lbnRzXG4gICAgICovXG4gICAgcHJlcGFyZURvY3VtZW50cyhkb2NzLCBub3cpIHtcbiAgICAgICAgcmV0dXJuIGRvY3MubWFwKChkb2MsIGkpID0+ICh7XG4gICAgICAgICAgICAuLi5kb2MsXG4gICAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgICAgIC4uLmRvYy5tZXRhZGF0YSxcbiAgICAgICAgICAgICAgICBbTEFTVF9BQ0NFU1NFRF9BVF9LRVldOiBkb2MubWV0YWRhdGFbTEFTVF9BQ0NFU1NFRF9BVF9LRVldID8/IG5vdyxcbiAgICAgICAgICAgICAgICBjcmVhdGVkX2F0OiBkb2MubWV0YWRhdGEuY3JlYXRlZF9hdCA/PyBub3csXG4gICAgICAgICAgICAgICAgW0JVRkZFUl9JRFhdOiB0aGlzLm1lbW9yeVN0cmVhbS5sZW5ndGggKyBpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxjdWxhdGUgdGhlIGNvbWJpbmVkIHNjb3JlIGJhc2VkIG9uIHZlY3RvciByZWxldmFuY2UgYW5kIG90aGVyIGZhY3RvcnNcbiAgICAgKiBAcGFyYW0gZG9jIC0gVGhlIGRvY3VtZW50IHRvIGNhbGN1bGF0ZSB0aGUgc2NvcmUgZm9yXG4gICAgICogQHBhcmFtIHZlY3RvclJlbGV2YW5jZSAtIFRoZSByZWxldmFuY2Ugc2NvcmUgZnJvbSB0aGUgdmVjdG9yIHN0b3JlXG4gICAgICogQHBhcmFtIG5vd01zZWMgLSBUaGUgY3VycmVudCB0aW1lc3RhbXAgaW4gbWlsbGlzZWNvbmRzXG4gICAgICogQHJldHVybnMgVGhlIGNvbWJpbmVkIHNjb3JlIGZvciB0aGUgZG9jdW1lbnRcbiAgICAgKi9cbiAgICBnZXRDb21iaW5lZFNjb3JlKGRvYywgdmVjdG9yUmVsZXZhbmNlLCBub3dNc2VjKSB7XG4gICAgICAgIGNvbnN0IGhvdXJzUGFzc2VkID0gdGhpcy5nZXRIb3Vyc1Bhc3NlZChub3dNc2VjLCBkb2MubWV0YWRhdGFbTEFTVF9BQ0NFU1NFRF9BVF9LRVldKTtcbiAgICAgICAgbGV0IHNjb3JlID0gKDEuMCAtIHRoaXMuZGVjYXlSYXRlKSAqKiBob3Vyc1Bhc3NlZDtcbiAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgdGhpcy5vdGhlclNjb3JlS2V5cykge1xuICAgICAgICAgICAgc2NvcmUgKz0gZG9jLm1ldGFkYXRhW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZlY3RvclJlbGV2YW5jZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgc2NvcmUgKz0gdmVjdG9yUmVsZXZhbmNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzY29yZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsY3VsYXRlIHRoZSBob3VycyBwYXNzZWQgYmV0d2VlbiB0d28gdGltZSBwb2ludHNcbiAgICAgKiBAcGFyYW0gdGltZSAtIFRoZSBjdXJyZW50IHRpbWUgaW4gc2Vjb25kc1xuICAgICAqIEBwYXJhbSByZWZUaW1lIC0gVGhlIHJlZmVyZW5jZSB0aW1lIGluIHNlY29uZHNcbiAgICAgKiBAcmV0dXJucyBUaGUgbnVtYmVyIG9mIGhvdXJzIHBhc3NlZCBiZXR3ZWVuIHRoZSB0d28gdGltZSBwb2ludHNcbiAgICAgKi9cbiAgICBnZXRIb3Vyc1Bhc3NlZCh0aW1lLCByZWZUaW1lKSB7XG4gICAgICAgIHJldHVybiAodGltZSAtIHJlZlRpbWUpIC8gMzYwMDtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/retrievers/time_weighted.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/stores/doc/base.js":
/*!********************************************************!*\
  !*** ./node_modules/langchain/dist/stores/doc/base.js ***!
  \********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Docstore: () => (/* binding */ Docstore)\n/* harmony export */ });\n/**\n * Abstract class for a document store. All document stores should extend\n * this class.\n */\nclass Docstore {\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3Qvc3RvcmVzL2RvYy9iYXNlLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1jb21wYW5pb24vLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3Qvc3RvcmVzL2RvYy9iYXNlLmpzP2U1YzIiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBYnN0cmFjdCBjbGFzcyBmb3IgYSBkb2N1bWVudCBzdG9yZS4gQWxsIGRvY3VtZW50IHN0b3JlcyBzaG91bGQgZXh0ZW5kXG4gKiB0aGlzIGNsYXNzLlxuICovXG5leHBvcnQgY2xhc3MgRG9jc3RvcmUge1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/stores/doc/base.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/stores/doc/in_memory.js":
/*!*************************************************************!*\
  !*** ./node_modules/langchain/dist/stores/doc/in_memory.js ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InMemoryDocstore: () => (/* binding */ InMemoryDocstore),\n/* harmony export */   SynchronousInMemoryDocstore: () => (/* binding */ SynchronousInMemoryDocstore)\n/* harmony export */ });\n/* harmony import */ var _base_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base.js */ \"(rsc)/./node_modules/langchain/dist/stores/doc/base.js\");\n\n/**\n * Class for storing and retrieving documents in memory asynchronously.\n * Extends the Docstore class.\n */\nclass InMemoryDocstore extends _base_js__WEBPACK_IMPORTED_MODULE_0__.Docstore {\n    constructor(docs) {\n        super();\n        Object.defineProperty(this, \"_docs\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this._docs = docs ?? new Map();\n    }\n    /**\n     * Searches for a document in the store based on its ID.\n     * @param search The ID of the document to search for.\n     * @returns The document with the given ID.\n     */\n    async search(search) {\n        const result = this._docs.get(search);\n        if (!result) {\n            throw new Error(`ID ${search} not found.`);\n        }\n        else {\n            return result;\n        }\n    }\n    /**\n     * Adds new documents to the store.\n     * @param texts An object where the keys are document IDs and the values are the documents themselves.\n     * @returns Void\n     */\n    async add(texts) {\n        const keys = [...this._docs.keys()];\n        const overlapping = Object.keys(texts).filter((x) => keys.includes(x));\n        if (overlapping.length > 0) {\n            throw new Error(`Tried to add ids that already exist: ${overlapping}`);\n        }\n        for (const [key, value] of Object.entries(texts)) {\n            this._docs.set(key, value);\n        }\n    }\n    async mget(keys) {\n        return Promise.all(keys.map((key) => this.search(key)));\n    }\n    async mset(keyValuePairs) {\n        await Promise.all(keyValuePairs.map(([key, value]) => this.add({ [key]: value })));\n    }\n    async mdelete(_keys) {\n        throw new Error(\"Not implemented.\");\n    }\n    // eslint-disable-next-line require-yield\n    async *yieldKeys(_prefix) {\n        throw new Error(\"Not implemented\");\n    }\n}\n/**\n * Class for storing and retrieving documents in memory synchronously.\n */\nclass SynchronousInMemoryDocstore {\n    constructor(docs) {\n        Object.defineProperty(this, \"_docs\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this._docs = docs ?? new Map();\n    }\n    /**\n     * Searches for a document in the store based on its ID.\n     * @param search The ID of the document to search for.\n     * @returns The document with the given ID.\n     */\n    search(search) {\n        const result = this._docs.get(search);\n        if (!result) {\n            throw new Error(`ID ${search} not found.`);\n        }\n        else {\n            return result;\n        }\n    }\n    /**\n     * Adds new documents to the store.\n     * @param texts An object where the keys are document IDs and the values are the documents themselves.\n     * @returns Void\n     */\n    add(texts) {\n        const keys = [...this._docs.keys()];\n        const overlapping = Object.keys(texts).filter((x) => keys.includes(x));\n        if (overlapping.length > 0) {\n            throw new Error(`Tried to add ids that already exist: ${overlapping}`);\n        }\n        for (const [key, value] of Object.entries(texts)) {\n            this._docs.set(key, value);\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3Qvc3RvcmVzL2RvYy9pbl9tZW1vcnkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXFDO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ08sK0JBQStCLDhDQUFRO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLFFBQVE7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9FQUFvRSxZQUFZO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlFQUF5RSxjQUFjO0FBQ3ZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLFFBQVE7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9FQUFvRSxZQUFZO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvbXBhbmlvbi8uL25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9zdG9yZXMvZG9jL2luX21lbW9yeS5qcz82MWNmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERvY3N0b3JlIH0gZnJvbSBcIi4vYmFzZS5qc1wiO1xuLyoqXG4gKiBDbGFzcyBmb3Igc3RvcmluZyBhbmQgcmV0cmlldmluZyBkb2N1bWVudHMgaW4gbWVtb3J5IGFzeW5jaHJvbm91c2x5LlxuICogRXh0ZW5kcyB0aGUgRG9jc3RvcmUgY2xhc3MuXG4gKi9cbmV4cG9ydCBjbGFzcyBJbk1lbW9yeURvY3N0b3JlIGV4dGVuZHMgRG9jc3RvcmUge1xuICAgIGNvbnN0cnVjdG9yKGRvY3MpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2RvY3NcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fZG9jcyA9IGRvY3MgPz8gbmV3IE1hcCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWFyY2hlcyBmb3IgYSBkb2N1bWVudCBpbiB0aGUgc3RvcmUgYmFzZWQgb24gaXRzIElELlxuICAgICAqIEBwYXJhbSBzZWFyY2ggVGhlIElEIG9mIHRoZSBkb2N1bWVudCB0byBzZWFyY2ggZm9yLlxuICAgICAqIEByZXR1cm5zIFRoZSBkb2N1bWVudCB3aXRoIHRoZSBnaXZlbiBJRC5cbiAgICAgKi9cbiAgICBhc3luYyBzZWFyY2goc2VhcmNoKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuX2RvY3MuZ2V0KHNlYXJjaCk7XG4gICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYElEICR7c2VhcmNofSBub3QgZm91bmQuYCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgbmV3IGRvY3VtZW50cyB0byB0aGUgc3RvcmUuXG4gICAgICogQHBhcmFtIHRleHRzIEFuIG9iamVjdCB3aGVyZSB0aGUga2V5cyBhcmUgZG9jdW1lbnQgSURzIGFuZCB0aGUgdmFsdWVzIGFyZSB0aGUgZG9jdW1lbnRzIHRoZW1zZWx2ZXMuXG4gICAgICogQHJldHVybnMgVm9pZFxuICAgICAqL1xuICAgIGFzeW5jIGFkZCh0ZXh0cykge1xuICAgICAgICBjb25zdCBrZXlzID0gWy4uLnRoaXMuX2RvY3Mua2V5cygpXTtcbiAgICAgICAgY29uc3Qgb3ZlcmxhcHBpbmcgPSBPYmplY3Qua2V5cyh0ZXh0cykuZmlsdGVyKCh4KSA9PiBrZXlzLmluY2x1ZGVzKHgpKTtcbiAgICAgICAgaWYgKG92ZXJsYXBwaW5nLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVHJpZWQgdG8gYWRkIGlkcyB0aGF0IGFscmVhZHkgZXhpc3Q6ICR7b3ZlcmxhcHBpbmd9YCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXModGV4dHMpKSB7XG4gICAgICAgICAgICB0aGlzLl9kb2NzLnNldChrZXksIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBtZ2V0KGtleXMpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGtleXMubWFwKChrZXkpID0+IHRoaXMuc2VhcmNoKGtleSkpKTtcbiAgICB9XG4gICAgYXN5bmMgbXNldChrZXlWYWx1ZVBhaXJzKSB7XG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKGtleVZhbHVlUGFpcnMubWFwKChba2V5LCB2YWx1ZV0pID0+IHRoaXMuYWRkKHsgW2tleV06IHZhbHVlIH0pKSk7XG4gICAgfVxuICAgIGFzeW5jIG1kZWxldGUoX2tleXMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudGVkLlwiKTtcbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlcXVpcmUteWllbGRcbiAgICBhc3luYyAqeWllbGRLZXlzKF9wcmVmaXgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudGVkXCIpO1xuICAgIH1cbn1cbi8qKlxuICogQ2xhc3MgZm9yIHN0b3JpbmcgYW5kIHJldHJpZXZpbmcgZG9jdW1lbnRzIGluIG1lbW9yeSBzeW5jaHJvbm91c2x5LlxuICovXG5leHBvcnQgY2xhc3MgU3luY2hyb25vdXNJbk1lbW9yeURvY3N0b3JlIHtcbiAgICBjb25zdHJ1Y3Rvcihkb2NzKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9kb2NzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2RvY3MgPSBkb2NzID8/IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VhcmNoZXMgZm9yIGEgZG9jdW1lbnQgaW4gdGhlIHN0b3JlIGJhc2VkIG9uIGl0cyBJRC5cbiAgICAgKiBAcGFyYW0gc2VhcmNoIFRoZSBJRCBvZiB0aGUgZG9jdW1lbnQgdG8gc2VhcmNoIGZvci5cbiAgICAgKiBAcmV0dXJucyBUaGUgZG9jdW1lbnQgd2l0aCB0aGUgZ2l2ZW4gSUQuXG4gICAgICovXG4gICAgc2VhcmNoKHNlYXJjaCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLl9kb2NzLmdldChzZWFyY2gpO1xuICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJRCAke3NlYXJjaH0gbm90IGZvdW5kLmApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIG5ldyBkb2N1bWVudHMgdG8gdGhlIHN0b3JlLlxuICAgICAqIEBwYXJhbSB0ZXh0cyBBbiBvYmplY3Qgd2hlcmUgdGhlIGtleXMgYXJlIGRvY3VtZW50IElEcyBhbmQgdGhlIHZhbHVlcyBhcmUgdGhlIGRvY3VtZW50cyB0aGVtc2VsdmVzLlxuICAgICAqIEByZXR1cm5zIFZvaWRcbiAgICAgKi9cbiAgICBhZGQodGV4dHMpIHtcbiAgICAgICAgY29uc3Qga2V5cyA9IFsuLi50aGlzLl9kb2NzLmtleXMoKV07XG4gICAgICAgIGNvbnN0IG92ZXJsYXBwaW5nID0gT2JqZWN0LmtleXModGV4dHMpLmZpbHRlcigoeCkgPT4ga2V5cy5pbmNsdWRlcyh4KSk7XG4gICAgICAgIGlmIChvdmVybGFwcGluZy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRyaWVkIHRvIGFkZCBpZHMgdGhhdCBhbHJlYWR5IGV4aXN0OiAke292ZXJsYXBwaW5nfWApO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRleHRzKSkge1xuICAgICAgICAgICAgdGhpcy5fZG9jcy5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/stores/doc/in_memory.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/dist/util/set.js":
/*!*************************************************!*\
  !*** ./node_modules/langchain/dist/util/set.js ***!
  \*************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   difference: () => (/* binding */ difference),\n/* harmony export */   intersection: () => (/* binding */ intersection),\n/* harmony export */   union: () => (/* binding */ union)\n/* harmony export */ });\n/**\n * Source: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set#implementing_basic_set_operations\n */\n/**\n * returns intersection of two sets\n */\nfunction intersection(setA, setB) {\n    const _intersection = new Set();\n    for (const elem of setB) {\n        if (setA.has(elem)) {\n            _intersection.add(elem);\n        }\n    }\n    return _intersection;\n}\n/**\n * returns union of two sets\n */\nfunction union(setA, setB) {\n    const _union = new Set(setA);\n    for (const elem of setB) {\n        _union.add(elem);\n    }\n    return _union;\n}\n/**\n * returns difference of two sets\n */\nfunction difference(setA, setB) {\n    const _difference = new Set(setA);\n    for (const elem of setB) {\n        _difference.delete(elem);\n    }\n    return _difference;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvdXRpbC9zZXQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvbXBhbmlvbi8uL25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC91dGlsL3NldC5qcz83N2U4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU291cmNlOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9TZXQjaW1wbGVtZW50aW5nX2Jhc2ljX3NldF9vcGVyYXRpb25zXG4gKi9cbi8qKlxuICogcmV0dXJucyBpbnRlcnNlY3Rpb24gb2YgdHdvIHNldHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGludGVyc2VjdGlvbihzZXRBLCBzZXRCKSB7XG4gICAgY29uc3QgX2ludGVyc2VjdGlvbiA9IG5ldyBTZXQoKTtcbiAgICBmb3IgKGNvbnN0IGVsZW0gb2Ygc2V0Qikge1xuICAgICAgICBpZiAoc2V0QS5oYXMoZWxlbSkpIHtcbiAgICAgICAgICAgIF9pbnRlcnNlY3Rpb24uYWRkKGVsZW0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBfaW50ZXJzZWN0aW9uO1xufVxuLyoqXG4gKiByZXR1cm5zIHVuaW9uIG9mIHR3byBzZXRzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1bmlvbihzZXRBLCBzZXRCKSB7XG4gICAgY29uc3QgX3VuaW9uID0gbmV3IFNldChzZXRBKTtcbiAgICBmb3IgKGNvbnN0IGVsZW0gb2Ygc2V0Qikge1xuICAgICAgICBfdW5pb24uYWRkKGVsZW0pO1xuICAgIH1cbiAgICByZXR1cm4gX3VuaW9uO1xufVxuLyoqXG4gKiByZXR1cm5zIGRpZmZlcmVuY2Ugb2YgdHdvIHNldHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRpZmZlcmVuY2Uoc2V0QSwgc2V0Qikge1xuICAgIGNvbnN0IF9kaWZmZXJlbmNlID0gbmV3IFNldChzZXRBKTtcbiAgICBmb3IgKGNvbnN0IGVsZW0gb2Ygc2V0Qikge1xuICAgICAgICBfZGlmZmVyZW5jZS5kZWxldGUoZWxlbSk7XG4gICAgfVxuICAgIHJldHVybiBfZGlmZmVyZW5jZTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/langchain/dist/util/set.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/langchain/experimental/generative_agents.js":
/*!******************************************************************!*\
  !*** ./node_modules/langchain/experimental/generative_agents.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   GenerativeAgent: () => (/* reexport safe */ _dist_experimental_generative_agents_index_js__WEBPACK_IMPORTED_MODULE_0__.GenerativeAgent),
/* harmony export */   GenerativeAgentMemory: () => (/* reexport safe */ _dist_experimental_generative_agents_index_js__WEBPACK_IMPORTED_MODULE_0__.GenerativeAgentMemory)
/* harmony export */ });
/* harmony import */ var _dist_experimental_generative_agents_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../dist/experimental/generative_agents/index.js */ "(rsc)/./node_modules/langchain/dist/experimental/generative_agents/index.js");


/***/ }),

/***/ "(rsc)/./node_modules/langchain/retrievers/time_weighted.js":
/*!************************************************************!*\
  !*** ./node_modules/langchain/retrievers/time_weighted.js ***!
  \************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BUFFER_IDX: () => (/* reexport safe */ _dist_retrievers_time_weighted_js__WEBPACK_IMPORTED_MODULE_0__.BUFFER_IDX),
/* harmony export */   LAST_ACCESSED_AT_KEY: () => (/* reexport safe */ _dist_retrievers_time_weighted_js__WEBPACK_IMPORTED_MODULE_0__.LAST_ACCESSED_AT_KEY),
/* harmony export */   TimeWeightedVectorStoreRetriever: () => (/* reexport safe */ _dist_retrievers_time_weighted_js__WEBPACK_IMPORTED_MODULE_0__.TimeWeightedVectorStoreRetriever)
/* harmony export */ });
/* harmony import */ var _dist_retrievers_time_weighted_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../dist/retrievers/time_weighted.js */ "(rsc)/./node_modules/langchain/dist/retrievers/time_weighted.js");


/***/ }),

/***/ "(rsc)/./node_modules/langchain/stores/doc/in_memory.js":
/*!********************************************************!*\
  !*** ./node_modules/langchain/stores/doc/in_memory.js ***!
  \********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   InMemoryDocstore: () => (/* reexport safe */ _dist_stores_doc_in_memory_js__WEBPACK_IMPORTED_MODULE_0__.InMemoryDocstore),
/* harmony export */   SynchronousInMemoryDocstore: () => (/* reexport safe */ _dist_stores_doc_in_memory_js__WEBPACK_IMPORTED_MODULE_0__.SynchronousInMemoryDocstore)
/* harmony export */ });
/* harmony import */ var _dist_stores_doc_in_memory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../dist/stores/doc/in_memory.js */ "(rsc)/./node_modules/langchain/dist/stores/doc/in_memory.js");


/***/ })

};
;